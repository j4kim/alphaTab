function $CombineDelegates(e,t){if(null==e)return t;if(null==t)return e;var a=$CreateMulticastDelegateFunction();if(a.delegates=[],e.isMulticastDelegate)for(i=0;i<e.delegates.length;i++)a.delegates.push(e.delegates[i]);else a.delegates.push(e);if(t.isMulticastDelegate)for(var i=0;i<t.delegates.length;i++)a.delegates.push(t.delegates[i]);else a.delegates.push(t);return a}function $CreateMulticastDelegateFunction(){var e=null,t=function(){for(var t=void 0,a=0;a<e.delegates.length;a++)t=e.delegates[a].apply(null,arguments);return t};return t.isMulticastDelegate=!0,e=t,t}function $RemoveDelegate(e,t){if(null==t||null==e)return e;if(e.isMulticastDelegate){if(t.isMulticastDelegate)throw new Error("Multicast to multicast delegate removal is not implemented yet");for(var a=$CreateMulticastDelegateFunction(),i=0;i<e.delegates.length;i++){var n=e.delegates[i];n!=t&&(null==a.delegates&&(a.delegates=[]),a.delegates.push(n))}return null==a.delegates?null:1==a.delegates.length?a.delegates[0]:a}if(t.isMulticastDelegate)throw new Error("single to multicast delegate removal is not supported");return e==t?null:e}var $StaticConstructors=[],$StaticConstructor=function(e){$StaticConstructors.push(e)};if(void 0===$Inherit)var $Inherit=function(e,t){if(void 0===Object.getOwnPropertyNames){for(var a in t.prototype)void 0!==e.prototype[a]&&e.prototype[a]!=Object.prototype[a]||(e.prototype[a]=t.prototype[a]);for(var a in t)void 0===e[a]&&(e[a]=t[a]);e.$baseCtor=t}else{for(var i=Object.getOwnPropertyNames(t.prototype),n=0;n<i.length;n++)void 0===Object.getOwnPropertyDescriptor(e.prototype,i[n])&&Object.defineProperty(e.prototype,i[n],Object.getOwnPropertyDescriptor(t.prototype,i[n]));for(var a in t)void 0===e[a]&&(e[a]=t[a]);e.$baseCtor=t}};if(void 0===$CreateException)var $CreateException=function(e,t){null==t&&(t=new Error),null==e&&(e=new System.Exception.ctor),t.message=e.message,t.exception=e;for(var a in e)t[a]=e[a];return t};if(void 0===$CreateAnonymousDelegate)var $CreateAnonymousDelegate=function(e,t){if(null==e||null==t)return t;var a=function(){return t.apply(e,arguments)};return a.func=t,a.target=e,a.isDelegate=!0,a};if(void 0===$CreateDelegate){if(void 0===$iKey)var $iKey=0;if(void 0===$pKey)var $pKey=String.fromCharCode(1);var $CreateDelegate=function(e,t){if(null==e||null==t)return t;if(t.target==e&&t.func==t)return t;null==e.$delegateCache&&(e.$delegateCache={}),null==t.$key&&(t.$key=$pKey+String(++$iKey));var a;return null!=e.$delegateCache&&(a=e.$delegateCache[t.$key]),null==a&&((a=function(){return t.apply(e,arguments)}).func=t,a.target=e,a.isDelegate=!0,null!=e.$delegateCache&&(e.$delegateCache[t.$key]=a)),a}}var Int32Array=Int32Array||Array,Uint8Array=Uint8Array||Array,Float32Array=Float32Array||Array,AlphaTab=AlphaTab||{};AlphaTab.Environment=function(){},AlphaTab.Environment.PlatformInit=function(){if(AlphaTab.Environment.RenderEngines.svg=function(){return new AlphaTab.Platform.Svg.CssFontSvgCanvas},AlphaTab.Environment.RenderEngines.default=function(){return new AlphaTab.Platform.Svg.CssFontSvgCanvas},AlphaTab.Environment.RenderEngines.html5=function(){return new AlphaTab.Platform.JavaScript.Html5Canvas},AlphaTab.Environment.CheckFontLoad(),Math.log2=Math.log2||function(e){return Math.log(e)*Math.LOG2E},self.document){var e=new String;e+='<script type="text/vbscript">\r\n',e+="Function VbAjaxLoader(method, fileName)\r\n",e+="    Dim xhr\r\n",e+='    Set xhr = CreateObject("Microsoft.XMLHTTP")\r\n',e+="    xhr.Open method, fileName, False\r\n",e+='    xhr.setRequestHeader "Accept-Charset", "x-user-defined"\r\n',e+="    xhr.send\r\n",e+="    Dim byteArray()\r\n",e+="    if xhr.Status = 200 Then\r\n",e+="        Dim byteString\r\n",e+="        Dim i\r\n",e+="        byteString=xhr.responseBody\r\n",e+="        ReDim byteArray(LenB(byteString))\r\n",e+="        For i = 1 To LenB(byteString)\r\n",e+="            byteArray(i-1) = AscB(MidB(byteString, i, 1))\r\n",e+="        Next\r\n",e+="    End If\r\n",e+="    VbAjaxLoader=byteArray\r\n",e+="End Function\r\n",e+="<\/script>\r\n",document.write(e);var t=document.currentScript;if(!t)try{var a=new Error,i=a.stack;if(!i)throw $CreateException(a,new Error);AlphaTab.Environment.ScriptFile=AlphaTab.Environment.ScriptFileFromStack(i)}catch(e){(i=e.stack)?AlphaTab.Environment.ScriptFile=AlphaTab.Environment.ScriptFileFromStack(i):t=document.querySelector("script[data-alphatab]")}null!=AlphaTab.Environment.ScriptFile&&0!=AlphaTab.Environment.ScriptFile.length||(t?AlphaTab.Environment.ScriptFile=t.src:console.warn("Could not automatically find alphaTab script file for worker, please add the data-alphatab attribute to the script tag that includes alphaTab or provide it when initializing alphaTab"))}},AlphaTab.Environment.ScriptFileFromStack=function(e){var t=e.match("(data:text\\/javascript(?:;[^,]+)?,.+?|(?:|blob:)(?:http[s]?|file):\\/\\/[\\/]?.+?\\/[^:\\)]*?)(?::\\d+)(?::\\d+)?");return t||(t=e.match("^(?:|[^:@]*@|.+\\)@(?=data:text\\/javascript|blob|http[s]?|file)|.+?\\s+(?: at |@)(?:[^:\\(]+ )*[\\(]?)(data:text\\/javascript(?:;[^,]+)?,.+?|(?:|blob:)(?:http[s]?|file):\\/\\/[\\/]?.+?\\/[^:\\)]*?)(?::\\d+)(?::\\d+)?"))||(t=e.match("\\)@(data:text\\/javascript(?:;[^,]+)?,.+?|(?:|blob:)(?:http[s]?|file):\\/\\/[\\/]?.+?\\/[^:\\)]*?)(?::\\d+)(?::\\d+)?"))?t[1]:null},AlphaTab.Environment.CheckFontLoad=function(){if("undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope)AlphaTab.Environment.IsFontLoaded=!1;else if(!!document.fonts&&!!document.fonts.load){document.fonts.load("1em alphaTab").then(function(){return AlphaTab.Environment.IsFontLoaded=!0,!0})}else{var e=null;e=function(){var t=document.getElementById("alphaTabFontChecker");null==t&&((t=document.createElement("div")).setAttribute("id","alphaTabFontChecker"),t.style.opacity="0",t.style.position="absolute",t.style.left="0",t.style.top="0",t.style.fontSize="100px",t.classList.add("at"),t.innerHTML="&#57424;",document.body.appendChild(t));var a=t.offsetWidth;a>30&&a<100?(AlphaTab.Environment.IsFontLoaded=!0,document.body.removeChild(t)):window.setTimeout(function(){e()},1e3)},window.addEventListener("DOMContentLoaded",function(t){e()})}},$StaticConstructor(function(){AlphaTab.Environment.RenderEngines=null,AlphaTab.Environment.LayoutEngines=null,AlphaTab.Environment.StaveProfiles=null,AlphaTab.Environment.StaveProfileScoreTab="score-tab",AlphaTab.Environment.StaveProfileTab="tab",AlphaTab.Environment.StaveProfileScore="score",AlphaTab.Environment.ScriptFile=null,AlphaTab.Environment.IsFontLoaded=!1,AlphaTab.Environment.RenderEngines={},AlphaTab.Environment.LayoutEngines={},AlphaTab.Environment.StaveProfiles={},AlphaTab.Environment.PlatformInit(),AlphaTab.Environment.LayoutEngines.default=function(e){return new AlphaTab.Rendering.Layout.PageViewLayout(e)},AlphaTab.Environment.LayoutEngines.page=function(e){return new AlphaTab.Rendering.Layout.PageViewLayout(e)},AlphaTab.Environment.LayoutEngines.horizontal=function(e){return new AlphaTab.Rendering.Layout.HorizontalScreenLayout(e)},AlphaTab.Environment.StaveProfiles.default=AlphaTab.Environment.StaveProfiles["score-tab"]=[new AlphaTab.Rendering.EffectBarRendererFactory("score-effects",[new AlphaTab.Rendering.Effects.TempoEffectInfo,new AlphaTab.Rendering.Effects.TripletFeelEffectInfo,new AlphaTab.Rendering.Effects.MarkerEffectInfo,new AlphaTab.Rendering.Effects.TextEffectInfo,new AlphaTab.Rendering.Effects.ChordsEffectInfo,new AlphaTab.Rendering.Effects.TrillEffectInfo,new AlphaTab.Rendering.Effects.BeatVibratoEffectInfo,new AlphaTab.Rendering.Effects.NoteVibratoEffectInfo,new AlphaTab.Rendering.Effects.AlternateEndingsEffectInfo]),new AlphaTab.Rendering.ScoreBarRendererFactory,new AlphaTab.Rendering.EffectBarRendererFactory("tab-effects",[new AlphaTab.Rendering.Effects.CrescendoEffectInfo,new AlphaTab.Rendering.Effects.DynamicsEffectInfo,new AlphaTab.Rendering.Effects.LyricsEffectInfo,new AlphaTab.Rendering.Effects.TrillEffectInfo,new AlphaTab.Rendering.Effects.BeatVibratoEffectInfo,new AlphaTab.Rendering.Effects.NoteVibratoEffectInfo,new AlphaTab.Rendering.Effects.TapEffectInfo,new AlphaTab.Rendering.Effects.FadeInEffectInfo,new AlphaTab.Rendering.Effects.HarmonicsEffectInfo,new AlphaTab.Rendering.Effects.LetRingEffectInfo,new AlphaTab.Rendering.Effects.CapoEffectInfo,new AlphaTab.Rendering.Effects.PalmMuteEffectInfo,new AlphaTab.Rendering.Effects.PickStrokeEffectInfo]),new AlphaTab.Rendering.TabBarRendererFactory(!1,!1,!1)],AlphaTab.Environment.StaveProfiles.score=[new AlphaTab.Rendering.EffectBarRendererFactory("score-effects",[new AlphaTab.Rendering.Effects.TempoEffectInfo,new AlphaTab.Rendering.Effects.TripletFeelEffectInfo,new AlphaTab.Rendering.Effects.MarkerEffectInfo,new AlphaTab.Rendering.Effects.TextEffectInfo,new AlphaTab.Rendering.Effects.ChordsEffectInfo,new AlphaTab.Rendering.Effects.TrillEffectInfo,new AlphaTab.Rendering.Effects.BeatVibratoEffectInfo,new AlphaTab.Rendering.Effects.NoteVibratoEffectInfo,new AlphaTab.Rendering.Effects.FadeInEffectInfo,new AlphaTab.Rendering.Effects.LetRingEffectInfo,new AlphaTab.Rendering.Effects.PalmMuteEffectInfo,new AlphaTab.Rendering.Effects.PickStrokeEffectInfo,new AlphaTab.Rendering.Effects.AlternateEndingsEffectInfo]),new AlphaTab.Rendering.ScoreBarRendererFactory,new AlphaTab.Rendering.EffectBarRendererFactory("score-bottom-effects",[new AlphaTab.Rendering.Effects.CrescendoEffectInfo,new AlphaTab.Rendering.Effects.DynamicsEffectInfo,new AlphaTab.Rendering.Effects.LyricsEffectInfo])],AlphaTab.Environment.StaveProfiles.tab=[new AlphaTab.Rendering.EffectBarRendererFactory("tab-effects",[new AlphaTab.Rendering.Effects.TempoEffectInfo,new AlphaTab.Rendering.Effects.TripletFeelEffectInfo,new AlphaTab.Rendering.Effects.MarkerEffectInfo,new AlphaTab.Rendering.Effects.TextEffectInfo,new AlphaTab.Rendering.Effects.ChordsEffectInfo,new AlphaTab.Rendering.Effects.TripletFeelEffectInfo,new AlphaTab.Rendering.Effects.TrillEffectInfo,new AlphaTab.Rendering.Effects.BeatVibratoEffectInfo,new AlphaTab.Rendering.Effects.NoteVibratoEffectInfo,new AlphaTab.Rendering.Effects.TapEffectInfo,new AlphaTab.Rendering.Effects.FadeInEffectInfo,new AlphaTab.Rendering.Effects.HarmonicsEffectInfo,new AlphaTab.Rendering.Effects.LetRingEffectInfo,new AlphaTab.Rendering.Effects.CapoEffectInfo,new AlphaTab.Rendering.Effects.PalmMuteEffectInfo,new AlphaTab.Rendering.Effects.PickStrokeEffectInfo,new AlphaTab.Rendering.Effects.AlternateEndingsEffectInfo]),new AlphaTab.Rendering.TabBarRendererFactory(!0,!0,!0),new AlphaTab.Rendering.EffectBarRendererFactory("tab-bottom-effects",[new AlphaTab.Rendering.Effects.LyricsEffectInfo])]}),AlphaTab.AlphaTabException=function(e){this.Description=null,this.Description=e},AlphaTab.Importer=AlphaTab.Importer||{},AlphaTab.Importer.FileLoadException=function(e,t){this.Xhr=null,AlphaTab.AlphaTabException.call(this,e),this.Xhr=t},$Inherit(AlphaTab.Importer.FileLoadException,AlphaTab.AlphaTabException),AlphaTab.Importer.ScoreLoader=function(){},AlphaTab.Importer.ScoreLoader.LoadScoreAsync=function(e,t,a){var i=new XMLHttpRequest;if(i.open("GET",e),i.responseType="arraybuffer",i.onreadystatechange=function(e){if(4==i.readyState)if(200==i.status)try{var n=new Uint8Array(i.response),r=AlphaTab.Importer.ScoreLoader.LoadScoreFromBytes(n);t(r)}catch(e){a(e)}else a(0==i.status?new AlphaTab.Importer.FileLoadException("You are offline!!\n Please Check Your Network.",i):404==i.status?new AlphaTab.Importer.FileLoadException("Requested URL not found.",i):500==i.status?new AlphaTab.Importer.FileLoadException("Internel Server Error.",i):"parsererror"==i.statusText?new AlphaTab.Importer.FileLoadException("Error.\nParsing JSON Request failed.",i):"timeout"==i.statusText?new AlphaTab.Importer.FileLoadException("Request Time out.",i):new AlphaTab.Importer.FileLoadException("Unknow Error: "+i.responseText,i))},i.open("GET",e,!0),i.responseType="arraybuffer","arraybuffer"==i.responseType)i.send();else{for(var n=VbAjaxLoader("GET",e).toArray(),r=new String,l=0;l<n.length-1;)r+=n[l],l++;var s=AlphaTab.Importer.ScoreLoader.GetBytesFromString(r),o=AlphaTab.Importer.ScoreLoader.LoadScoreFromBytes(s);t(o)}},AlphaTab.Importer.ScoreLoader.GetBytesFromString=function(e){for(var t=new Uint8Array(e.length),a=0;a<e.length;a++)t[a]=e.charCodeAt(a);return t},AlphaTab.Importer.ScoreLoader.LoadScoreFromBytes=function(e){var t=AlphaTab.Importer.ScoreImporter.BuildImporters();AlphaTab.Util.Logger.Info("ScoreLoader","Loading score from "+e.length+" bytes using "+t.length+" importers",null);for(var a=null,i=AlphaTab.IO.ByteBuffer.FromBuffer(e),n=0,r=t.length,l=t[n];n<r;n++,l=t[n]){i.Reset();try{AlphaTab.Util.Logger.Info("ScoreLoader","Importing using importer "+l.get_Name(),null),l.Init(i),a=l.ReadScore(),AlphaTab.Util.Logger.Info("ScoreLoader","Score imported using "+l.get_Name(),null);break}catch(e){if(!(e.exception instanceof AlphaTab.Importer.UnsupportedFormatException))throw AlphaTab.Util.Logger.Info("ScoreLoader","Score import failed due to unexpected error: "+e,null),$CreateException(e,new Error);AlphaTab.Util.Logger.Info("ScoreLoader",l.get_Name()+" does not support the file",null)}}if(null!=a)return a;throw AlphaTab.Util.Logger.Error("ScoreLoader","No compatible importer found for file",null),$CreateException(new AlphaTab.Importer.NoCompatibleReaderFoundException,new Error)},AlphaTab.Model=AlphaTab.Model||{},AlphaTab.Model.JsonConverter=function(){},AlphaTab.Model.JsonConverter.prototype={ScoreToJsObject:function(e){var t={};AlphaTab.Model.Score.CopyTo(e,t),t.MasterBars=[],t.Tracks=[];for(v=0;v<e.MasterBars.length;v++){var a=e.MasterBars[v],i={};AlphaTab.Model.MasterBar.CopyTo(a,i),null!=a.TempoAutomation&&(i.TempoAutomation={},AlphaTab.Model.Automation.CopyTo(a.TempoAutomation,i.TempoAutomation)),null!=a.VolumeAutomation&&(i.VolumeAutomation={},AlphaTab.Model.Automation.CopyTo(a.VolumeAutomation,i.VolumeAutomation)),null!=a.Section&&(i.Section={},AlphaTab.Model.Section.CopyTo(a.Section,i.Section)),t.MasterBars.push(i)}for(var n=0;n<e.Tracks.length;n++){var r=e.Tracks[n],l={};l.Color={},AlphaTab.Model.Track.CopyTo(r,l),l.PlaybackInfo={},AlphaTab.Model.PlaybackInformation.CopyTo(r.PlaybackInfo,l.PlaybackInfo),l.Chords={};for(var s in r.Chords){var o=r.Chords[s],h={};AlphaTab.Model.Chord.CopyTo(o,h),l.Chords[s]=o}l.Staves=[];for(var p=0;p<r.Staves.length;p++){var d=r.Staves[p],u={};u.Bars=[];for(var c=0;c<d.Bars.length;c++){var T=d.Bars[c],g={};AlphaTab.Model.Bar.CopyTo(T,g),g.Voices=[];for(var f=0;f<T.Voices.length;f++){var b=T.Voices[f],A={};AlphaTab.Model.Voice.CopyTo(b,A),A.Beats=[];for(var y=0;y<b.Beats.length;y++){var m=b.Beats[y],S={};AlphaTab.Model.Beat.CopyTo(m,S),S.Automations=[];for(var B=0;B<m.Automations.length;B++){var _={};AlphaTab.Model.Automation.CopyTo(m.Automations[B],_),S.Automations.push(_)}S.WhammyBarPoints=[];for(v=0;v<m.WhammyBarPoints.length;v++){I={};AlphaTab.Model.BendPoint.CopyTo(m.WhammyBarPoints[v],I),S.WhammyBarPoints.push(I)}S.Notes=[];for(var R=0;R<m.Notes.length;R++){var G=m.Notes[R],M={};AlphaTab.Model.Note.CopyTo(G,M),M.BendPoints=[];for(var v=0;v<G.BendPoints.length;v++){var I={};AlphaTab.Model.BendPoint.CopyTo(G.BendPoints[v],I),M.BendPoints.push(I)}S.Notes.push(M)}A.Beats.push(S)}g.Voices.push(A)}u.Bars.push(g)}l.Staves.push(u)}t.Tracks.push(l)}return t},JsObjectToScore:function(e){var t=new AlphaTab.Model.Score;AlphaTab.Model.Score.CopyTo(e,t);for(M=0;M<e.MasterBars.length;M++){var a=e.MasterBars[M],i=new AlphaTab.Model.MasterBar;AlphaTab.Model.MasterBar.CopyTo(a,i),null!=a.TempoAutomation&&(i.TempoAutomation=new AlphaTab.Model.Automation,AlphaTab.Model.Automation.CopyTo(a.TempoAutomation,i.TempoAutomation)),null!=a.VolumeAutomation&&(i.VolumeAutomation=new AlphaTab.Model.Automation,AlphaTab.Model.Automation.CopyTo(a.VolumeAutomation,i.VolumeAutomation)),null!=a.Section&&(i.Section=new AlphaTab.Model.Section,AlphaTab.Model.Section.CopyTo(a.Section,i.Section)),t.AddMasterBar(i)}for(var n=0;n<e.Tracks.length;n++){var r=e.Tracks[n],l=new AlphaTab.Model.Track(r.Staves.length);AlphaTab.Model.Track.CopyTo(r,l),t.AddTrack(l),AlphaTab.Model.PlaybackInformation.CopyTo(r.PlaybackInfo,l.PlaybackInfo);for(var s in r.Chords){var o=r.Chords[s],h=new AlphaTab.Model.Chord;AlphaTab.Model.Chord.CopyTo(o,h),l.Chords[s]=h}for(var p=0;p<r.Staves.length;p++)for(var d=r.Staves[p],u=0;u<d.Bars.length;u++){var c=d.Bars[u],T=new AlphaTab.Model.Bar;AlphaTab.Model.Bar.CopyTo(c,T),l.AddBarToStaff(p,T);for(var g=0;g<c.Voices.length;g++){var f=c.Voices[g],b=new AlphaTab.Model.Voice;AlphaTab.Model.Voice.CopyTo(f,b),T.AddVoice(b);for(var A=0;A<f.Beats.length;A++){var y=f.Beats[A],m=new AlphaTab.Model.Beat;AlphaTab.Model.Beat.CopyTo(y,m),b.AddBeat(m);for(var S=0;S<y.Automations.length;S++){var B=new AlphaTab.Model.Automation;AlphaTab.Model.Automation.CopyTo(y.Automations[S],B),m.Automations.push(B)}for(M=0;M<y.WhammyBarPoints.length;M++){v=new AlphaTab.Model.BendPoint(0,0);AlphaTab.Model.BendPoint.CopyTo(y.WhammyBarPoints[M],v),m.WhammyBarPoints.push(v)}for(var _=0;_<y.Notes.length;_++){var R=y.Notes[_],G=new AlphaTab.Model.Note;AlphaTab.Model.Note.CopyTo(R,G),m.AddNote(G);for(var M=0;M<R.BendPoints.length;M++){var v=new AlphaTab.Model.BendPoint(0,0);AlphaTab.Model.BendPoint.CopyTo(R.BendPoints[M],v),G.AddBendPoint(v)}}}}}}return t.Finish(),t}},AlphaTab.Platform=AlphaTab.Platform||{},AlphaTab.Platform.JavaScript=AlphaTab.Platform.JavaScript||{},AlphaTab.Platform.JavaScript.ResizeEventArgs=function(){this.OldWidth=0,this.NewWidth=0,this.Settings=null},AlphaTab.Platform.JavaScript.JsApi=function(e,t){this._element=null,this._canvasElement=null,this._settings=null,this._visibilityCheckerInterval=0,this._visibilityCheckerIntervalId=0,this._renderResults=null,this._totalResultCount=0,this.Renderer=null,this.Score=null,this.TrackIndexes=null,this._element=e,this._element.classList.add("alphaTab");var a,i=this.GetDataAttributes(),n=this._settings=AlphaTab.Settings.FromJson(t,i),r=n.Width<0;a=null!=t&&t.tracks?t.tracks:i.hasOwnProperty("tracks")?i.tracks:0,this.SetTracks(a,!1);var l="";if(null!=e&&(i.hasOwnProperty("tex")&&e.innerText&&(l=e.innerHTML.trim(),e.innerHTML=""),this._canvasElement=document.createElement("div"),this._canvasElement.className="alphaTabSurface",this._canvasElement.style.fontSize="0",this._canvasElement.style.overflow="hidden",this._canvasElement.style.lineHeight="0",e.appendChild(this._canvasElement),"default"!=n.Engine&&"svg"!=n.Engine||(window.addEventListener("scroll",$CreateAnonymousDelegate(this,function(e){this.ShowSvgsInViewPort()}),!0),window.addEventListener("resize",$CreateAnonymousDelegate(this,function(e){this.ShowSvgsInViewPort()}),!0)),r)){n.Width=e.offsetWidth;var s=0;window.addEventListener("resize",$CreateAnonymousDelegate(this,function(t){clearTimeout(s),s=setTimeout($CreateAnonymousDelegate(this,function(){e.offsetWidth!=n.Width&&this.TriggerResize()}),1)}))}if(this.CreateStyleElement(n),null!=e&&r){var o=new AlphaTab.Platform.JavaScript.ResizeEventArgs;o.OldWidth=0,o.NewWidth=e.offsetWidth,o.Settings=n,this.TriggerEvent("resize",o),n.Width=o.NewWidth}var h=!window.Worker;n.UseWebWorker&&!h&&"html5"!=n.Engine?this.Renderer=new AlphaTab.Platform.JavaScript.WorkerScoreRenderer(this,n):this.Renderer=new AlphaTab.Rendering.ScoreRenderer(n),this.Renderer.add_RenderFinished($CreateAnonymousDelegate(this,function(e){this.TriggerEvent("rendered",null)})),this.Renderer.add_PostRenderFinished($CreateAnonymousDelegate(this,function(){this._element.classList.remove("loading"),this._element.classList.remove("rendering"),this.TriggerEvent("postRendered",null)})),this.Renderer.add_PreRender($CreateAnonymousDelegate(this,function(e){this._renderResults=[],this._totalResultCount=0,this.AppendRenderResult(e)})),this.Renderer.add_PartialRenderFinished($CreateDelegate(this,this.AppendRenderResult)),this.Renderer.add_RenderFinished($CreateAnonymousDelegate(this,function(e){this.AppendRenderResult(e),this.AppendRenderResult(null)})),this.Renderer.add_Error($CreateDelegate(this,this.Error));var p=$CreateAnonymousDelegate(this,function(){r&&(this._settings.Width=this._element.offsetWidth,this.Renderer.UpdateSettings(n)),null!=l&&0!=l.length?this.Tex(l):t&&t.file?this.Load(t.file):i.hasOwnProperty("file")&&this.Load(i.file)});this._visibilityCheckerInterval=t&&t.visibilityCheckInterval||500,this.get_IsElementVisible()?p():(AlphaTab.Util.Logger.Warning("Rendering","AlphaTab container is invisible, checking for element visibility in "+this._visibilityCheckerInterval+"ms intervals",null),this._visibilityCheckerIntervalId=setInterval($CreateAnonymousDelegate(this,function(){this.get_IsElementVisible()&&(AlphaTab.Util.Logger.Info("Rendering","AlphaTab container became visible, triggering initial rendering",null),p(),clearInterval(this._visibilityCheckerIntervalId),this._visibilityCheckerIntervalId=0)}),this._visibilityCheckerInterval))},AlphaTab.Platform.JavaScript.JsApi.prototype={get_IsElementVisible:function(){return!!(this._element.offsetWidth||this._element.offsetHeight||this._element.getClientRects().length)},get_Tracks:function(){var e=this.TrackIndexesToTracks(this.TrackIndexes);return 0==e.length&&this.Score.Tracks.length>0&&e.push(this.Score.Tracks[0]),e.slice(0)},GetDataAttributes:function(){var e={};if(this._element.dataset)for(var t in this._element.dataset){l=this._element.dataset[t];try{l=JSON.parse(l)}catch(e){""==l&&(l=null)}e[t]=l}else for(var a=0;a<this._element.attributes.length;a++){var i=this._element.attributes[a];if(0==i.nodeName.indexOf("data-")){for(var n=i.nodeName.substr(5).split("-"),t=n[0],r=1;r<n.length;r++)t+=n[r].substr(0,1).toUpperCase()+n[r].substr(1);var l=i.nodeValue;try{l=JSON.parse(l)}catch(e){""==l&&(l=null)}e[t]=l}}return e},TriggerResize:function(){if(this.get_IsElementVisible()){0!=this._visibilityCheckerIntervalId&&(AlphaTab.Util.Logger.Info("Rendering","AlphaTab container became visible again, doing autosizing",null),clearInterval(this._visibilityCheckerIntervalId),this._visibilityCheckerIntervalId=0);var e=new AlphaTab.Platform.JavaScript.ResizeEventArgs;e.OldWidth=this._settings.Width,e.NewWidth=this._element.offsetWidth,e.Settings=this._settings,this.TriggerEvent("resize",e),this._settings.Width=e.NewWidth,this.Renderer.UpdateSettings(this._settings),this.Renderer.Resize(this._element.offsetWidth)}else 0==this._visibilityCheckerIntervalId&&(AlphaTab.Util.Logger.Warning("Rendering","AlphaTab container was invisible while autosizing, checking for element visibility in "+this._visibilityCheckerInterval+"ms intervals",null),this._visibilityCheckerIntervalId=setInterval($CreateDelegate(this,this.TriggerResize),this._visibilityCheckerInterval))},ShowSvgsInViewPort:function(){for(var e=this._canvasElement.querySelectorAll("[data-lazy=true]"),t=0,a=e.length,i=e[t];t<a;t++,i=e[t]){var n=i;AlphaTab.Platform.JavaScript.JsApi.IsElementInViewPort(n)&&(n.outerHTML=n.svg)}},Print:function(e){var t=window.open("","","width=0,height=0"),a=t.document.createElement("div");null!=e&&0!=e.length?a.style.width=e:a.style.width="210mm",t.document.write("<!DOCTYPE html><html></head><body></body></html>"),t.document.body.appendChild(a);var i=void 0!==window.screenLeft?window.screenLeft:screen.left,n=void 0!==window.screenTop?window.screenTop:screen.top,r=void 0!==window.innerWidth?window.innerWidth:void 0!==document.documentElement.clientWidth?document.documentElement.clientWidth:screen.width,l=void 0!==window.innerHeight?window.innerHeight:void 0!==document.documentElement.clientHeight?document.documentElement.clientHeight:screen.height,s=a.offsetWidth+50,o=window.innerHeight,h=(r/2|0)-(s/2|0)+i,p=(l/2|0)-(o/2|0)+n;t.resizeTo(s,o),t.moveTo(h,p),t.focus();var d=AlphaTab.Settings.get_Defaults();d.ScriptFile=this._settings.ScriptFile,d.FontDirectory=this._settings.FontDirectory,d.Scale=.8,d.StretchForce=.8,d.DisableLazyLoading=!0,d.UseWebWorker=!1;var u=new AlphaTab.Platform.JavaScript.JsApi(a,d);u.Renderer.add_PostRenderFinished($CreateAnonymousDelegate(this,function(){u._canvasElement.style.height="100%",t.window.print()})),u.SetTracks(this.get_Tracks(),!0)},AppendRenderResult:function(e){null!=e&&(this._canvasElement.style.width=e.TotalWidth+"px",this._canvasElement.style.height=e.TotalHeight+"px"),null!=e&&null==e.RenderResult||(this._renderResults.push(e),setTimeout($CreateAnonymousDelegate(this,function(){for(;this._renderResults.length>0;){var e=this._renderResults[0];if(this._renderResults.splice(0,1),null==e)for(;this._canvasElement.childElementCount>this._totalResultCount;)this._canvasElement.removeChild(this._canvasElement.lastChild);else{var t=e.RenderResult;if("string"==typeof t){var a;this._totalResultCount<this._canvasElement.childElementCount?a=this._canvasElement.children[this._totalResultCount]:(a=document.createElement("div"),this._canvasElement.appendChild(a)),a.style.width=e.Width+"px",a.style.height=e.Height+"px",a.style.display="inline-block",AlphaTab.Platform.JavaScript.JsApi.IsElementInViewPort(a)||this._settings.DisableLazyLoading?a.outerHTML=t:(a.svg=t,a.setAttribute("data-lazy","true"))}else this._totalResultCount<this._canvasElement.childElementCount?this._canvasElement.replaceChild(e.RenderResult,this._canvasElement.children[this._totalResultCount]):this._canvasElement.appendChild(e.RenderResult);this._totalResultCount++}}}),1))},CreateStyleElement:function(e){var t=this._element.ownerDocument,a=t.getElementById("alphaTabStyle");if(null==a){var i=e.FontDirectory;(a=t.createElement("style")).id="alphaTabStyle",a.type="text/css";var n=new String;n+="@font-face {\r\n",n+="    font-family: 'alphaTab';\r\n",n+="     src: url('"+i+"Bravura.eot');\r\n",n+="     src: url('"+i+"Bravura.eot?#iefix') format('embedded-opentype')\r\n",n+="          , url('"+i+"Bravura.woff') format('woff')\r\n",n+="          , url('"+i+"Bravura.otf') format('opentype')\r\n",n+="          , url('"+i+"Bravura.svg#Bravura') format('svg');\r\n",n+="     font-weight: normal;\r\n",n+="     font-style: normal;\r\n",n+="}\r\n",n+=".alphaTabSurface * {\r\n",n+="    cursor: default;\r\n",n+="}\r\n",n+=".at {\r\n",n+="     font-family: 'alphaTab';\r\n",n+="     speak: none;\r\n",n+="     font-style: normal;\r\n",n+="     font-weight: normal;\r\n",n+="     font-variant: normal;\r\n",n+="     text-transform: none;\r\n",n+="     line-height: 1;\r\n",n+="     line-height: 1;\r\n",n+="     -webkit-font-smoothing: antialiased;\r\n",n+="     -moz-osx-font-smoothing: grayscale;\r\n",n+="     font-size: 34px;\r\n",n+="     overflow: visible !important;\r\n",n+="}\r\n",a.innerHTML=n,t.getElementsByTagName("head")[0].appendChild(a)}},Destroy:function(){this._element.innerHTML="",this.Renderer.Destroy()},Load:function(e){this._element.classList.add("loading");try{e instanceof ArrayBuffer?this.ScoreLoaded(AlphaTab.Importer.ScoreLoader.LoadScoreFromBytes(new Uint8Array(e)),!0):e instanceof Uint8Array?this.ScoreLoaded(AlphaTab.Importer.ScoreLoader.LoadScoreFromBytes(e),!0):"string"==typeof e&&AlphaTab.Importer.ScoreLoader.LoadScoreAsync(e,$CreateAnonymousDelegate(this,function(e){this.ScoreLoaded(e,!0)}),$CreateAnonymousDelegate(this,function(e){this.Error("import",e)}))}catch(e){this.Error("import",e)}},Tex:function(e){this._element.classList.add("loading");try{var t=new AlphaTab.Importer.AlphaTexImporter,a=AlphaTab.IO.ByteBuffer.FromBuffer(AlphaTab.Platform.Std.StringToByteArray(e));t.Init(a),this.ScoreLoaded(t.ReadScore(),!0)}catch(e){this.Error("import",e)}},SetTracks:function(e,t){e.length&&"number"==typeof e[0].Index?this.Score=e[0].Score:"number"==typeof e.Index&&(this.Score=e.Score),this.TrackIndexes=this.ParseTracks(e),t&&this.Render()},TrackIndexesToTracks:function(e){for(var t=[],a=0,i=e.length,n=e[a];a<i;a++,n=e[a])n>=0&&n<this.Score.Tracks.length&&t.push(this.Score.Tracks[n]);return t},ParseTracks:function(e){var t=[];if("string"==typeof e)try{e=JSON.parse(e)}catch(t){e=new Int32Array([0])}if("number"==typeof e)t.push(e);else if(e.length)for(var a=0;a<e.length;a++){var i;(i="number"==typeof e[a]?e[a]:"number"==typeof e[a].Index?e[a].Index:AlphaTab.Platform.Std.ParseInt(e[a].ToString()))>=0&&t.push(i)}else"number"==typeof e.Index&&t.push(e.Index);return t.slice(0)},ScoreLoaded:function(e,t){AlphaTab.Model.ModelUtils.ApplyPitchOffsets(this._settings,e),this.Score=e,this.TriggerEvent("loaded",e),t&&this.Render()},Error:function(e,t){AlphaTab.Util.Logger.Error(e,"An unexpected error occurred",t),this.TriggerEvent("error",{type:e,details:t})},TriggerEvent:function(e,t){if(null!=this._element){e="alphaTab."+e;var a=document.createEvent("CustomEvent");a.initCustomEvent(e,!1,!1,t),this._element.dispatchEvent(a),window&&"jQuery"in window&&(0,window.jQuery)(this._element).trigger(e,t)}},Render:function(){if(null!=this.Renderer){var e=null;(e=$CreateAnonymousDelegate(this,function(){AlphaTab.Environment.IsFontLoaded?this.Renderer.Render(this.Score,this.TrackIndexes):window.setTimeout($CreateAnonymousDelegate(this,function(){e()}),1e3)}))()}},UpdateLayout:function(e){this._settings.Layout=AlphaTab.Settings.LayoutFromJson(e),this.Renderer.UpdateSettings(this._settings),this.Renderer.Invalidate()}},AlphaTab.Platform.JavaScript.JsApi.IsElementInViewPort=function(e){var t=e.getBoundingClientRect();return t.top+t.height>=0&&t.top<=window.innerHeight&&t.left+t.width>=0&&t.left<=window.innerWidth},AlphaTab.Platform.JavaScript.JsWorker=function(e){this._renderer=null,this._main=null,this._main=e,this._main.addEventListener("message",$CreateDelegate(this,this.HandleMessage),!1)},AlphaTab.Platform.JavaScript.JsWorker.prototype={HandleMessage:function(e){var t=e.data;switch(t?t.cmd:""){case"alphaTab.initialize":var a=AlphaTab.Settings.FromJson(t.settings,null);this._renderer=new AlphaTab.Rendering.ScoreRenderer(a),this._renderer.add_PartialRenderFinished($CreateAnonymousDelegate(this,function(e){this._main.postMessage({cmd:"alphaTab.partialRenderFinished",result:e})})),this._renderer.add_RenderFinished($CreateAnonymousDelegate(this,function(e){this._main.postMessage({cmd:"alphaTab.renderFinished",result:e})})),this._renderer.add_PostRenderFinished($CreateAnonymousDelegate(this,function(){this._main.postMessage({cmd:"alphaTab.postRenderFinished",boundsLookup:this._renderer.BoundsLookup.ToJson()})})),this._renderer.add_PreRender($CreateAnonymousDelegate(this,function(e){this._main.postMessage({cmd:"alphaTab.preRender",result:e})})),this._renderer.add_Error($CreateDelegate(this,this.Error));break;case"alphaTab.invalidate":this._renderer.Invalidate();break;case"alphaTab.resize":this._renderer.Resize(t.width);break;case"alphaTab.render":var i=(new AlphaTab.Model.JsonConverter).JsObjectToScore(t.score);this.RenderMultiple(i,t.trackIndexes);break;case"alphaTab.updateSettings":this.UpdateSettings(t.settings)}},UpdateSettings:function(e){this._renderer.UpdateSettings(AlphaTab.Settings.FromJson(e,null))},RenderMultiple:function(e,t){try{this._renderer.Render(e,t)}catch(e){this.Error("render",e)}},Error:function(e,t){AlphaTab.Util.Logger.Error(e,"An unexpected error occurred in worker",t);var a=JSON.parse(JSON.stringify(t));t.message&&(a.message=t.message),t.stack&&(a.stack=t.stack),t.constructor&&t.constructor.name&&(a.type=t.constructor.name),this._main.postMessage({cmd:"alphaTab.error",error:{type:e,detail:a}})}},$StaticConstructor(function(){self.document||new AlphaTab.Platform.JavaScript.JsWorker(self)}),AlphaTab.Platform.JavaScript.Html5Canvas=function(){this._canvas=null,this._context=null,this._color=null,this._font=null,this._musicFont=null,this._Resources=null,this._color=new AlphaTab.Platform.Model.Color(0,0,0,255);var e=document.createElement("span");e.classList.add("at"),document.body.appendChild(e);var t=window.getComputedStyle(e,null);this._musicFont=new AlphaTab.Platform.Model.Font(t.fontFamily,AlphaTab.Platform.Std.ParseFloat(t.fontSize),AlphaTab.Platform.Model.FontStyle.Plain)},AlphaTab.Platform.JavaScript.Html5Canvas.prototype={get_Resources:function(){return this._Resources},set_Resources:function(e){this._Resources=e},OnPreRender:function(){return null},OnRenderFinished:function(){return null},BeginRender:function(e,t){this._canvas=document.createElement("canvas"),this._canvas.width=0|e,this._canvas.height=0|t,this._canvas.style.width=e+"px",this._canvas.style.height=t+"px",this._context=this._canvas.getContext("2d"),this._context.textBaseline="top"},EndRender:function(){var e=this._canvas;return this._canvas=null,e},get_Color:function(){return this._color},set_Color:function(e){this._color.RGBA!=e.RGBA&&(this._color=e,this._context.strokeStyle=e.RGBA,this._context.fillStyle=e.RGBA)},get_LineWidth:function(){return this._context.lineWidth},set_LineWidth:function(e){this._context.lineWidth=e},FillRect:function(e,t,a,i){a>0&&this._context.fillRect(-.5|e,-.5|t,a,i)},StrokeRect:function(e,t,a,i){this._context.strokeRect(e-.5,t-.5,a,i)},BeginPath:function(){this._context.beginPath()},ClosePath:function(){this._context.closePath()},MoveTo:function(e,t){this._context.moveTo(e-.5,t-.5)},LineTo:function(e,t){this._context.lineTo(e-.5,t-.5)},QuadraticCurveTo:function(e,t,a,i){this._context.quadraticCurveTo(e,t,a,i)},BezierCurveTo:function(e,t,a,i,n,r){this._context.bezierCurveTo(e,t,a,i,n,r)},FillCircle:function(e,t,a){this._context.beginPath(),this._context.arc(e,t,a,0,6.28318530717959,!0),this.Fill()},Fill:function(){this._context.fill()},Stroke:function(){this._context.stroke()},get_Font:function(){return this._font},set_Font:function(e){this._font=e,this._context.font=e.ToCssString(1)},get_TextAlign:function(){switch(this._context.textAlign){case"left":return AlphaTab.Platform.Model.TextAlign.Left;case"center":return AlphaTab.Platform.Model.TextAlign.Center;case"right":return AlphaTab.Platform.Model.TextAlign.Right;default:return AlphaTab.Platform.Model.TextAlign.Left}},set_TextAlign:function(e){switch(e){case AlphaTab.Platform.Model.TextAlign.Left:this._context.textAlign="left";break;case AlphaTab.Platform.Model.TextAlign.Center:this._context.textAlign="center";break;case AlphaTab.Platform.Model.TextAlign.Right:this._context.textAlign="right"}},get_TextBaseline:function(){switch(this._context.textBaseline){case"top":return AlphaTab.Platform.Model.TextBaseline.Top;case"middle":return AlphaTab.Platform.Model.TextBaseline.Middle;case"bottom":return AlphaTab.Platform.Model.TextBaseline.Bottom;default:return AlphaTab.Platform.Model.TextBaseline.Top}},set_TextBaseline:function(e){switch(e){case AlphaTab.Platform.Model.TextBaseline.Top:this._context.textBaseline="top";break;case AlphaTab.Platform.Model.TextBaseline.Middle:this._context.textBaseline="middle";break;case AlphaTab.Platform.Model.TextBaseline.Bottom:this._context.textBaseline="bottom"}},BeginGroup:function(e){},EndGroup:function(){},FillText:function(e,t,a){this._context.fillText(e,t,a)},MeasureText:function(e){return this._context.measureText(e).width},FillMusicFontSymbol:function(e,t,a,i){if(i!=AlphaTab.Rendering.Glyphs.MusicFontSymbol.None){var n=this._context.textBaseline,r=this._context.font;this._context.font=this._musicFont.ToCssString(a),this._context.textBaseline="middle",this._context.fillText(String.fromCharCode(i),e,t),this._context.textBaseline=n,this._context.font=r}}},AlphaTab.Platform.JavaScript.WorkerScoreRenderer=function(e,t){this._api=null,this._worker=null,this.PreRender=null,this.PartialRenderFinished=null,this.RenderFinished=null,this.Error=null,this.PostRenderFinished=null,this.BoundsLookup=null,this._api=e;try{this._worker=new Worker(t.ScriptFile)}catch(e){try{var a="importScripts('"+t.ScriptFile+"')",i=new Blob([a]);this._worker=new Worker(window.URL.createObjectURL(i))}catch(e){AlphaTab.Util.Logger.Error("Rendering","Failed to create WebWorker: "+e,null)}}this._worker.postMessage({cmd:"alphaTab.initialize",settings:t.ToJson()}),this._worker.addEventListener("message",$CreateDelegate(this,this.HandleWorkerMessage),!1)},AlphaTab.Platform.JavaScript.WorkerScoreRenderer.prototype={Destroy:function(){this._worker.terminate()},UpdateSettings:function(e){this._worker.postMessage({cmd:"alphaTab.updateSettings",settings:e.ToJson()})},Invalidate:function(){this._worker.postMessage({cmd:"alphaTab.invalidate"})},Resize:function(e){this._worker.postMessage({cmd:"alphaTab.resize",width:e})},HandleWorkerMessage:function(e){var t=e.data;switch(t.cmd){case"alphaTab.preRender":this.OnPreRender(t.result);break;case"alphaTab.partialRenderFinished":this.OnPartialRenderFinished(t.result);break;case"alphaTab.renderFinished":this.OnRenderFinished(t.result);break;case"alphaTab.postRenderFinished":this.BoundsLookup=AlphaTab.Rendering.Utils.BoundsLookup.FromJson(t.boundsLookup,this._api.Score),this.OnPostRenderFinished();break;case"alphaTab.error":this.OnError(t.type,t.detail)}},Render:function(e,t){e=(new AlphaTab.Model.JsonConverter).ScoreToJsObject(e),this._worker.postMessage({cmd:"alphaTab.render",score:e,trackIndexes:t})},add_PreRender:function(e){this.PreRender=$CombineDelegates(this.PreRender,e)},remove_PreRender:function(e){this.PreRender=$RemoveDelegate(this.PreRender,e)},OnPreRender:function(e){var t=this.PreRender;null!=t&&t(e)},add_PartialRenderFinished:function(e){this.PartialRenderFinished=$CombineDelegates(this.PartialRenderFinished,e)},remove_PartialRenderFinished:function(e){this.PartialRenderFinished=$RemoveDelegate(this.PartialRenderFinished,e)},OnPartialRenderFinished:function(e){var t=this.PartialRenderFinished;null!=t&&t(e)},add_RenderFinished:function(e){this.RenderFinished=$CombineDelegates(this.RenderFinished,e)},remove_RenderFinished:function(e){this.RenderFinished=$RemoveDelegate(this.RenderFinished,e)},OnRenderFinished:function(e){var t=this.RenderFinished;null!=t&&t(e)},add_Error:function(e){this.Error=$CombineDelegates(this.Error,e)},remove_Error:function(e){this.Error=$RemoveDelegate(this.Error,e)},OnError:function(e,t){var a=this.Error;null!=a&&a(e,t)},add_PostRenderFinished:function(e){this.PostRenderFinished=$CombineDelegates(this.PostRenderFinished,e)},remove_PostRenderFinished:function(e){this.PostRenderFinished=$RemoveDelegate(this.PostRenderFinished,e)},OnPostRenderFinished:function(){var e=this.PostRenderFinished;null!=e&&e()}},AlphaTab.Platform.Std=function(){},AlphaTab.Platform.Std.ParseFloat=function(e){return parseFloat(e)},AlphaTab.Platform.Std.Log=function(e,t,a,i){var n=(new Error).stack;if(!n)try{throw new Error}catch(e){n=e.stack}switch(a="[AlphaTab]["+t+"] "+a,e){case AlphaTab.Util.LogLevel.None:break;case AlphaTab.Util.LogLevel.Debug:console.debug(a,i);break;case AlphaTab.Util.LogLevel.Info:console.info(a,i);break;case AlphaTab.Util.LogLevel.Warning:console.warn(a,i);break;case AlphaTab.Util.LogLevel.Error:console.error(a,n,i)}},AlphaTab.Platform.Std.ParseInt=function(e){var t=parseInt(e);return isNaN(t)?-2147483648:t},AlphaTab.Platform.Std.CloneArray=function(e){return new Int32Array(0)},AlphaTab.Platform.Std.BlockCopy=function(e,t,a,i,n){},AlphaTab.Platform.Std.IsNullOrWhiteSpace=function(e){return null==e||0==e.trim().length},AlphaTab.Platform.Std.StringFromCharCode=function(e){return""},AlphaTab.Platform.Std.ReadSignedByte=function(e){var t=e.ReadByte();return t>=128?t-256:t},AlphaTab.Platform.Std.ToString=function(e){for(var t=new String,a=0;a<e.length;){var i=e[a++];if(i<128){if(0==i)break;t+=String.fromCharCode(i)}else if(i<224)t+=String.fromCharCode((63&i)<<6|127&e[a++]);else if(i<240)t+=String.fromCharCode((31&i)<<12|(127&e[a++])<<6|127&e[a++]);else{var n=(15&i)<<18|(127&e[a++])<<12|(127&e[a++])<<6|127&e[a++];t+=String.fromCharCode(55232+(n>>18)),t+=String.fromCharCode(1023&n|56320)}}return t},AlphaTab.Platform.Std.StringToByteArray=function(e){for(var t=new Uint8Array(e.length),a=0;a<e.length;a++)t[a]=e.charCodeAt(a);return t},AlphaTab.Platform.Std.S4=function(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)},AlphaTab.Platform.Std.NewGuid=function(){return AlphaTab.Platform.Std.S4()+AlphaTab.Platform.Std.S4()+"-"+AlphaTab.Platform.Std.S4()+"-"+AlphaTab.Platform.Std.S4()+"-"+AlphaTab.Platform.Std.S4()+"-"+AlphaTab.Platform.Std.S4()+AlphaTab.Platform.Std.S4()+AlphaTab.Platform.Std.S4()},AlphaTab.Platform.Std.IsException=function(e,t){return!1},AlphaTab.Platform.Std.Random=function(e){return Math.random()*e},AlphaTab.Platform.Std.IsStringNumber=function(e,t){if(0==e.length)return!1;var a=e.charCodeAt(0);return AlphaTab.Platform.Std.IsCharNumber(a,t)},AlphaTab.Platform.Std.IsCharNumber=function(e,t){return t&&45==e||e>=48&&e<=57},AlphaTab.Platform.Std.IsWhiteSpace=function(e){return 32==e||11==e||13==e||10==e},AlphaTab.Platform.Std.ToHexString=function(e,t){var a="";do{a=String.fromCharCode("0123456789ABCDEF".charCodeAt(15&e))+a,e>>=4}while(e>0);for(;a.length<t;)a="0"+a;return a},AlphaTab.Rendering=AlphaTab.Rendering||{},AlphaTab.Rendering.Utils=AlphaTab.Rendering.Utils||{},AlphaTab.Rendering.Utils.BoundsLookup=function(){this._beatLookup=null,this._currentStaveGroup=null,this.StaveGroups=null,this.IsFinished=!1,this.StaveGroups=[],this._beatLookup={}},AlphaTab.Rendering.Utils.BoundsLookup.prototype={ToJson:function(){var e={},t=[];e.StaveGroups=t;for(var a=0,i=this.StaveGroups,n=i.length,r=i[a];a<n;a++,r=i[a]){var l={};l.VisualBounds=this.BoundsToJson(r.VisualBounds),l.RealBounds=this.BoundsToJson(r.RealBounds),l.Bars=[];for(var s=0,o=r.Bars,h=o.length,p=o[s];s<h;s++,p=o[s]){var d={};d.VisualBounds=this.BoundsToJson(p.VisualBounds),d.RealBounds=this.BoundsToJson(p.RealBounds),d.Bars=[];for(var u=0,c=p.Bars,T=c.length,g=c[u];u<T;u++,g=c[u]){var f={};f.VisualBounds=this.BoundsToJson(g.VisualBounds),f.RealBounds=this.BoundsToJson(g.RealBounds),f.Beats=[];for(var b=0,A=g.Beats,y=A.length,m=A[b];b<y;b++,m=A[b]){var S={};S.VisualBounds=this.BoundsToJson(m.VisualBounds),S.RealBounds=this.BoundsToJson(m.RealBounds),S.BeatIndex=m.Beat.Index,S.VoiceIndex=m.Beat.Voice.Index,S.BarIndex=m.Beat.Voice.Bar.Index,S.StaffIndex=m.Beat.Voice.Bar.Staff.Index,S.TrackIndex=m.Beat.Voice.Bar.Staff.Track.Index,f.Beats.push(S)}d.Bars.push(f)}l.Bars.push(d)}t.push(l)}return e},BoundsToJson:function(e){var t={};return t.X=e.X,t.Y=e.Y,t.W=e.W,t.H=e.H,t},Finish:function(){for(var e=0;e<this.StaveGroups.length;e++)this.StaveGroups[e].Finish();this.IsFinished=!0},AddStaveGroup:function(e){e.Index=this.StaveGroups.length,e.BoundsLookup=this,this.StaveGroups.push(e),this._currentStaveGroup=e},AddMasterBar:function(e){e.StaveGroupBounds=this._currentStaveGroup,this._currentStaveGroup.AddBar(e)},AddBeat:function(e){this._beatLookup[e.Beat.Id]=e},FindBeat:function(e){var t=e.Id;return this._beatLookup.hasOwnProperty(t)?this._beatLookup[t]:null},GetBeatAtPos:function(e,t){for(var a=0,i=this.StaveGroups.length-1,n=-1;a<=i;){var r=(i+a)/2|0,l=this.StaveGroups[r];if(t>=l.RealBounds.Y&&t<=l.RealBounds.Y+l.RealBounds.H){n=r;break}t<l.RealBounds.Y?i=r-1:a=r+1}if(-1==n)return null;var s=this.StaveGroups[n].FindBarAtPos(e);return null!=s?s.FindBeatAtPos(e,t):null}},AlphaTab.Rendering.Utils.BoundsLookup.FromJson=function(e,t){for(var a=new AlphaTab.Rendering.Utils.BoundsLookup,i=e.StaveGroups,n=0,r=i.length,l=i[n];n<r;n++,l=i[n]){var s=new AlphaTab.Rendering.Utils.StaveGroupBounds;s.VisualBounds=l.VisualBounds,s.RealBounds=l.RealBounds,a.AddStaveGroup(s);for(var o=0,h=l.Bars,p=h.length,d=h[o];o<p;o++,d=h[o]){var u=new AlphaTab.Rendering.Utils.MasterBarBounds;u.IsFirstOfLine=d.IsFirstOfLine,u.VisualBounds=d.VisualBounds,u.RealBounds=d.RealBounds,s.AddBar(u);for(var c=0,T=d.Bars,g=T.length,f=T[c];c<g;c++,f=T[c]){var b=new AlphaTab.Rendering.Utils.BarBounds;b.VisualBounds=f.VisualBounds,b.RealBounds=f.RealBounds,u.AddBar(b);for(var A=0,y=f.Beats,m=y.length,S=y[A];A<m;A++,S=y[A]){var B=new AlphaTab.Rendering.Utils.BeatBounds;B.VisualBounds=S.VisualBounds,B.RealBounds=S.RealBounds,B.Beat=t.Tracks[S.TrackIndex].Staves[S.StaffIndex].Bars[S.BarIndex].Voices[S.VoiceIndex].Beats[S.BeatIndex],b.AddBeat(B)}}}}return a},AlphaTab.Settings=function(){this.ScriptFile=null,this.FontDirectory=null,this.DisableLazyLoading=!1,this.UseWebWorker=!1,this.Scale=0,this.Width=0,this.Engine=null,this.Layout=null,this.StretchForce=0,this.ForcePianoFingering=!1,this.Staves=null,this.TranspositionPitches=null,this.DisplayTranspositionPitches=null},AlphaTab.Settings.prototype={ToJson:function(){var e={};e.useWorker=this.UseWebWorker,e.scale=this.Scale,e.width=this.Width,e.engine=this.Engine,e.stretchForce=this.StretchForce,e.forcePianoFingering=this.ForcePianoFingering,e.transpositionPitches=this.TranspositionPitches,e.displayTranspositionPitches=this.DisplayTranspositionPitches,e.scriptFile=this.ScriptFile,e.fontDirectory=this.FontDirectory,e.lazy=this.DisableLazyLoading,e.layout={},e.layout.mode=this.Layout.Mode,e.layout.additionalSettings={};for(var t in this.Layout.AdditionalSettings)e.layout.additionalSettings[t]=this.Layout.AdditionalSettings[t];e.staves={},e.staves.id=this.Staves.Id,e.staves.additionalSettings={};for(var a in this.Staves.AdditionalSettings)e.staves.additionalSettings[a]=this.Staves.AdditionalSettings[a];return e}},AlphaTab.Settings.SetDefaults=function(e){e.UseWebWorker=!0},AlphaTab.Settings.FromJson=function(e,t){if(e instanceof AlphaTab.Settings)return e;var a=AlphaTab.Settings.get_Defaults();return a.ScriptFile=AlphaTab.Environment.ScriptFile,AlphaTab.Settings.FillFromJson(a,e,t),a},AlphaTab.Settings.FillFromJson=function(e,t,a){if(self.document&&self.window.ALPHATAB_ROOT?(e.ScriptFile=self.window.ALPHATAB_ROOT,e.ScriptFile=AlphaTab.Settings.EnsureFullUrl(e.ScriptFile),e.ScriptFile=AlphaTab.Settings.AppendScriptName(e.ScriptFile)):e.ScriptFile=AlphaTab.Environment.ScriptFile,self.document&&self.window.ALPHATAB_FONT)e.FontDirectory=self.window.ALPHATAB_FONT,e.FontDirectory=AlphaTab.Settings.EnsureFullUrl(e.FontDirectory);else if(e.FontDirectory=e.ScriptFile,null!=e.FontDirectory&&0!=e.FontDirectory.length){var i=e.FontDirectory.lastIndexOf("/");i>=0&&(e.FontDirectory=e.FontDirectory.substr(0,i)+"/Font/")}if(t&&"useWorker"in t?e.UseWebWorker=t.useWorker:null!=a&&a.hasOwnProperty("useWorker")&&(e.UseWebWorker=a.useWorker),t&&"scale"in t?e.Scale=t.scale:null!=a&&a.hasOwnProperty("scale")&&(e.Scale=a.scale),t&&"width"in t?e.Width=t.width:null!=a&&a.hasOwnProperty("width")&&(e.Width=a.width),t&&"engine"in t?e.Engine=t.engine:null!=a&&a.hasOwnProperty("engine")&&(e.Engine=a.engine),t&&"stretchForce"in t?e.StretchForce=t.stretchForce:null!=a&&a.hasOwnProperty("stretchForce")&&(e.StretchForce=a.stretchForce),t&&"forcePianoFingering"in t?e.ForcePianoFingering=t.forcePianoFingering:null!=a&&a.hasOwnProperty("forcePianoFingering")&&(e.ForcePianoFingering=a.forcePianoFingering),t&&"lazy"in t?e.DisableLazyLoading=!t.lazy:null!=a&&a.hasOwnProperty("lazy")&&(e.DisableLazyLoading=!a.lazy),t&&"transpositionPitches"in t?e.TranspositionPitches=t.transpositionPitches:null!=a&&a.hasOwnProperty("transpositionPitches")&&null!=(n=a.transpositionPitches)&&n instanceof Array&&(e.TranspositionPitches=n),t&&"displayTranspositionPitches"in t)e.DisplayTranspositionPitches=t.displayTranspositionPitches;else if(null!=a&&a.hasOwnProperty("displayTranspositionPitches")){var n=a.displayTranspositionPitches;null!=n&&n instanceof Array&&(e.DisplayTranspositionPitches=n)}if(t&&"scriptFile"in t&&(e.ScriptFile=AlphaTab.Settings.EnsureFullUrl(t.scriptFile),e.ScriptFile=AlphaTab.Settings.AppendScriptName(e.ScriptFile)),t&&"fontDirectory"in t&&(e.FontDirectory=AlphaTab.Settings.EnsureFullUrl(t.fontDirectory)),t&&"layout"in t?e.Layout=AlphaTab.Settings.LayoutFromJson(t.layout):null!=a&&a.hasOwnProperty("layout")&&(e.Layout=AlphaTab.Settings.LayoutFromJson(a.layout)),null!=a)for(var r in a)if(0==r.indexOf("layout")){l=r.substr(6);e.Layout.AdditionalSettings[l.toLowerCase()]=a[r]}if(t&&"staves"in t?e.Staves=AlphaTab.Settings.StavesFromJson(t.staves):null!=a&&a.hasOwnProperty("staves")&&(e.Staves=AlphaTab.Settings.StavesFromJson(a.staves)),null!=a)for(var r in a)if(0==r.indexOf("staves")){var l=r.substr(6);e.Staves.AdditionalSettings[l.toLowerCase()]=a[r]}},AlphaTab.Settings.StavesFromJson=function(e){var t;if("string"==typeof e)t=new AlphaTab.StaveSettings(e);else{if(!e.id)return new AlphaTab.StaveSettings("score-tab");if(t=new AlphaTab.StaveSettings(e.id),e.additionalSettings)for(var a=Object.keys(e.additionalSettings),i=0,n=a.length,r=a[i];i<n;i++,r=a[i])t.AdditionalSettings[r.toLowerCase()]=e.additionalSettings[r]}return t},AlphaTab.Settings.LayoutFromJson=function(e){var t=new AlphaTab.LayoutSettings;if("string"==typeof e)t.Mode=e;else if(e.mode&&(t.Mode=e.mode),e.additionalSettings)for(var a=Object.keys(e.additionalSettings),i=0,n=a.length,r=a[i];i<n;i++,r=a[i])t.AdditionalSettings[r.toLowerCase()]=e.additionalSettings[r];return t},AlphaTab.Settings.AppendScriptName=function(e){return null!=e&&0!=e.length&&e.lastIndexOf(".js")!=e.length-".js".length&&(e.lastIndexOf("/")!=e.length-"/".length&&(e+="/"),e+="AlphaTab.js"),e},AlphaTab.Settings.EnsureFullUrl=function(e){if(0==!e.indexOf("http")&&0==!e.indexOf("https")){var t=new String;return t+=window.location.protocol,t+="//",t+=window.location.hostname,window.location.port&&(t+=":",t+=window.location.port),t+=e,e.lastIndexOf("/")!=e.length-"/".length&&(t+="/"),t}return e},AlphaTab.Settings.get_Defaults=function(){var e=new AlphaTab.Settings;return e.Scale=1,e.StretchForce=1,e.Width=-1,e.Engine="default",e.TranspositionPitches=new Int32Array(0),e.DisplayTranspositionPitches=new Int32Array(0),e.Layout=AlphaTab.LayoutSettings.get_Defaults(),e.Staves=new AlphaTab.StaveSettings("default"),AlphaTab.Settings.SetDefaults(e),e},AlphaTab.Audio=AlphaTab.Audio||{},AlphaTab.Audio.GeneralMidi=function(){},$StaticConstructor(function(){AlphaTab.Audio.GeneralMidi._values=null}),AlphaTab.Audio.GeneralMidi.GetValue=function(e){return null==AlphaTab.Audio.GeneralMidi._values&&(AlphaTab.Audio.GeneralMidi._values={},AlphaTab.Audio.GeneralMidi._values.acousticgrandpiano=0,AlphaTab.Audio.GeneralMidi._values.brightacousticpiano=1,AlphaTab.Audio.GeneralMidi._values.electricgrandpiano=2,AlphaTab.Audio.GeneralMidi._values.honkytonkpiano=3,AlphaTab.Audio.GeneralMidi._values.electricpiano1=4,AlphaTab.Audio.GeneralMidi._values.electricpiano2=5,AlphaTab.Audio.GeneralMidi._values.harpsichord=6,AlphaTab.Audio.GeneralMidi._values.clavinet=7,AlphaTab.Audio.GeneralMidi._values.celesta=8,AlphaTab.Audio.GeneralMidi._values.glockenspiel=9,AlphaTab.Audio.GeneralMidi._values.musicbox=10,AlphaTab.Audio.GeneralMidi._values.vibraphone=11,AlphaTab.Audio.GeneralMidi._values.marimba=12,AlphaTab.Audio.GeneralMidi._values.xylophone=13,AlphaTab.Audio.GeneralMidi._values.tubularbells=14,AlphaTab.Audio.GeneralMidi._values.dulcimer=15,AlphaTab.Audio.GeneralMidi._values.drawbarorgan=16,AlphaTab.Audio.GeneralMidi._values.percussiveorgan=17,AlphaTab.Audio.GeneralMidi._values.rockorgan=18,AlphaTab.Audio.GeneralMidi._values.churchorgan=19,AlphaTab.Audio.GeneralMidi._values.reedorgan=20,AlphaTab.Audio.GeneralMidi._values.accordion=21,AlphaTab.Audio.GeneralMidi._values.harmonica=22,AlphaTab.Audio.GeneralMidi._values.tangoaccordion=23,AlphaTab.Audio.GeneralMidi._values.acousticguitarnylon=24,AlphaTab.Audio.GeneralMidi._values.acousticguitarsteel=25,AlphaTab.Audio.GeneralMidi._values.electricguitarjazz=26,AlphaTab.Audio.GeneralMidi._values.electricguitarclean=27,AlphaTab.Audio.GeneralMidi._values.electricguitarmuted=28,AlphaTab.Audio.GeneralMidi._values.overdrivenguitar=29,AlphaTab.Audio.GeneralMidi._values.distortionguitar=30,AlphaTab.Audio.GeneralMidi._values.guitarharmonics=31,AlphaTab.Audio.GeneralMidi._values.acousticbass=32,AlphaTab.Audio.GeneralMidi._values.electricbassfinger=33,AlphaTab.Audio.GeneralMidi._values.electricbasspick=34,AlphaTab.Audio.GeneralMidi._values.fretlessbass=35,AlphaTab.Audio.GeneralMidi._values.slapbass1=36,AlphaTab.Audio.GeneralMidi._values.slapbass2=37,AlphaTab.Audio.GeneralMidi._values.synthbass1=38,AlphaTab.Audio.GeneralMidi._values.synthbass2=39,AlphaTab.Audio.GeneralMidi._values.violin=40,AlphaTab.Audio.GeneralMidi._values.viola=41,AlphaTab.Audio.GeneralMidi._values.cello=42,AlphaTab.Audio.GeneralMidi._values.contrabass=43,AlphaTab.Audio.GeneralMidi._values.tremolostrings=44,AlphaTab.Audio.GeneralMidi._values.pizzicatostrings=45,AlphaTab.Audio.GeneralMidi._values.orchestralharp=46,AlphaTab.Audio.GeneralMidi._values.timpani=47,AlphaTab.Audio.GeneralMidi._values.stringensemble1=48,AlphaTab.Audio.GeneralMidi._values.stringensemble2=49,AlphaTab.Audio.GeneralMidi._values.synthstrings1=50,AlphaTab.Audio.GeneralMidi._values.synthstrings2=51,AlphaTab.Audio.GeneralMidi._values.choiraahs=52,AlphaTab.Audio.GeneralMidi._values.voiceoohs=53,AlphaTab.Audio.GeneralMidi._values.synthvoice=54,AlphaTab.Audio.GeneralMidi._values.orchestrahit=55,AlphaTab.Audio.GeneralMidi._values.trumpet=56,AlphaTab.Audio.GeneralMidi._values.trombone=57,AlphaTab.Audio.GeneralMidi._values.tuba=58,AlphaTab.Audio.GeneralMidi._values.mutedtrumpet=59,AlphaTab.Audio.GeneralMidi._values.frenchhorn=60,AlphaTab.Audio.GeneralMidi._values.brasssection=61,AlphaTab.Audio.GeneralMidi._values.synthbrass1=62,AlphaTab.Audio.GeneralMidi._values.synthbrass2=63,AlphaTab.Audio.GeneralMidi._values.sopranosax=64,AlphaTab.Audio.GeneralMidi._values.altosax=65,AlphaTab.Audio.GeneralMidi._values.tenorsax=66,AlphaTab.Audio.GeneralMidi._values.baritonesax=67,AlphaTab.Audio.GeneralMidi._values.oboe=68,AlphaTab.Audio.GeneralMidi._values.englishhorn=69,AlphaTab.Audio.GeneralMidi._values.bassoon=70,AlphaTab.Audio.GeneralMidi._values.clarinet=71,AlphaTab.Audio.GeneralMidi._values.piccolo=72,AlphaTab.Audio.GeneralMidi._values.flute=73,AlphaTab.Audio.GeneralMidi._values.recorder=74,AlphaTab.Audio.GeneralMidi._values.panflute=75,AlphaTab.Audio.GeneralMidi._values.blownbottle=76,AlphaTab.Audio.GeneralMidi._values.shakuhachi=77,AlphaTab.Audio.GeneralMidi._values.whistle=78,AlphaTab.Audio.GeneralMidi._values.ocarina=79,AlphaTab.Audio.GeneralMidi._values.lead1square=80,AlphaTab.Audio.GeneralMidi._values.lead2sawtooth=81,AlphaTab.Audio.GeneralMidi._values.lead3calliope=82,AlphaTab.Audio.GeneralMidi._values.lead4chiff=83,AlphaTab.Audio.GeneralMidi._values.lead5charang=84,AlphaTab.Audio.GeneralMidi._values.lead6voice=85,AlphaTab.Audio.GeneralMidi._values.lead7fifths=86,AlphaTab.Audio.GeneralMidi._values.lead8bassandlead=87,AlphaTab.Audio.GeneralMidi._values.pad1newage=88,AlphaTab.Audio.GeneralMidi._values.pad2warm=89,AlphaTab.Audio.GeneralMidi._values.pad3polysynth=90,AlphaTab.Audio.GeneralMidi._values.pad4choir=91,AlphaTab.Audio.GeneralMidi._values.pad5bowed=92,AlphaTab.Audio.GeneralMidi._values.pad6metallic=93,AlphaTab.Audio.GeneralMidi._values.pad7halo=94,AlphaTab.Audio.GeneralMidi._values.pad8sweep=95,AlphaTab.Audio.GeneralMidi._values.fx1rain=96,AlphaTab.Audio.GeneralMidi._values.fx2soundtrack=97,AlphaTab.Audio.GeneralMidi._values.fx3crystal=98,AlphaTab.Audio.GeneralMidi._values.fx4atmosphere=99,AlphaTab.Audio.GeneralMidi._values.fx5brightness=100,AlphaTab.Audio.GeneralMidi._values.fx6goblins=101,AlphaTab.Audio.GeneralMidi._values.fx7echoes=102,AlphaTab.Audio.GeneralMidi._values.fx8scifi=103,AlphaTab.Audio.GeneralMidi._values.sitar=104,AlphaTab.Audio.GeneralMidi._values.banjo=105,AlphaTab.Audio.GeneralMidi._values.shamisen=106,AlphaTab.Audio.GeneralMidi._values.koto=107,AlphaTab.Audio.GeneralMidi._values.kalimba=108,AlphaTab.Audio.GeneralMidi._values.bagpipe=109,AlphaTab.Audio.GeneralMidi._values.fiddle=110,AlphaTab.Audio.GeneralMidi._values.shanai=111,AlphaTab.Audio.GeneralMidi._values.tinklebell=112,AlphaTab.Audio.GeneralMidi._values.agogo=113,AlphaTab.Audio.GeneralMidi._values.steeldrums=114,AlphaTab.Audio.GeneralMidi._values.woodblock=115,AlphaTab.Audio.GeneralMidi._values.taikodrum=116,AlphaTab.Audio.GeneralMidi._values.melodictom=117,AlphaTab.Audio.GeneralMidi._values.synthdrum=118,AlphaTab.Audio.GeneralMidi._values.reversecymbal=119,AlphaTab.Audio.GeneralMidi._values.guitarfretnoise=120,AlphaTab.Audio.GeneralMidi._values.breathnoise=121,AlphaTab.Audio.GeneralMidi._values.seashore=122,AlphaTab.Audio.GeneralMidi._values.birdtweet=123,AlphaTab.Audio.GeneralMidi._values.telephonering=124,AlphaTab.Audio.GeneralMidi._values.helicopter=125,AlphaTab.Audio.GeneralMidi._values.applause=126,AlphaTab.Audio.GeneralMidi._values.gunshot=127),e=e.toLowerCase().replace(" ",""),AlphaTab.Audio.GeneralMidi._values.hasOwnProperty(e)?AlphaTab.Audio.GeneralMidi._values[e]:0},AlphaTab.Audio.GeneralMidi.IsPiano=function(e){return e<=7||e>=16&&e<=23},AlphaTab.Audio.GeneralMidi.IsGuitar=function(e){return e>=24&&e<=39||105==e||43==e},AlphaTab.Audio.Generator=AlphaTab.Audio.Generator||{},AlphaTab.Audio.Generator.MidiFileGenerator=function(e,t){this._score=null,this._handler=null,this._currentTempo=0,this.TickLookup=null,this._score=e,this._currentTempo=this._score.Tempo,this._handler=t,this.TickLookup=new AlphaTab.Audio.Model.MidiTickLookup},AlphaTab.Audio.Generator.MidiFileGenerator.prototype={Generate:function(){for(var e=0,t=this._score.Tracks.length;e<t;e++)this.GenerateTrack(this._score.Tracks[e]);for(var a=new AlphaTab.Audio.Generator.MidiPlaybackController(this._score),i=null;!a.get_Finished();){var n=a.Index,r=this._score.MasterBars[n],l=a.CurrentTick;if(a.ProcessCurrent(),a.ShouldPlay){this.GenerateMasterBar(r,i,l);for(var e=0,t=this._score.Tracks.length;e<t;e++)for(var s=this._score.Tracks[e],o=0,h=s.Staves.length;o<h;o++){var p=s.Staves[o];n<p.Bars.length&&this.GenerateBar(p.Bars[n],l)}}a.MoveNext(),i=r}for(var e=0,t=this._score.Tracks.length;e<t;e++)this._handler.FinishTrack(this._score.Tracks[e].Index,a.CurrentTick);this.TickLookup.Finish()},GenerateTrack:function(e){this.GenerateChannel(e,e.PlaybackInfo.PrimaryChannel,e.PlaybackInfo),e.PlaybackInfo.PrimaryChannel!=e.PlaybackInfo.SecondaryChannel&&this.GenerateChannel(e,e.PlaybackInfo.SecondaryChannel,e.PlaybackInfo)},GenerateChannel:function(e,t,a){var i=AlphaTab.Audio.Generator.MidiFileGenerator.ToChannelShort(a.Volume),n=AlphaTab.Audio.Generator.MidiFileGenerator.ToChannelShort(a.Balance);this._handler.AddControlChange(e.Index,0,t,7,i),this._handler.AddControlChange(e.Index,0,t,10,n),this._handler.AddControlChange(e.Index,0,t,11,127),this._handler.AddControlChange(e.Index,0,t,100,0),this._handler.AddControlChange(e.Index,0,t,101,0),this._handler.AddControlChange(e.Index,0,t,38,0),this._handler.AddControlChange(e.Index,0,t,6,12),this._handler.AddProgramChange(e.Index,0,t,a.Program)},GenerateMasterBar:function(e,t,a){null!=t&&t.TimeSignatureDenominator==e.TimeSignatureDenominator&&t.TimeSignatureNumerator==e.TimeSignatureNumerator||this._handler.AddTimeSignature(a,e.TimeSignatureNumerator,e.TimeSignatureDenominator),null==t?(this._handler.AddTempo(a,e.Score.Tempo),this._currentTempo=e.Score.Tempo):null!=e.TempoAutomation&&(this._handler.AddTempo(a,0|e.TempoAutomation.Value),this._currentTempo=0|e.TempoAutomation.Value);var i=new AlphaTab.Audio.Model.MasterBarTickLookup;i.MasterBar=e,i.Start=a,i.Tempo=this._currentTempo,i.End=i.Start+e.CalculateDuration(),this.TickLookup.AddMasterBar(i)},GenerateBar:function(e,t){for(var a=0,i=e.Voices.length;a<i;a++)this.GenerateVoice(e.Voices[a],t)},GenerateVoice:function(e,t){if(!e.IsEmpty||e.Bar.get_IsEmpty()&&0==e.Index)for(var a=0,i=e.Beats.length;a<i;a++)this.GenerateBeat(e.Beats[a],t)},GenerateBeat:function(e,t){var a=e.Start,i=e.Voice.Bar.get_IsEmpty()?e.Voice.Bar.get_MasterBar().CalculateDuration():e.CalculateDuration(),n=new AlphaTab.Audio.Model.BeatTickLookup;n.Start=t+a;var r=null==e.NextBeat?i:e.NextBeat.get_AbsoluteStart()-e.get_AbsoluteStart();n.End=t+a+(r>i?r:i),n.Beat=e,this.TickLookup.AddBeat(n);for(var l=e.Voice.Bar.Staff.Track,s=0,o=e.Automations.length;s<o;s++)this.GenerateAutomation(e,e.Automations[s],t);if(e.get_IsRest())this._handler.AddRest(l.Index,t+a,l.PlaybackInfo.PrimaryChannel);else for(var h=this.GetBrushInfo(e),s=0,o=e.Notes.length;s<o;s++){var p=e.Notes[s];this.GenerateNote(p,t+a,i,h)}if(e.Vibrato!=AlphaTab.Model.VibratoType.None){this.GenerateVibratorWithParams(e.Voice.Bar.Staff.Track,t+a,e.CalculateDuration(),240,3)}},GenerateNote:function(e,t,a,i){var n=e.Beat.Voice.Bar.Staff.Track,r=e.get_RealValue(),l=e.get_IsStringed()&&e.String<=i.length?i[e.String-1]:0,s=t+l,o=this.GetNoteDuration(e,a)-l,h=this.GetDynamicValue(e);e.get_HasBend()||this._handler.AddBend(n.Index,s,n.PlaybackInfo.PrimaryChannel,64),e.Beat.FadeIn&&this.GenerateFadeIn(e,s,o,r,h),!e.get_IsTrill()||n.IsPercussion?e.Beat.get_IsTremolo()?this.GenerateTremoloPicking(e,s,o,r,h):(e.get_HasBend()?this.GenerateBend(e,s,o,r,h):e.Beat.get_HasWhammyBar()?this.GenerateWhammyBar(e,s,o,r,h):e.SlideType!=AlphaTab.Model.SlideType.None?this.GenerateSlide(e,s,o,r,h):e.Vibrato!=AlphaTab.Model.VibratoType.None&&this.GenerateVibrato(e,s,o,r,h),e.HarmonicType!=AlphaTab.Model.HarmonicType.None&&this.GenerateHarmonic(e,s,o,r,h),e.IsTieDestination||this._handler.AddNote(n.Index,s,o,r,h,n.PlaybackInfo.PrimaryChannel)):this.GenerateTrill(e,s,o,r,h)},GetNoteDuration:function(e,t){return this.ApplyDurationEffects(e,t)},ApplyDurationEffects:function(e,t){if(e.IsDead)return this.ApplyStaticDuration(30,t);if(e.IsPalmMute)return this.ApplyStaticDuration(80,t);if(e.IsStaccato)return t/2|0;if(e.IsTieOrigin){var a=e.TieDestination;if(e.IsTieDestination)return t+this.GetNoteDuration(a,a.Beat.CalculateDuration());var i=e.Beat.get_AbsoluteStart();return a.Beat.get_AbsoluteStart()+this.GetNoteDuration(a,a.Beat.CalculateDuration())-i}return t},ApplyStaticDuration:function(e,t){var a=this._currentTempo*e/60|0;return Math.min(a,t)},GetDynamicValue:function(e){var t=e.Dynamic;switch(e.Beat.Voice.Bar.Staff.Track.IsPercussion||null==e.HammerPullOrigin||t--,e.IsGhost&&t--,e.Accentuated){case AlphaTab.Model.AccentuationType.Normal:t++;break;case AlphaTab.Model.AccentuationType.Heavy:t+=2}return t},GenerateFadeIn:function(e,t,a,i,n){for(var r=e.Beat.Voice.Bar.Staff.Track,l=AlphaTab.Audio.Generator.MidiFileGenerator.ToChannelShort(r.PlaybackInfo.Volume)/a,s=a/120|0,o=t+a,h=s-1;h>=0;h--){var p=o-120*h,d=(p-t)*l;h==s-1&&(this._handler.AddControlChange(r.Index,t,r.PlaybackInfo.PrimaryChannel,7,d),this._handler.AddControlChange(r.Index,t,r.PlaybackInfo.SecondaryChannel,7,d)),this._handler.AddControlChange(r.Index,p,r.PlaybackInfo.PrimaryChannel,7,d),this._handler.AddControlChange(r.Index,p,r.PlaybackInfo.SecondaryChannel,7,d)}},GenerateHarmonic:function(e,t,a,i,n){},GenerateVibrato:function(e,t,a,i,n){var r=e.Beat.Voice.Bar.Staff.Track;this.GenerateVibratorWithParams(r,t,a,480,2)},GenerateVibratorWithParams:function(e,t,a,i,n){for(var r=i/2|0,l=(t+=i)+a;t<l;){for(var s=0,o=t+i<l?i:l-t;s<o;){var h=n*Math.sin(3.14159265358979*s/r);this._handler.AddBend(e.Index,t+s,e.PlaybackInfo.PrimaryChannel,64+h),s+=16}t+=i}},GenerateSlide:function(e,t,a,i,n){},GenerateWhammyBar:function(e,t,a,i,n){},GenerateBend:function(e,t,a,i,n){for(var r=e.Beat.Voice.Bar.Staff.Track,l=a/60,s=0;s<e.BendPoints.length-1;s++){var o=e.BendPoints[s],h=e.BendPoints[s+1],p=64+2.75*o.Value,d=64+2.75*h.Value,u=l*(h.Offset-o.Offset)/Math.abs(d-p),c=t+l*o.Offset;if(p<d)for(;p<=d;)this._handler.AddBend(r.Index,0|c,r.PlaybackInfo.PrimaryChannel,Math.round(p)),p++,c+=u;else if(p>d)for(;p>=d;)this._handler.AddBend(r.Index,0|c,r.PlaybackInfo.PrimaryChannel,Math.round(p)),p--,c+=u}},GenerateTrill:function(e,t,a,i,n){for(var r=e.Beat.Voice.Bar.Staff.Track,l=e.get_StringTuning()+e.get_TrillFret(),s=AlphaTab.Audio.MidiUtils.ToTicks(e.TrillSpeed),o=!0,h=t;h+10<t+a;)h+s>=t+a&&(s=t+a-h),this._handler.AddNote(r.Index,h,s,o?l:i,n,r.PlaybackInfo.PrimaryChannel),o=!o,h+=s},GenerateTremoloPicking:function(e,t,a,i,n){for(var r=e.Beat.Voice.Bar.Staff.Track,l=AlphaTab.Audio.MidiUtils.ToTicks(e.Beat.TremoloSpeed),s=t;s+10<t+a;)s+l>=t+a&&(l=t+a-s),this._handler.AddNote(r.Index,s,l,i,n,r.PlaybackInfo.PrimaryChannel),s+=l},GetBrushInfo:function(e){var t=new Int32Array(e.Voice.Bar.Staff.Track.Tuning.length);if(e.BrushType!=AlphaTab.Model.BrushType.None){for(var a=0,i=0,n=e.Notes.length;i<n;i++){var r=e.Notes[i];r.IsTieDestination||(a|=1<<r.String-1)}if(e.Notes.length>0)for(var l=0,s=this.GetBrushIncrement(e),i=0,n=e.Voice.Bar.Staff.Track.Tuning.length;i<n;i++){var o=e.BrushType==AlphaTab.Model.BrushType.ArpeggioDown||e.BrushType==AlphaTab.Model.BrushType.BrushDown?i:t.length-1-i;0!=(a&1<<o)&&(t[o]=l,l=s)}}return t},GetBrushIncrement:function(e){if(0==e.BrushDuration)return 0;var t=e.CalculateDuration();return 0==t?0:t/8*(4/e.BrushDuration)|0},GenerateAutomation:function(e,t,a){switch(t.Type){case AlphaTab.Model.AutomationType.Instrument:this._handler.AddProgramChange(e.Voice.Bar.Staff.Track.Index,e.Start+a,e.Voice.Bar.Staff.Track.PlaybackInfo.PrimaryChannel,t.Value),this._handler.AddProgramChange(e.Voice.Bar.Staff.Track.Index,e.Start+a,e.Voice.Bar.Staff.Track.PlaybackInfo.SecondaryChannel,t.Value);break;case AlphaTab.Model.AutomationType.Balance:var i=AlphaTab.Audio.Generator.MidiFileGenerator.ToChannelShort(0|t.Value);this._handler.AddControlChange(e.Voice.Bar.Staff.Track.Index,e.Start+a,e.Voice.Bar.Staff.Track.PlaybackInfo.PrimaryChannel,10,i),this._handler.AddControlChange(e.Voice.Bar.Staff.Track.Index,e.Start+a,e.Voice.Bar.Staff.Track.PlaybackInfo.SecondaryChannel,10,i);break;case AlphaTab.Model.AutomationType.Volume:var n=AlphaTab.Audio.Generator.MidiFileGenerator.ToChannelShort(0|t.Value);this._handler.AddControlChange(e.Voice.Bar.Staff.Track.Index,e.Start+a,e.Voice.Bar.Staff.Track.PlaybackInfo.PrimaryChannel,7,n),this._handler.AddControlChange(e.Voice.Bar.Staff.Track.Index,e.Start+a,e.Voice.Bar.Staff.Track.PlaybackInfo.SecondaryChannel,7,n)}}},$StaticConstructor(function(){AlphaTab.Audio.Generator.MidiFileGenerator.DefaultBend=64,AlphaTab.Audio.Generator.MidiFileGenerator.DefaultBendSemitone=2.75}),AlphaTab.Audio.Generator.MidiFileGenerator.GenerateMidiFile=function(e){for(var t=new AlphaTab.Audio.Model.MidiFile,a=0,i=e.Tracks.length;a<i;a++)t.CreateTrack();t.InfoTrack=0;var n=new AlphaTab.Audio.Generator.MidiFileHandler(t),r=new AlphaTab.Audio.Generator.MidiFileGenerator(e,n);return r.Generate(),t.TickLookup=r.TickLookup,t},AlphaTab.Audio.Generator.MidiFileGenerator.ToChannelShort=function(e){var t=Math.max(-32768,Math.min(32767,8*e-1));return Math.max(t,-1)+1},AlphaTab.Audio.Generator.MidiFileHandler=function(e){this._midiFile=null,this._midiFile=e},AlphaTab.Audio.Generator.MidiFileHandler.prototype={AddEvent:function(e,t,a){this._midiFile.Tracks[e].AddEvent(new AlphaTab.Audio.Model.MidiEvent(t,a))},MakeCommand:function(e,t){return 240&e|15&t},AddTimeSignature:function(e,t,a){for(var i=0;(a>>=1)>0;)i++;this.AddEvent(this._midiFile.InfoTrack,e,AlphaTab.Audio.Generator.MidiFileHandler.BuildMetaMessage(88,new Uint8Array([255&t,255&i,48,8])))},AddRest:function(e,t,a){this.AddEvent(e,t,AlphaTab.Audio.Generator.MidiFileHandler.BuildSysExMessage(new Uint8Array([0])))},AddNote:function(e,t,a,i,n,r){var l=AlphaTab.Audio.MidiUtils.DynamicToVelocity(n);this.AddEvent(e,t,new AlphaTab.Audio.Model.MidiMessage(new Uint8Array([this.MakeCommand(144,r),AlphaTab.Audio.Generator.MidiFileHandler.FixValue(i),AlphaTab.Audio.Generator.MidiFileHandler.FixValue(l)]))),this.AddEvent(e,t+a,new AlphaTab.Audio.Model.MidiMessage(new Uint8Array([this.MakeCommand(128,r),AlphaTab.Audio.Generator.MidiFileHandler.FixValue(i),AlphaTab.Audio.Generator.MidiFileHandler.FixValue(l)])))},AddControlChange:function(e,t,a,i,n){this.AddEvent(e,t,new AlphaTab.Audio.Model.MidiMessage(new Uint8Array([this.MakeCommand(176,a),AlphaTab.Audio.Generator.MidiFileHandler.FixValue(i),AlphaTab.Audio.Generator.MidiFileHandler.FixValue(n)])))},AddProgramChange:function(e,t,a,i){this.AddEvent(e,t,new AlphaTab.Audio.Model.MidiMessage(new Uint8Array([this.MakeCommand(192,a),AlphaTab.Audio.Generator.MidiFileHandler.FixValue(i)])))},AddTempo:function(e,t){var a=6e7/t|0;this.AddEvent(this._midiFile.InfoTrack,e,AlphaTab.Audio.Generator.MidiFileHandler.BuildMetaMessage(81,new Uint8Array([a>>16&255,a>>8&255,255&a])))},FinishTrack:function(e,t){this.AddEvent(this._midiFile.InfoTrack,t,AlphaTab.Audio.Generator.MidiFileHandler.BuildMetaMessage(47,new Uint8Array(0)))},AddBend:function(e,t,a,i){this.AddEvent(e,t,new AlphaTab.Audio.Model.MidiMessage(new Uint8Array([this.MakeCommand(224,a),0,AlphaTab.Audio.Generator.MidiFileHandler.FixValue(i)])))}},$StaticConstructor(function(){AlphaTab.Audio.Generator.MidiFileHandler.DefaultMetronomeKey=37,AlphaTab.Audio.Generator.MidiFileHandler.DefaultDurationDead=30,AlphaTab.Audio.Generator.MidiFileHandler.DefaultDurationPalmMute=80,AlphaTab.Audio.Generator.MidiFileHandler.RestMessage=0}),AlphaTab.Audio.Generator.MidiFileHandler.FixValue=function(e){return e>127?127:e},AlphaTab.Audio.Generator.MidiFileHandler.BuildMetaMessage=function(e,t){var a=AlphaTab.IO.ByteBuffer.Empty();return a.WriteByte(255),a.WriteByte(255&e),AlphaTab.Audio.Generator.MidiFileHandler.WriteVarInt(a,t.length),a.Write(t,0,t.length),new AlphaTab.Audio.Model.MidiMessage(a.ToArray())},AlphaTab.Audio.Generator.MidiFileHandler.WriteVarInt=function(e,t){var a=0,i=new Uint8Array(4);do{i[a++]=127&t,t>>=7}while(t>0);for(;a>0;)--a>0?e.WriteByte(255&(128|i[a])):e.WriteByte(i[a])},AlphaTab.Audio.Generator.MidiFileHandler.BuildSysExMessage=function(e){var t=AlphaTab.IO.ByteBuffer.Empty();return t.WriteByte(240),AlphaTab.Audio.Generator.MidiFileHandler.WriteVarInt(t,e.length+2),t.WriteByte(0),t.Write(e,0,e.length),t.WriteByte(247),new AlphaTab.Audio.Model.MidiMessage(t.ToArray())},AlphaTab.Audio.Generator.MidiPlaybackController=function(e){this._score=null,this._repeatStartIndex=0,this._repeatNumber=0,this._repeatOpen=!1,this.ShouldPlay=!1,this.Index=0,this.CurrentTick=0,this._score=e,this.ShouldPlay=!0,this.Index=0,this.CurrentTick=0},AlphaTab.Audio.Generator.MidiPlaybackController.prototype={get_Finished:function(){return this.Index>=this._score.MasterBars.length},ProcessCurrent:function(){var e=this._score.MasterBars[this.Index],t=e.AlternateEndings;e.RepeatGroup.IsClosed||e.RepeatGroup.Openings[e.RepeatGroup.Openings.length-1]!=e||(this._repeatNumber=0,this._repeatOpen=!1),!e.IsRepeatStart&&0!=e.Index||0!=this._repeatNumber?e.IsRepeatStart&&(this.ShouldPlay=!0):(this._repeatStartIndex=this.Index,this._repeatOpen=!0),this._repeatOpen&&t>0&&(0==(t&1<<this._repeatNumber)?this.ShouldPlay=!1:this.ShouldPlay=!0),this.ShouldPlay&&(this.CurrentTick+=e.CalculateDuration())},MoveNext:function(){var e=this._score.MasterBars[this.Index].RepeatCount-1;this._repeatOpen&&e>0?this._repeatNumber<e?(this.Index=this._repeatStartIndex,this._repeatNumber++):(this._repeatNumber=0,this._repeatOpen=!1,this.ShouldPlay=!0,this.Index++):this.Index++}},AlphaTab.Audio.MidiUtils=function(){},$StaticConstructor(function(){AlphaTab.Audio.MidiUtils.QuarterTime=960,AlphaTab.Audio.MidiUtils.PercussionChannel=9,AlphaTab.Audio.MidiUtils.MinVelocity=15,AlphaTab.Audio.MidiUtils.VelocityIncrement=16}),AlphaTab.Audio.MidiUtils.TicksToMillis=function(e,t){return e*(6e4/(960*t))|0},AlphaTab.Audio.MidiUtils.ToTicks=function(e){return AlphaTab.Audio.MidiUtils.ValueToTicks(e)},AlphaTab.Audio.MidiUtils.ValueToTicks=function(e){var t=e;return t<0&&(t=1/-t),4/t*960|0},AlphaTab.Audio.MidiUtils.ApplyDot=function(e,t){return t?e+3*(e/4|0):e+e/2|0},AlphaTab.Audio.MidiUtils.ApplyTuplet=function(e,t,a){return e*a/t|0},AlphaTab.Audio.MidiUtils.DynamicToVelocity=function(e){return 15+16*e},AlphaTab.Audio.Model=AlphaTab.Audio.Model||{},AlphaTab.Audio.Model.MidiController={DataEntryCoarse:6,VolumeCoarse:7,PanCoarse:10,ExpressionControllerCoarse:11,DataEntryFine:38,RegisteredParameterFine:100,RegisteredParameterCourse:101},AlphaTab.Audio.Model.MidiEvent=function(e,t){this.Track=null,this.Tick=0,this.Message=null,this.NextEvent=null,this.PreviousEvent=null,this.Tick=e,this.Message=t},AlphaTab.Audio.Model.MidiEvent.prototype={get_DeltaTicks:function(){return null==this.PreviousEvent?0:this.Tick-this.PreviousEvent.Tick},WriteTo:function(e){this.WriteVariableInt(e,this.get_DeltaTicks()),this.Message.WriteTo(e)},WriteVariableInt:function(e,t){var a=new Uint8Array(4),i=0;do{a[i++]=127&t,t>>=7}while(t>0);for(;i>0;)--i>0?e.WriteByte(128|a[i]):e.WriteByte(a[i])}},AlphaTab.Audio.Model.MidiFile=function(){this.TickLookup=null,this.Tracks=null,this.InfoTrack=0,this.Tracks=[]},AlphaTab.Audio.Model.MidiFile.prototype={CreateTrack:function(){var e=new AlphaTab.Audio.Model.MidiTrack;return e.Index=this.Tracks.length,e.File=this,this.Tracks.push(e),e},WriteTo:function(e){var t=new Uint8Array([77,84,104,100]);e.Write(t,0,t.length),t=new Uint8Array([0,0,0,6]),e.Write(t,0,t.length),t=new Uint8Array([0,1]),e.Write(t,0,t.length);var a=0|this.Tracks.length;t=new Uint8Array([a>>8&255,255&a]),e.Write(t,0,t.length),t=new Uint8Array([(a=960)>>8&255,255&a]),e.Write(t,0,t.length);for(var i=0,n=this.Tracks.length;i<n;i++)this.Tracks[i].WriteTo(e)}},AlphaTab.Audio.Model.MidiMessage=function(e){this.Event=null,this.Data=null,this.Data=e},AlphaTab.Audio.Model.MidiMessage.prototype={WriteTo:function(e){e.Write(this.Data,0,this.Data.length)}},AlphaTab.Audio.Model.BeatTickLookup=function(){this.Start=0,this.End=0,this.Beat=null},AlphaTab.Audio.Model.MasterBarTickLookup=function(){this.Start=0,this.End=0,this.Tempo=0,this.MasterBar=null,this.Beats=null,this.Beats=[]},AlphaTab.Audio.Model.MasterBarTickLookup.prototype={Finish:function(){this.Beats.sort($CreateAnonymousDelegate(this,function(e,t){return e.Start-t.Start}))},AddBeat:function(e){this.Beats.push(e)}},AlphaTab.Audio.Model.MidiTickLookupFindBeatResult=function(){this.CurrentBeat=null,this.NextBeat=null,this.Duration=0},AlphaTab.Audio.Model.MidiTickLookup=function(){this._currentMasterBar=null,this.MasterBarLookup=null,this.MasterBars=null,this.MasterBars=[],this.MasterBarLookup={}},AlphaTab.Audio.Model.MidiTickLookup.prototype={Finish:function(){for(var e=0;e<this.MasterBars.length;e++)this.MasterBars[e].Finish()},FindBeat:function(e,t){var a=this.FindMasterBar(t);if(null==a)return null;for(var i={},n=0,r=e.length,l=e[n];n<r;n++,l=e[n])i[l.Index]=!0;for(var s=null,o=0,h=a.Beats,p=0;p<h.length;p++){u=h[p];if(i.hasOwnProperty(u.Beat.Voice.Bar.Staff.Track.Index))if(u.Start<=t&&t<u.End)(null==s||s.Start<u.Start)&&(s=h[p],o=p);else if(u.End>t)break}if(null==s)return null;for(var d=null,p=o+1;p<h.length;p++){u=h[p];if(i.hasOwnProperty(u.Beat.Voice.Bar.Staff.Track.Index)){d=u;break}}if(null==d&&null!=a.MasterBar.NextMasterBar){h=this.GetMasterBar(a.MasterBar.NextMasterBar).Beats;for(p=0;p<h.length;p++){var u=h[p];if(i.hasOwnProperty(u.Beat.Voice.Bar.Staff.Track.Index)){d=u;break}}}var c=new AlphaTab.Audio.Model.MidiTickLookupFindBeatResult;return c.CurrentBeat=s.Beat,c.NextBeat=null==d?null:d.Beat,c.Duration=AlphaTab.Audio.MidiUtils.TicksToMillis(s.End-s.Start,a.Tempo),c},FindMasterBar:function(e){for(var t=this.MasterBars,a=0,i=t.length-1;a<=i;){var n=(i+a)/2|0,r=t[n];if(e>=r.Start&&e<r.End)return r;e<r.Start?i=n-1:a=n+1}return null},GetMasterBar:function(e){return this.MasterBarLookup.hasOwnProperty(e.Index)?this.MasterBarLookup[e.Index]:function(){var t=new AlphaTab.Audio.Model.MasterBarTickLookup;return t.Start=0,t.End=0,t.Beats=[],t.MasterBar=e,t}.call(this)},GetMasterBarStart:function(e){return this.MasterBarLookup.hasOwnProperty(e.Index)?this.MasterBarLookup[e.Index].Start:0},AddMasterBar:function(e){this.MasterBars.push(e),this._currentMasterBar=e,this.MasterBarLookup.hasOwnProperty(e.MasterBar.Index)||(this.MasterBarLookup[e.MasterBar.Index]=e)},AddBeat:function(e){this._currentMasterBar.AddBeat(e)}},AlphaTab.Audio.Model.MidiTrack=function(){this.Index=0,this.File=null,this.FirstEvent=null,this.LastEvent=null},AlphaTab.Audio.Model.MidiTrack.prototype={AddEvent:function(e){if(e.Track=this,null==this.FirstEvent)this.FirstEvent=e,this.LastEvent=e;else if(this.LastEvent.Tick<=e.Tick)this.LastEvent.NextEvent=e,e.PreviousEvent=this.LastEvent,this.LastEvent=e;else if(this.FirstEvent.Tick>e.Tick)e.NextEvent=this.FirstEvent,this.FirstEvent.PreviousEvent=e,this.FirstEvent=e;else if(e.Tick-this.FirstEvent.Tick<this.LastEvent.Tick-e.Tick){for(a=this.FirstEvent;null!=a&&null!=a.NextEvent&&a.NextEvent.Tick<=e.Tick;)a=a.NextEvent;if(null==a)return;t=a.NextEvent;a.NextEvent=e,e.PreviousEvent=a,e.NextEvent=t,null!=t&&(t.PreviousEvent=e)}else{for(var t=this.LastEvent;null!=t&&null!=t.PreviousEvent&&t.PreviousEvent.Tick>e.Tick;)t=t.PreviousEvent;if(null==t)return;var a=t.PreviousEvent;t.PreviousEvent=e,e.NextEvent=t,e.PreviousEvent=a,null!=a?a.NextEvent=e:this.FirstEvent=e}},WriteTo:function(e){for(var t=AlphaTab.IO.ByteBuffer.Empty(),a=this.FirstEvent,i=0;null!=a;)a.WriteTo(t),a=a.NextEvent,i++;var n=new Uint8Array([77,84,114,107]);e.Write(n,0,n.length);var r=t.ToArray(),l=r.length;n=new Uint8Array([l>>24&255,l>>16&255,l>>8&255,l>>0&255]),e.Write(n,0,n.length),e.Write(r,0,r.length)}},AlphaTab.Exporter=AlphaTab.Exporter||{},AlphaTab.Exporter.AlphaTexExporter=function(){this._builder=null,this._builder=new String},AlphaTab.Exporter.AlphaTexExporter.prototype={Export:function(e){this.Score(e)},Score:function(e){this.MetaData(e),this.Bars(e)},ToTex:function(){return this._builder},MetaData:function(e){var t=e.Score;this.StringMetaData("title",t.Title),this.StringMetaData("subtitle",t.SubTitle),this.StringMetaData("artist",t.Artist),this.StringMetaData("album",t.Album),this.StringMetaData("words",t.Words),this.StringMetaData("music",t.Music),this.StringMetaData("copyright",t.Copyright),this._builder+="\\tempo ",this._builder+=t.Tempo,this._builder+="\r\n",e.Capo>0&&(this._builder+="\\capo ",this._builder+=e.Capo,this._builder+="\r\n"),this._builder+="\\tuning";for(var a=0;a<e.Tuning.length;a++)this._builder+=" ",this._builder+=AlphaTab.Model.Tuning.GetTextForTuning(e.Tuning[a],!0);this._builder+="\\instrument ",this._builder+=e.PlaybackInfo.Program,this._builder+="\r\n",this._builder+=".",this._builder+="\r\n"},StringMetaData:function(e,t){AlphaTab.Platform.Std.IsNullOrWhiteSpace(t)||(this._builder+="\\",this._builder+=e,this._builder+=' "',this._builder+=t.replace('"','\\"'),this._builder+='"',this._builder+="\r\n")},Bars:function(e){for(var t=0;t<1;t++)for(var a=0;a<e.Staves[t].Bars.length;a++)t>0&&(this._builder+=" |",this._builder+="\r\n"),this.Bar(e.Staves[t].Bars[a])},Bar:function(e){this.BarMeta(e),this.Voice(e.Voices[0])},Voice:function(e){for(var t=0;t<e.Beats.length;t++)this.Beat(e.Beats[t])},Beat:function(e){if(e.get_IsRest())this._builder+="r";else{e.Notes.length>1&&(this._builder+="(");for(var t=0;t<e.Notes.length;t++)this.Note(e.Notes[t]);e.Notes.length>1&&(this._builder+=")")}this._builder+=".",this._builder+=e.Duration,this._builder+=" ",this.BeatEffects(e)},Note:function(e){e.IsDead?this._builder+="x":e.IsTieDestination?this._builder+="-":this._builder+=e.Fret,this._builder+=".",this._builder+=e.Beat.Voice.Bar.Staff.Track.Tuning.length-e.String+1,this._builder+=" ",this.NoteEffects(e)},NoteEffects:function(e){var t=!1;if(e.get_HasBend()){t=this.EffectOpen(t),this._builder+="be (";for(var a=0;a<e.BendPoints.length;a++)this._builder+=e.BendPoints[a].Offset,this._builder+=" ",this._builder+=e.BendPoints[a].Value,this._builder+=" ";this._builder+=")"}switch(e.HarmonicType){case AlphaTab.Model.HarmonicType.Natural:t=this.EffectOpen(t),this._builder+="nh ";break;case AlphaTab.Model.HarmonicType.Artificial:t=this.EffectOpen(t),this._builder+="ah ";break;case AlphaTab.Model.HarmonicType.Tap:t=this.EffectOpen(t),this._builder+="th ";break;case AlphaTab.Model.HarmonicType.Pinch:t=this.EffectOpen(t),this._builder+="ph ";break;case AlphaTab.Model.HarmonicType.Semi:t=this.EffectOpen(t),this._builder+="sh "}if(e.get_IsTrill())switch(t=this.EffectOpen(t),this._builder+="tr ",this._builder+=e.get_TrillFret(),this._builder+=" ",e.TrillSpeed){case AlphaTab.Model.Duration.Sixteenth:this._builder+="16 ";break;case AlphaTab.Model.Duration.ThirtySecond:this._builder+="32 ";break;case AlphaTab.Model.Duration.SixtyFourth:this._builder+="64 "}switch(e.Vibrato!=AlphaTab.Model.VibratoType.None&&(t=this.EffectOpen(t),this._builder+="v "),e.SlideType==AlphaTab.Model.SlideType.Legato&&(t=this.EffectOpen(t),this._builder+="sl "),e.SlideType==AlphaTab.Model.SlideType.Shift&&(t=this.EffectOpen(t),this._builder+="ss "),e.IsHammerPullOrigin&&(t=this.EffectOpen(t),this._builder+="h "),e.IsGhost&&(t=this.EffectOpen(t),this._builder+="g "),e.Accentuated==AlphaTab.Model.AccentuationType.Normal?(t=this.EffectOpen(t),this._builder+="ac "):e.Accentuated==AlphaTab.Model.AccentuationType.Heavy&&(t=this.EffectOpen(t),this._builder+="hac "),e.IsPalmMute&&(t=this.EffectOpen(t),this._builder+="pm "),e.IsStaccato&&(t=this.EffectOpen(t),this._builder+="st "),e.IsLetRing&&(t=this.EffectOpen(t),this._builder+="lr "),e.LeftHandFinger){case AlphaTab.Model.Fingers.Thumb:t=this.EffectOpen(t),this._builder+="1 ";break;case AlphaTab.Model.Fingers.IndexFinger:t=this.EffectOpen(t),this._builder+="2 ";break;case AlphaTab.Model.Fingers.MiddleFinger:t=this.EffectOpen(t),this._builder+="3 ";break;case AlphaTab.Model.Fingers.AnnularFinger:t=this.EffectOpen(t),this._builder+="4 ";break;case AlphaTab.Model.Fingers.LittleFinger:t=this.EffectOpen(t),this._builder+="5 "}switch(e.RightHandFinger){case AlphaTab.Model.Fingers.Thumb:t=this.EffectOpen(t),this._builder+="1 ";break;case AlphaTab.Model.Fingers.IndexFinger:t=this.EffectOpen(t),this._builder+="2 ";break;case AlphaTab.Model.Fingers.MiddleFinger:t=this.EffectOpen(t),this._builder+="3 ";break;case AlphaTab.Model.Fingers.AnnularFinger:t=this.EffectOpen(t),this._builder+="4 ";break;case AlphaTab.Model.Fingers.LittleFinger:t=this.EffectOpen(t),this._builder+="5 "}this.EffectClose(t)},EffectOpen:function(e){return e||(this._builder+="{"),!0},EffectClose:function(e){e&&(this._builder+="}")},BeatEffects:function(e){var t=!1;switch(e.FadeIn&&(t=this.EffectOpen(t),this._builder+="f "),e.GraceType){case AlphaTab.Model.GraceType.OnBeat:this._builder+="gr ob ";break;case AlphaTab.Model.GraceType.BeforeBeat:this._builder+="gr "}if(e.Vibrato!=AlphaTab.Model.VibratoType.None&&(t=this.EffectOpen(t),this._builder+="v "),e.Slap&&(t=this.EffectOpen(t),this._builder+="s "),e.Pop&&(t=this.EffectOpen(t),this._builder+="p "),2==e.Dots?(t=this.EffectOpen(t),this._builder+="dd "):1==e.Dots&&(t=this.EffectOpen(t),this._builder+="d "),e.PickStroke==AlphaTab.Model.PickStrokeType.Up?(t=this.EffectOpen(t),this._builder+="su "):e.PickStroke==AlphaTab.Model.PickStrokeType.Down&&(t=this.EffectOpen(t),this._builder+="sd "),e.get_HasTuplet()){var a=0;3==e.TupletDenominator&&2==e.TupletNumerator?a=3:5==e.TupletDenominator&&4==e.TupletNumerator?a=5:6==e.TupletDenominator&&4==e.TupletNumerator?a=6:7==e.TupletDenominator&&4==e.TupletNumerator?a=7:9==e.TupletDenominator&&8==e.TupletNumerator?a=9:10==e.TupletDenominator&&8==e.TupletNumerator?a=10:11==e.TupletDenominator&&8==e.TupletNumerator?a=11:12==e.TupletDenominator&&8==e.TupletNumerator&&(a=12),0!=a&&(t=this.EffectOpen(t),this._builder+="tu ",this._builder+=a,this._builder+=" ")}if(e.get_HasWhammyBar()){t=this.EffectOpen(t),this._builder+="tbe (";for(var i=0;i<e.WhammyBarPoints.length;i++)this._builder+=e.WhammyBarPoints[i].Offset,this._builder+=" ",this._builder+=e.WhammyBarPoints[i].Value,this._builder+=" ";this._builder+=")"}e.get_IsTremolo()&&(t=this.EffectOpen(t),this._builder+="tp ",e.TremoloSpeed==AlphaTab.Model.Duration.Eighth?this._builder+="8 ":e.TremoloSpeed==AlphaTab.Model.Duration.Sixteenth?this._builder+="16 ":e.TremoloSpeed==AlphaTab.Model.Duration.ThirtySecond?this._builder+="32 ":this._builder+="8 "),this.EffectClose(t)},BarMeta:function(e){var t=e.get_MasterBar();if(t.Index>0){var a=t.PreviousMasterBar,i=e.PreviousBar;if(a.TimeSignatureDenominator==t.TimeSignatureDenominator&&a.TimeSignatureNumerator==t.TimeSignatureNumerator||(this._builder+="\\ts ",this._builder+=t.TimeSignatureNumerator,this._builder+=" ",this._builder+=t.TimeSignatureDenominator,this._builder+="\r\n"),a.KeySignature!=t.KeySignature){switch(this._builder+="\\ks ",t.KeySignature){case-7:this._builder+="cb";break;case-6:this._builder+="gb";break;case-5:this._builder+="db";break;case-4:this._builder+="ab";break;case-3:this._builder+="eb";break;case-2:this._builder+="bb";break;case-1:this._builder+="f";break;case 0:this._builder+="c";break;case 1:this._builder+="g";break;case 2:this._builder+="d";break;case 3:this._builder+="a";break;case 4:this._builder+="e";break;case 5:this._builder+="b";break;case 6:this._builder+="f#";break;case 7:this._builder+="c#"}this._builder+="\r\n"}if(e.Clef!=i.Clef){switch(this._builder+="\\clef ",e.Clef){case AlphaTab.Model.Clef.Neutral:this._builder+="n";break;case AlphaTab.Model.Clef.C3:this._builder+="c3";break;case AlphaTab.Model.Clef.C4:this._builder+="c4";break;case AlphaTab.Model.Clef.F4:this._builder+="f4";break;case AlphaTab.Model.Clef.G2:this._builder+="g2"}this._builder+="\r\n"}null!=t.TempoAutomation&&(this._builder+="\\tempo ",this._builder+=t.TempoAutomation.Value,this._builder+="\r\n")}t.IsRepeatStart&&(this._builder+="\\ro ",this._builder+="\r\n"),t.get_IsRepeatEnd()&&(this._builder+="\\rc ",this._builder+=t.RepeatCount+1,this._builder+="\r\n")}},AlphaTab.Importer.AlphaTexException=function(e,t,a,i,n){this.Position=0,this.NonTerm=null,this.Expected=AlphaTab.Importer.AlphaTexSymbols.No,this.Symbol=AlphaTab.Importer.AlphaTexSymbols.No,this.SymbolData=null,AlphaTab.AlphaTabException.call(this,""),this.Position=e,this.NonTerm=t,this.Expected=a,this.Symbol=i,this.SymbolData=n,null==this.SymbolData?this.Description="MalFormed AlphaTex: @"+this.Position+": Error on block "+this.NonTerm+", expected a "+this.Expected+" found a "+this.Symbol:this.Description="MalFormed AlphaTex: @"+this.Position+": Error on block "+this.NonTerm+", invalid value: "+this.SymbolData},$Inherit(AlphaTab.Importer.AlphaTexException,AlphaTab.AlphaTabException),AlphaTab.Importer.ScoreImporter=function(){this.Data=null},AlphaTab.Importer.ScoreImporter.prototype={Init:function(e){this.Data=e}},AlphaTab.Importer.ScoreImporter.BuildImporters=function(){return[new AlphaTab.Importer.Gp3To5Importer,new AlphaTab.Importer.GpxImporter,new AlphaTab.Importer.AlphaTexImporter,new AlphaTab.Importer.MusicXmlImporter]},AlphaTab.Importer.AlphaTexImporter=function(){this._score=null,this._track=null,this._ch=0,this._curChPos=0,this._sy=AlphaTab.Importer.AlphaTexSymbols.No,this._syData=null,this._allowNegatives=!1,this._currentDuration=AlphaTab.Model.Duration.QuadrupleWhole,this._lyrics=null,AlphaTab.Importer.ScoreImporter.call(this)},AlphaTab.Importer.AlphaTexImporter.prototype={get_Name:function(){return"AlphaTex"},ReadScore:function(){try{return this.CreateDefaultScore(),this._curChPos=0,this._currentDuration=AlphaTab.Model.Duration.Quarter,this._lyrics=[],this.NextChar(),this.NewSy(),this.Score(),this._score.Finish(),this._track.ApplyLyrics(this._lyrics),this._score}catch(e){if(e.exception instanceof AlphaTab.Importer.AlphaTexException)throw $CreateException(new AlphaTab.Importer.UnsupportedFormatException(e.Description),new Error);throw $CreateException(e,new Error)}},Error:function(e,t,a){var i;throw i=a?new AlphaTab.Importer.AlphaTexException(this._curChPos,e,t,this._sy,null):new AlphaTab.Importer.AlphaTexException(this._curChPos,e,t,t,this._syData),AlphaTab.Util.Logger.Error(this.get_Name(),i.Description,null),$CreateException(i,new Error)},CreateDefaultScore:function(){this._score=new AlphaTab.Model.Score,this._score.Tempo=120,this._score.TempoLabel="",this._track=new AlphaTab.Model.Track(1),this._track.PlaybackInfo.Program=25,this._track.PlaybackInfo.PrimaryChannel=AlphaTab.Importer.AlphaTexImporter.TrackChannels[0],this._track.PlaybackInfo.SecondaryChannel=AlphaTab.Importer.AlphaTexImporter.TrackChannels[1],this._track.Tuning=AlphaTab.Model.Tuning.GetDefaultTuningFor(6).Tunings,this._score.AddTrack(this._track)},ParseClefFromString:function(e){switch(e.toLowerCase()){case"g2":case"treble":return AlphaTab.Model.Clef.G2;case"f4":case"bass":return AlphaTab.Model.Clef.F4;case"c3":case"tenor":return AlphaTab.Model.Clef.C3;case"c4":case"alto":return AlphaTab.Model.Clef.C4;case"n":case"neutral":return AlphaTab.Model.Clef.Neutral;default:return AlphaTab.Model.Clef.G2}},ParseClefFromInt:function(e){switch(e){case 43:return AlphaTab.Model.Clef.G2;case 65:return AlphaTab.Model.Clef.F4;case 48:return AlphaTab.Model.Clef.C3;case 60:return AlphaTab.Model.Clef.C4;default:return AlphaTab.Model.Clef.G2}},ParseKeySignature:function(e){switch(e.toLowerCase()){case"cb":return-7;case"gb":return-6;case"db":return-5;case"ab":return-4;case"eb":return-3;case"bb":return-2;case"f":return-1;case"c":return 0;case"g":return 1;case"d":return 2;case"a":return 3;case"e":return 4;case"b":return 5;case"f#":return 6;case"c#":return 7;default:return 0}},NextChar:function(){var e=this.Data.ReadByte();-1==e?this._ch=0:(this._ch=e,this._curChPos++)},NewSy:function(){this._sy=AlphaTab.Importer.AlphaTexSymbols.No;do{if(0==this._ch)this._sy=AlphaTab.Importer.AlphaTexSymbols.Eof;else if(AlphaTab.Platform.Std.IsWhiteSpace(this._ch))this.NextChar();else if(47==this._ch)if(this.NextChar(),47==this._ch)for(;13!=this._ch&&10!=this._ch&&0!=this._ch;)this.NextChar();else if(42==this._ch)for(;0!=this._ch;)if(42==this._ch){if(this.NextChar(),47==this._ch){this.NextChar();break}}else this.NextChar();else this.Error("symbol",AlphaTab.Importer.AlphaTexSymbols.String,!1);else if(34==this._ch||39==this._ch){var e=this._ch;this.NextChar();var t=new String;for(this._sy=AlphaTab.Importer.AlphaTexSymbols.String;this._ch!=e&&0!=this._ch;)t+=String.fromCharCode(this._ch),this.NextChar();this._syData=t,this.NextChar()}else if(45==this._ch)if(this._allowNegatives&&this.IsDigit(this._ch)){a=this.ReadNumber();this._sy=AlphaTab.Importer.AlphaTexSymbols.Number,this._syData=a}else this._sy=AlphaTab.Importer.AlphaTexSymbols.String,this._syData=this.ReadName();else if(46==this._ch)this._sy=AlphaTab.Importer.AlphaTexSymbols.Dot,this.NextChar();else if(58==this._ch)this._sy=AlphaTab.Importer.AlphaTexSymbols.DoubleDot,this.NextChar();else if(40==this._ch)this._sy=AlphaTab.Importer.AlphaTexSymbols.LParensis,this.NextChar();else if(92==this._ch){this.NextChar();i=this.ReadName();this._sy=AlphaTab.Importer.AlphaTexSymbols.MetaCommand,this._syData=i}else if(41==this._ch)this._sy=AlphaTab.Importer.AlphaTexSymbols.RParensis,this.NextChar();else if(123==this._ch)this._sy=AlphaTab.Importer.AlphaTexSymbols.LBrace,this.NextChar();else if(125==this._ch)this._sy=AlphaTab.Importer.AlphaTexSymbols.RBrace,this.NextChar();else if(124==this._ch)this._sy=AlphaTab.Importer.AlphaTexSymbols.Pipe,this.NextChar();else if(42==this._ch)this._sy=AlphaTab.Importer.AlphaTexSymbols.Multiply,this.NextChar();else if(this.IsDigit(this._ch)){var a=this.ReadNumber();this._sy=AlphaTab.Importer.AlphaTexSymbols.Number,this._syData=a}else if(AlphaTab.Importer.AlphaTexImporter.IsLetter(this._ch)){var i=this.ReadName(),n=AlphaTab.Model.TuningParser.Parse(i);null!=n?(this._sy=AlphaTab.Importer.AlphaTexSymbols.Tuning,this._syData=n):(this._sy=AlphaTab.Importer.AlphaTexSymbols.String,this._syData=i)}else this.Error("symbol",AlphaTab.Importer.AlphaTexSymbols.String,!1)}while(this._sy==AlphaTab.Importer.AlphaTexSymbols.No)},IsDigit:function(e){return e>=48&&e<=57||45==e&&this._allowNegatives},ReadName:function(){var e=new String;do{e+=String.fromCharCode(this._ch),this.NextChar()}while(AlphaTab.Importer.AlphaTexImporter.IsLetter(this._ch)||this.IsDigit(this._ch)||35==this._ch);return e},ReadNumber:function(){var e=new String;do{e+=String.fromCharCode(this._ch),this.NextChar()}while(this.IsDigit(this._ch));return AlphaTab.Platform.Std.ParseInt(e)},Score:function(){this.MetaData(),this.Bars()},MetaData:function(){for(var e=!1;this._sy==AlphaTab.Importer.AlphaTexSymbols.MetaCommand;){var t=this._syData.toString().toLowerCase();if("title"==t)this.NewSy(),this._sy==AlphaTab.Importer.AlphaTexSymbols.String?this._score.Title=this._syData.toString():this.Error("title",AlphaTab.Importer.AlphaTexSymbols.String,!0),this.NewSy(),e=!0;else if("subtitle"==t)this.NewSy(),this._sy==AlphaTab.Importer.AlphaTexSymbols.String?this._score.SubTitle=this._syData.toString():this.Error("subtitle",AlphaTab.Importer.AlphaTexSymbols.String,!0),this.NewSy(),e=!0;else if("artist"==t)this.NewSy(),this._sy==AlphaTab.Importer.AlphaTexSymbols.String?this._score.Artist=this._syData.toString():this.Error("artist",AlphaTab.Importer.AlphaTexSymbols.String,!0),this.NewSy(),e=!0;else if("album"==t)this.NewSy(),this._sy==AlphaTab.Importer.AlphaTexSymbols.String?this._score.Album=this._syData.toString():this.Error("album",AlphaTab.Importer.AlphaTexSymbols.String,!0),this.NewSy(),e=!0;else if("words"==t)this.NewSy(),this._sy==AlphaTab.Importer.AlphaTexSymbols.String?this._score.Words=this._syData.toString():this.Error("words",AlphaTab.Importer.AlphaTexSymbols.String,!0),this.NewSy(),e=!0;else if("music"==t)this.NewSy(),this._sy==AlphaTab.Importer.AlphaTexSymbols.String?this._score.Music=this._syData.toString():this.Error("music",AlphaTab.Importer.AlphaTexSymbols.String,!0),this.NewSy(),e=!0;else if("copyright"==t)this.NewSy(),this._sy==AlphaTab.Importer.AlphaTexSymbols.String?this._score.Copyright=this._syData.toString():this.Error("copyright",AlphaTab.Importer.AlphaTexSymbols.String,!0),this.NewSy(),e=!0;else if("tempo"==t)this.NewSy(),this._sy==AlphaTab.Importer.AlphaTexSymbols.Number?this._score.Tempo=this._syData:this.Error("tempo",AlphaTab.Importer.AlphaTexSymbols.Number,!0),this.NewSy(),e=!0;else if("capo"==t)this.NewSy(),this._sy==AlphaTab.Importer.AlphaTexSymbols.Number?this._track.Capo=this._syData:this.Error("capo",AlphaTab.Importer.AlphaTexSymbols.Number,!0),this.NewSy(),e=!0;else if("tuning"==t){switch(this.NewSy(),this._sy){case AlphaTab.Importer.AlphaTexSymbols.String:var a=this._syData.toString().toLowerCase();"piano"==a||"none"==a||"voice"==a?this._track.Tuning=new Int32Array(0):this.Error("tuning",AlphaTab.Importer.AlphaTexSymbols.Tuning,!0),this.NewSy();break;case AlphaTab.Importer.AlphaTexSymbols.Tuning:var i=[];do{var n=this._syData;i.push(n.get_RealValue()),this.NewSy()}while(this._sy==AlphaTab.Importer.AlphaTexSymbols.Tuning);this._track.Tuning=i.slice(0);break;default:this.Error("tuning",AlphaTab.Importer.AlphaTexSymbols.Tuning,!0)}e=!0}else if("instrument"==t){if(this.NewSy(),this._sy==AlphaTab.Importer.AlphaTexSymbols.Number){var r=this._syData;r>=0&&r<=128?this._track.PlaybackInfo.Program=this._syData:this.Error("instrument",AlphaTab.Importer.AlphaTexSymbols.Number,!1)}else if(this._sy==AlphaTab.Importer.AlphaTexSymbols.String){var l=this._syData.toString().toLowerCase();this._track.PlaybackInfo.Program=AlphaTab.Audio.GeneralMidi.GetValue(l)}else this.Error("instrument",AlphaTab.Importer.AlphaTexSymbols.Number,!0);this.NewSy(),e=!0}else if("lyrics"==t){this.NewSy();var s=new AlphaTab.Model.Lyrics;s.StartBar=0,s.Text="",this._sy==AlphaTab.Importer.AlphaTexSymbols.Number&&(s.StartBar=this._syData,this.NewSy()),this._sy==AlphaTab.Importer.AlphaTexSymbols.String?(s.Text=this._syData,this.NewSy()):this.Error("lyrics",AlphaTab.Importer.AlphaTexSymbols.String,!0),this._lyrics.push(s),e=!0}else{if(!e)break;this.Error("metaDataTags",AlphaTab.Importer.AlphaTexSymbols.String,!1)}}e?(this._sy!=AlphaTab.Importer.AlphaTexSymbols.Dot&&this.Error("song",AlphaTab.Importer.AlphaTexSymbols.Dot,!0),this.NewSy()):this._sy==AlphaTab.Importer.AlphaTexSymbols.Dot&&this.NewSy()},Bars:function(){for(this.Bar();this._sy!=AlphaTab.Importer.AlphaTexSymbols.Eof;)this._sy!=AlphaTab.Importer.AlphaTexSymbols.Pipe&&this.Error("bar",AlphaTab.Importer.AlphaTexSymbols.Pipe,!0),this.NewSy(),this.Bar()},Bar:function(){var e=new AlphaTab.Model.MasterBar;this._score.AddMasterBar(e);var t=new AlphaTab.Model.Bar;this._track.AddBarToStaff(0,t),e.Index>0&&(e.KeySignature=e.PreviousMasterBar.KeySignature,e.TimeSignatureDenominator=e.PreviousMasterBar.TimeSignatureDenominator,e.TimeSignatureNumerator=e.PreviousMasterBar.TimeSignatureNumerator,t.Clef=t.PreviousBar.Clef),this.BarMeta(t);var a=new AlphaTab.Model.Voice;for(t.AddVoice(a);this._sy!=AlphaTab.Importer.AlphaTexSymbols.Pipe&&this._sy!=AlphaTab.Importer.AlphaTexSymbols.Eof;)this.Beat(a);if(0==a.Beats.length){var i=new AlphaTab.Model.Beat;i.IsEmpty=!0,a.AddBeat(i)}},Beat:function(e){if(this._sy==AlphaTab.Importer.AlphaTexSymbols.DoubleDot)return this._allowNegatives=!0,this.NewSy(),this._allowNegatives=!1,this._sy!=AlphaTab.Importer.AlphaTexSymbols.Number&&this.Error("duration",AlphaTab.Importer.AlphaTexSymbols.Number,!0),this._currentDuration=this.ParseDuration(this._syData),void this.NewSy();var t=new AlphaTab.Model.Beat;if(e.AddBeat(t),null!=e.Bar.get_MasterBar().TempoAutomation&&1==e.Beats.length&&t.Automations.push(e.Bar.get_MasterBar().TempoAutomation),this._sy==AlphaTab.Importer.AlphaTexSymbols.LParensis){for(this.NewSy(),this.Note(t);this._sy!=AlphaTab.Importer.AlphaTexSymbols.RParensis&&this._sy!=AlphaTab.Importer.AlphaTexSymbols.Eof;)this.Note(t);this._sy!=AlphaTab.Importer.AlphaTexSymbols.RParensis&&this.Error("note-list",AlphaTab.Importer.AlphaTexSymbols.RParensis,!0),this.NewSy()}else this._sy==AlphaTab.Importer.AlphaTexSymbols.String&&"r"==this._syData.toString().toLowerCase()?this.NewSy():this.Note(t);this._sy==AlphaTab.Importer.AlphaTexSymbols.Dot&&(this._allowNegatives=!0,this.NewSy(),this._allowNegatives=!1,this._sy!=AlphaTab.Importer.AlphaTexSymbols.Number&&this.Error("duration",AlphaTab.Importer.AlphaTexSymbols.Number,!0),this._currentDuration=this.ParseDuration(this._syData),this.NewSy()),t.Duration=this._currentDuration;var a=1;this._sy==AlphaTab.Importer.AlphaTexSymbols.Multiply&&(this.NewSy(),this._sy!=AlphaTab.Importer.AlphaTexSymbols.Number?this.Error("multiplier",AlphaTab.Importer.AlphaTexSymbols.Number,!0):a=this._syData,this.NewSy()),this.BeatEffects(t);for(var i=0;i<a-1;i++)e.AddBeat(t.Clone())},BeatEffects:function(e){if(this._sy==AlphaTab.Importer.AlphaTexSymbols.LBrace){for(this.NewSy();this._sy==AlphaTab.Importer.AlphaTexSymbols.String;)this._syData=this._syData.toString().toLowerCase(),this.ApplyBeatEffect(e)||this.Error("beat-effects",AlphaTab.Importer.AlphaTexSymbols.String,!1);this._sy!=AlphaTab.Importer.AlphaTexSymbols.RBrace&&this.Error("beat-effects",AlphaTab.Importer.AlphaTexSymbols.RBrace,!0),this.NewSy()}},ApplyBeatEffect:function(e){var t=this._syData.toString().toLowerCase();if("f"==t)return e.FadeIn=!0,this.NewSy(),!0;if("v"==t)return e.Vibrato=AlphaTab.Model.VibratoType.Slight,this.NewSy(),!0;if("s"==t)return e.Slap=!0,this.NewSy(),!0;if("p"==t)return e.Pop=!0,this.NewSy(),!0;if("dd"==t)return e.Dots=2,this.NewSy(),!0;if("d"==t)return e.Dots=1,this.NewSy(),!0;if("su"==t)return e.PickStroke=AlphaTab.Model.PickStrokeType.Up,this.NewSy(),!0;if("sd"==t)return e.PickStroke=AlphaTab.Model.PickStrokeType.Down,this.NewSy(),!0;if("tu"==t){if(this.NewSy(),this._sy!=AlphaTab.Importer.AlphaTexSymbols.Number)return this.Error("tuplet",AlphaTab.Importer.AlphaTexSymbols.Number,!0),!1;switch(this._syData){case 3:e.TupletNumerator=3,e.TupletDenominator=2;break;case 5:e.TupletNumerator=5,e.TupletDenominator=4;break;case 6:e.TupletNumerator=6,e.TupletDenominator=4;break;case 7:e.TupletNumerator=7,e.TupletDenominator=4;break;case 9:e.TupletNumerator=9,e.TupletDenominator=8;break;case 10:e.TupletNumerator=10,e.TupletDenominator=8;break;case 11:e.TupletNumerator=11,e.TupletDenominator=8;break;case 12:e.TupletNumerator=12,e.TupletNumerator=8,e.TupletDenominator=8}return this.NewSy(),!0}if("tb"==t||"tbe"==t){var a="tbe"==t;if(this.NewSy(),this._sy!=AlphaTab.Importer.AlphaTexSymbols.LParensis)return this.Error("tremolobar-effect",AlphaTab.Importer.AlphaTexSymbols.LParensis,!0),!1;for(this._allowNegatives=!0,this.NewSy();this._sy!=AlphaTab.Importer.AlphaTexSymbols.RParensis&&this._sy!=AlphaTab.Importer.AlphaTexSymbols.Eof;){var i,n;if(a){if(this._sy!=AlphaTab.Importer.AlphaTexSymbols.Number)return this.Error("tremolobar-effect",AlphaTab.Importer.AlphaTexSymbols.Number,!0),!1;if(i=this._syData,this.NewSy(),this._sy!=AlphaTab.Importer.AlphaTexSymbols.Number)return this.Error("tremolobar-effect",AlphaTab.Importer.AlphaTexSymbols.Number,!0),!1;n=this._syData}else{if(this._sy!=AlphaTab.Importer.AlphaTexSymbols.Number)return this.Error("tremolobar-effect",AlphaTab.Importer.AlphaTexSymbols.Number,!0),!1;i=0,n=this._syData}e.AddWhammyBarPoint(new AlphaTab.Model.BendPoint(i,n)),this.NewSy()}for(;e.WhammyBarPoints.length>60;)e.RemoveWhammyBarPoint(e.WhammyBarPoints.length-1);if(a)e.WhammyBarPoints.sort($CreateAnonymousDelegate(this,function(e,t){return e.Offset-t.Offset}));else for(var r=e.WhammyBarPoints.length,l=60/r|0,s=0;s<r;)e.WhammyBarPoints[s].Offset=Math.min(60,s*l),s++;return this._allowNegatives=!1,this._sy!=AlphaTab.Importer.AlphaTexSymbols.RParensis?(this.Error("tremolobar-effect",AlphaTab.Importer.AlphaTexSymbols.RParensis,!0),!1):(this.NewSy(),!0)}if("gr"==t)return this.NewSy(),"ob"==this._syData.toString().toLowerCase()?(e.GraceType=AlphaTab.Model.GraceType.OnBeat,this.NewSy()):e.GraceType=AlphaTab.Model.GraceType.BeforeBeat,!0;if("tp"==t){this.NewSy();var o=AlphaTab.Model.Duration.Eighth;if(this._sy==AlphaTab.Importer.AlphaTexSymbols.Number){switch(this._syData){case 8:o=AlphaTab.Model.Duration.Eighth;break;case 16:o=AlphaTab.Model.Duration.Sixteenth;break;case 32:o=AlphaTab.Model.Duration.ThirtySecond;break;default:o=AlphaTab.Model.Duration.Eighth}this.NewSy()}return e.TremoloSpeed=o,!0}return!1},Note:function(e){var t="x"==this._syData,a="-"==this._syData,i=-1,n=-1,r=-1;switch(this._sy){case AlphaTab.Importer.AlphaTexSymbols.Number:i=this._syData;break;case AlphaTab.Importer.AlphaTexSymbols.String:a||t?i=0:this.Error("note-fret",AlphaTab.Importer.AlphaTexSymbols.Number,!0);break;case AlphaTab.Importer.AlphaTexSymbols.Tuning:var l=this._syData;n=l.Octave,r=l.NoteValue;break;default:this.Error("note-fret",AlphaTab.Importer.AlphaTexSymbols.Number,!0)}this.NewSy();var s=-1==n&&this._track.Tuning.length>0,o=-1;s&&(this._sy!=AlphaTab.Importer.AlphaTexSymbols.Dot&&this.Error("note",AlphaTab.Importer.AlphaTexSymbols.Dot,!0),this.NewSy(),this._sy!=AlphaTab.Importer.AlphaTexSymbols.Number&&this.Error("note-string",AlphaTab.Importer.AlphaTexSymbols.Number,!0),((o=this._syData)<1||o>this._track.Tuning.length)&&this.Error("note-string",AlphaTab.Importer.AlphaTexSymbols.Number,!1),this.NewSy());var h=new AlphaTab.Model.Note;e.AddNote(h),s?(h.String=this._track.Tuning.length-(o-1),h.IsDead=t,h.IsTieDestination=a,a||(h.Fret=i)):(h.Octave=n,h.Tone=r,h.IsTieDestination=a),this.NoteEffects(h)},NoteEffects:function(e){if(this._sy==AlphaTab.Importer.AlphaTexSymbols.LBrace){for(this.NewSy();this._sy==AlphaTab.Importer.AlphaTexSymbols.String;){var t=this._syData.toString().toLowerCase();if(this._syData=t,"b"==t||"be"==t){var a="be"==this._syData;for(this.NewSy(),this._sy!=AlphaTab.Importer.AlphaTexSymbols.LParensis&&this.Error("bend-effect",AlphaTab.Importer.AlphaTexSymbols.LParensis,!0),this.NewSy();this._sy!=AlphaTab.Importer.AlphaTexSymbols.RParensis&&this._sy!=AlphaTab.Importer.AlphaTexSymbols.Eof;){var i=0,n=0;a?(this._sy!=AlphaTab.Importer.AlphaTexSymbols.Number&&this.Error("bend-effect-value",AlphaTab.Importer.AlphaTexSymbols.Number,!0),i=this._syData,this.NewSy(),this._sy!=AlphaTab.Importer.AlphaTexSymbols.Number&&this.Error("bend-effect-value",AlphaTab.Importer.AlphaTexSymbols.Number,!0),n=this._syData):(this._sy!=AlphaTab.Importer.AlphaTexSymbols.Number&&this.Error("bend-effect-value",AlphaTab.Importer.AlphaTexSymbols.Number,!0),n=this._syData),e.AddBendPoint(new AlphaTab.Model.BendPoint(i,n)),this.NewSy()}for(;e.BendPoints.length>60;)e.BendPoints.splice(e.BendPoints.length-1,1);if(a)e.BendPoints.sort($CreateAnonymousDelegate(this,function(e,t){return e.Offset-t.Offset}));else for(var r=e.BendPoints.length,l=60/(r-1)|0,s=0;s<r;)e.BendPoints[s].Offset=Math.min(60,s*l),s++;this._sy!=AlphaTab.Importer.AlphaTexSymbols.RParensis&&this.Error("bend-effect",AlphaTab.Importer.AlphaTexSymbols.RParensis,!0),this.NewSy()}else if("nh"==t)e.HarmonicType=AlphaTab.Model.HarmonicType.Natural,this.NewSy();else if("ah"==t)e.HarmonicType=AlphaTab.Model.HarmonicType.Artificial,this.NewSy();else if("th"==t)e.HarmonicType=AlphaTab.Model.HarmonicType.Tap,this.NewSy();else if("ph"==t)e.HarmonicType=AlphaTab.Model.HarmonicType.Pinch,this.NewSy();else if("sh"==t)e.HarmonicType=AlphaTab.Model.HarmonicType.Semi,this.NewSy();else if("tr"==t){this.NewSy(),this._sy!=AlphaTab.Importer.AlphaTexSymbols.Number&&this.Error("trill-effect",AlphaTab.Importer.AlphaTexSymbols.Number,!0);var o=this._syData;this.NewSy();var h=AlphaTab.Model.Duration.Sixteenth;if(this._sy==AlphaTab.Importer.AlphaTexSymbols.Number){switch(this._syData){case 16:h=AlphaTab.Model.Duration.Sixteenth;break;case 32:h=AlphaTab.Model.Duration.ThirtySecond;break;case 64:h=AlphaTab.Model.Duration.SixtyFourth;break;default:h=AlphaTab.Model.Duration.Sixteenth}this.NewSy()}e.TrillValue=o+e.get_StringTuning(),e.TrillSpeed=h}else if("v"==t)this.NewSy(),e.Vibrato=AlphaTab.Model.VibratoType.Slight;else if("sl"==t)this.NewSy(),e.SlideType=AlphaTab.Model.SlideType.Legato;else if("ss"==t)this.NewSy(),e.SlideType=AlphaTab.Model.SlideType.Shift;else if("h"==t)this.NewSy(),e.IsHammerPullOrigin=!0;else if("g"==t)this.NewSy(),e.IsGhost=!0;else if("ac"==t)this.NewSy(),e.Accentuated=AlphaTab.Model.AccentuationType.Normal;else if("hac"==t)this.NewSy(),e.Accentuated=AlphaTab.Model.AccentuationType.Heavy;else if("pm"==t)this.NewSy(),e.IsPalmMute=!0;else if("st"==t)this.NewSy(),e.IsStaccato=!0;else if("lr"==t)this.NewSy(),e.IsLetRing=!0;else if("x"==t)this.NewSy(),e.Fret=0,e.IsDead=!0;else if("lf"==t){this.NewSy();p=AlphaTab.Model.Fingers.Thumb;this._sy==AlphaTab.Importer.AlphaTexSymbols.Number&&(p=this.ToFinger(this._syData),this.NewSy()),e.LeftHandFinger=p}else if("rf"==t){this.NewSy();var p=AlphaTab.Model.Fingers.Thumb;this._sy==AlphaTab.Importer.AlphaTexSymbols.Number&&(p=this.ToFinger(this._syData),this.NewSy()),e.RightHandFinger=p}else this.ApplyBeatEffect(e.Beat)||this.Error(t,AlphaTab.Importer.AlphaTexSymbols.String,!1)}this._sy!=AlphaTab.Importer.AlphaTexSymbols.RBrace&&this.Error("note-effect",AlphaTab.Importer.AlphaTexSymbols.RBrace,!1),this.NewSy()}},ToFinger:function(e){switch(e){case 1:return AlphaTab.Model.Fingers.Thumb;case 2:return AlphaTab.Model.Fingers.IndexFinger;case 3:return AlphaTab.Model.Fingers.MiddleFinger;case 4:return AlphaTab.Model.Fingers.AnnularFinger;case 5:return AlphaTab.Model.Fingers.LittleFinger}return AlphaTab.Model.Fingers.Thumb},ParseDuration:function(e){switch(e){case-4:return AlphaTab.Model.Duration.QuadrupleWhole;case-2:return AlphaTab.Model.Duration.DoubleWhole;case 1:return AlphaTab.Model.Duration.Whole;case 2:return AlphaTab.Model.Duration.Half;case 4:return AlphaTab.Model.Duration.Quarter;case 8:return AlphaTab.Model.Duration.Eighth;case 16:return AlphaTab.Model.Duration.Sixteenth;case 32:return AlphaTab.Model.Duration.ThirtySecond;case 64:return AlphaTab.Model.Duration.SixtyFourth;case 128:return AlphaTab.Model.Duration.OneHundredTwentyEighth;default:return AlphaTab.Model.Duration.Quarter}},BarMeta:function(e){for(var t=e.get_MasterBar();this._sy==AlphaTab.Importer.AlphaTexSymbols.MetaCommand;){var a=this._syData.toString().toLowerCase();if("ts"==a)this.NewSy(),this._sy!=AlphaTab.Importer.AlphaTexSymbols.Number&&this.Error("timesignature-numerator",AlphaTab.Importer.AlphaTexSymbols.Number,!0),t.TimeSignatureNumerator=this._syData,this.NewSy(),this._sy!=AlphaTab.Importer.AlphaTexSymbols.Number&&this.Error("timesignature-denominator",AlphaTab.Importer.AlphaTexSymbols.Number,!0),t.TimeSignatureDenominator=this._syData;else if("ro"==a)t.IsRepeatStart=!0;else if("rc"==a)this.NewSy(),this._sy!=AlphaTab.Importer.AlphaTexSymbols.Number&&this.Error("repeatclose",AlphaTab.Importer.AlphaTexSymbols.Number,!0),t.RepeatCount=this._syData-1;else if("ks"==a)this.NewSy(),this._sy!=AlphaTab.Importer.AlphaTexSymbols.String&&this.Error("keysignature",AlphaTab.Importer.AlphaTexSymbols.String,!0),t.KeySignature=this.ParseKeySignature(this._syData.toString().toLowerCase());else if("clef"==a)switch(this.NewSy(),this._sy){case AlphaTab.Importer.AlphaTexSymbols.String:e.Clef=this.ParseClefFromString(this._syData.toString().toLowerCase());break;case AlphaTab.Importer.AlphaTexSymbols.Number:e.Clef=this.ParseClefFromInt(this._syData);break;case AlphaTab.Importer.AlphaTexSymbols.Tuning:e.Clef=this.ParseClefFromInt(this._syData.get_RealValue());break;default:this.Error("clef",AlphaTab.Importer.AlphaTexSymbols.String,!0)}else if("tempo"==a){this.NewSy(),this._sy!=AlphaTab.Importer.AlphaTexSymbols.Number&&this.Error("tempo",AlphaTab.Importer.AlphaTexSymbols.Number,!0);var i=new AlphaTab.Model.Automation;i.IsLinear=!0,i.Type=AlphaTab.Model.AutomationType.Tempo,i.Value=this._syData,t.TempoAutomation=i}else this.Error("measure-effects",AlphaTab.Importer.AlphaTexSymbols.String,!1);this.NewSy()}}},$StaticConstructor(function(){AlphaTab.Importer.AlphaTexImporter.Eof=0,AlphaTab.Importer.AlphaTexImporter.TrackChannels=new Int32Array([0,1])}),AlphaTab.Importer.AlphaTexImporter.IsLetter=function(e){return!AlphaTab.Importer.AlphaTexImporter.IsTerminal(e)&&(e>=33&&e<=47||e>=58&&e<=126||e>128)},AlphaTab.Importer.AlphaTexImporter.IsTerminal=function(e){return 46==e||123==e||125==e||91==e||93==e||40==e||41==e||124==e||39==e||34==e||92==e},$Inherit(AlphaTab.Importer.AlphaTexImporter,AlphaTab.Importer.ScoreImporter),AlphaTab.Importer.AlphaTexSymbols={No:0,Eof:1,Number:2,DoubleDot:3,Dot:4,String:5,Tuning:6,LParensis:7,RParensis:8,LBrace:9,RBrace:10,Pipe:11,MetaCommand:12,Multiply:13},AlphaTab.Importer.Gp3To5Importer=function(){this._versionNumber=0,this._score=null,this._globalTripletFeel=AlphaTab.Model.TripletFeel.NoTripletFeel,this._lyricsTrack=0,this._lyrics=null,this._barCount=0,this._trackCount=0,this._playbackInfos=null,AlphaTab.Importer.ScoreImporter.call(this)},AlphaTab.Importer.Gp3To5Importer.prototype={get_Name:function(){return"Guitar Pro 3-5"},ReadScore:function(){return this.ReadVersion(),this._score=new AlphaTab.Model.Score,this.ReadScoreInformation(),this._versionNumber<500&&(this._globalTripletFeel=this.ReadBool()?AlphaTab.Model.TripletFeel.Triplet8th:AlphaTab.Model.TripletFeel.NoTripletFeel),this._versionNumber>=400&&this.ReadLyrics(),this._versionNumber>=510&&this.Data.Skip(19),this._versionNumber>=500&&(this.ReadPageSetup(),this._score.TempoLabel=this.ReadStringIntByte()),this._score.Tempo=this.ReadInt32(),this._versionNumber>=510&&this.ReadBool(),this.ReadInt32(),this._versionNumber>=400&&this.Data.ReadByte(),this.ReadPlaybackInfos(),this._versionNumber>=500&&(this.Data.Skip(38),this.Data.Skip(4)),this._barCount=this.ReadInt32(),this._trackCount=this.ReadInt32(),this.ReadMasterBars(),this.ReadTracks(),this.ReadBars(),this._score.Finish(),null!=this._lyrics&&this._lyricsTrack>=0&&this._score.Tracks[this._lyricsTrack].ApplyLyrics(this._lyrics),this._score},ReadVersion:function(){var e=this.ReadStringByteLength(30);if(0==!e.indexOf("FICHIER GUITAR PRO "))throw $CreateException(new AlphaTab.Importer.UnsupportedFormatException(""),new Error);var t=(e=e.substr("FICHIER GUITAR PRO ".length+1)).indexOf(".");this._versionNumber=100*AlphaTab.Platform.Std.ParseInt(e.substr(0,t))+AlphaTab.Platform.Std.ParseInt(e.substr(t+1)),AlphaTab.Util.Logger.Info(this.get_Name(),"Guitar Pro version "+e+" detected",null)},ReadScoreInformation:function(){this._score.Title=this.ReadStringIntUnused(),this._score.SubTitle=this.ReadStringIntUnused(),this._score.Artist=this.ReadStringIntUnused(),this._score.Album=this.ReadStringIntUnused(),this._score.Words=this.ReadStringIntUnused(),this._score.Music=this._versionNumber>=500?this.ReadStringIntUnused():this._score.Words,this._score.Copyright=this.ReadStringIntUnused(),this._score.Tab=this.ReadStringIntUnused(),this._score.Instructions=this.ReadStringIntUnused();for(var e=this.ReadInt32(),t=new String,a=0;a<e;a++)a>0&&(t+="\r\n"),t+=this.ReadStringIntUnused();this._score.Notices=t},ReadLyrics:function(){this._lyrics=[],this._lyricsTrack=this.ReadInt32()-1;for(var e=0;e<5;e++){var t=new AlphaTab.Model.Lyrics;t.StartBar=this.ReadInt32()-1,t.Text=this.ReadStringInt(),this._lyrics.push(t)}},ReadPageSetup:function(){this.Data.Skip(30);for(var e=0;e<10;e++)this.ReadStringIntByte()},ReadPlaybackInfos:function(){this._playbackInfos=[];for(var e=0;e<64;e++){var t=new AlphaTab.Model.PlaybackInformation;t.PrimaryChannel=e,t.SecondaryChannel=e,t.Program=this.ReadInt32(),t.Volume=this.Data.ReadByte(),t.Balance=this.Data.ReadByte(),this.Data.Skip(6),this._playbackInfos.push(t)}},ReadMasterBars:function(){for(var e=0;e<this._barCount;e++)this.ReadMasterBar()},ReadMasterBar:function(){var e=null;this._score.MasterBars.length>0&&(e=this._score.MasterBars[this._score.MasterBars.length-1]);var t=new AlphaTab.Model.MasterBar,a=this.Data.ReadByte();if(0!=(1&a)?t.TimeSignatureNumerator=this.Data.ReadByte():null!=e&&(t.TimeSignatureNumerator=e.TimeSignatureNumerator),0!=(2&a)?t.TimeSignatureDenominator=this.Data.ReadByte():null!=e&&(t.TimeSignatureDenominator=e.TimeSignatureDenominator),t.IsRepeatStart=0!=(4&a),0!=(8&a)&&(t.RepeatCount=this.Data.ReadByte()+(this._versionNumber>=500?0:1)),0!=(16&a))if(this._versionNumber<500){for(var i=e,n=0;!(null==i||i.get_IsRepeatEnd()&&i!=e||i.IsRepeatStart);)n|=i.AlternateEndings,i=i.PreviousMasterBar;for(var r=0,l=this.Data.ReadByte(),s=0;s<8;s++){var o=1<<s;l>s&&0==(n&o)&&(r|=o)}t.AlternateEndings=r}else t.AlternateEndings=this.Data.ReadByte();if(0!=(32&a)){var h=new AlphaTab.Model.Section;h.Text=this.ReadStringIntByte(),h.Marker="",this.ReadColor(),t.Section=h}if(0!=(64&a)?(t.KeySignature=AlphaTab.Platform.Std.ReadSignedByte(this.Data),t.KeySignatureType=this.Data.ReadByte()):null!=e&&(t.KeySignature=e.KeySignature,t.KeySignatureType=e.KeySignatureType),this._versionNumber>=500&&0!=(3&a)&&this.Data.Skip(4),this._versionNumber>=500&&0==(16&a)&&(t.AlternateEndings=this.Data.ReadByte()),this._versionNumber>=500){switch(this.Data.ReadByte()){case 1:t.TripletFeel=AlphaTab.Model.TripletFeel.Triplet8th;break;case 2:t.TripletFeel=AlphaTab.Model.TripletFeel.Triplet16th}this.Data.ReadByte()}else t.TripletFeel=this._globalTripletFeel;t.IsDoubleBar=0!=(128&a),this._score.AddMasterBar(t)},ReadTracks:function(){for(var e=0;e<this._trackCount;e++)this.ReadTrack()},ReadTrack:function(){var e=new AlphaTab.Model.Track(1);this._score.AddTrack(e);var t=this.Data.ReadByte();e.Name=this.ReadStringByteLength(40),e.IsPercussion=0!=(1&t);for(var a=this.ReadInt32(),i=[],n=0;n<7;n++){var r=this.ReadInt32();a>n&&i.push(r)}e.Tuning=i.slice(0);var l=this.ReadInt32(),s=this.ReadInt32()-1,o=this.ReadInt32()-1;if(this.Data.Skip(4),s>=0&&s<this._playbackInfos.length){var h=this._playbackInfos[s];h.Port=l,h.IsSolo=0!=(16&t),h.IsMute=0!=(32&t),h.SecondaryChannel=o,AlphaTab.Audio.GeneralMidi.IsGuitar(h.Program)&&(e.DisplayTranspositionPitch=-12),e.PlaybackInfo=h}e.Capo=this.ReadInt32(),e.Color=this.ReadColor(),this._versionNumber>=500&&(this.Data.ReadByte(),this.Data.ReadByte(),this.Data.Skip(43)),this._versionNumber>=510&&(this.Data.Skip(4),this.ReadStringIntByte(),this.ReadStringIntByte())},ReadBars:function(){for(var e=0;e<this._barCount;e++)for(var t=0;t<this._trackCount;t++)this.ReadBar(this._score.Tracks[t])},ReadBar:function(e){var t=new AlphaTab.Model.Bar;e.IsPercussion&&(t.Clef=AlphaTab.Model.Clef.Neutral),e.AddBarToStaff(0,t);var a=1;this._versionNumber>=500&&(this.Data.ReadByte(),a=2);for(var i=0;i<a;i++)this.ReadVoice(e,t)},ReadVoice:function(e,t){var a=this.ReadInt32();if(0!=a){var i=new AlphaTab.Model.Voice;t.AddVoice(i);for(var n=0;n<a;n++)this.ReadBeat(e,t,i)}},ReadBeat:function(e,t,a){var i=new AlphaTab.Model.Beat,n=this.Data.ReadByte();if(0!=(1&n)&&(i.Dots=1),0!=(64&n)){var r=this.Data.ReadByte();i.IsEmpty=0==(2&r)}switch(a.AddBeat(i),AlphaTab.Platform.Std.ReadSignedByte(this.Data)){case-2:i.Duration=AlphaTab.Model.Duration.Whole;break;case-1:i.Duration=AlphaTab.Model.Duration.Half;break;case 0:i.Duration=AlphaTab.Model.Duration.Quarter;break;case 1:i.Duration=AlphaTab.Model.Duration.Eighth;break;case 2:i.Duration=AlphaTab.Model.Duration.Sixteenth;break;case 3:i.Duration=AlphaTab.Model.Duration.ThirtySecond;break;case 4:i.Duration=AlphaTab.Model.Duration.SixtyFourth;break;default:i.Duration=AlphaTab.Model.Duration.Quarter}if(0!=(32&n))switch(i.TupletNumerator=this.ReadInt32(),i.TupletNumerator){case 1:i.TupletDenominator=1;break;case 3:i.TupletDenominator=2;break;case 5:case 6:case 7:i.TupletDenominator=4;break;case 9:case 10:case 11:case 12:case 13:i.TupletDenominator=8;break;case 2:case 4:case 8:break;default:i.TupletNumerator=1,i.TupletDenominator=1}0!=(2&n)&&this.ReadChord(i),0!=(4&n)&&(i.Text=this.ReadStringIntUnused()),0!=(8&n)&&this.ReadBeatEffects(i),0!=(16&n)&&this.ReadMixTableChange(i);for(var l=this.Data.ReadByte(),s=6;s>=0;s--)0!=(l&1<<s)&&6-s<e.Tuning.length&&this.ReadNote(e,t,a,i,6-s);this._versionNumber>=500&&(this.Data.ReadByte(),0!=(8&this.Data.ReadByte())&&this.Data.ReadByte())},ReadChord:function(e){var t=new AlphaTab.Model.Chord,a=AlphaTab.Platform.Std.NewGuid();if(this._versionNumber>=500){this.Data.Skip(17),t.Name=this.ReadStringByteLength(21),this.Data.Skip(4),t.FirstFret=this.ReadInt32();for(l=0;l<7;l++){s=this.ReadInt32();l<e.Voice.Bar.Staff.Track.Tuning.length&&t.Strings.push(s)}var i=this.Data.ReadByte(),n=new Uint8Array(5);this.Data.Read(n,0,n.length);for(l=0;l<i;l++)t.BarreFrets.push(n[l]);this.Data.Skip(26)}else if(0!=this.Data.ReadByte())if(this._versionNumber>=400){this.Data.Skip(16),t.Name=this.ReadStringByteLength(21),this.Data.Skip(4),t.FirstFret=this.ReadInt32();for(l=0;l<7;l++){s=this.ReadInt32();l<e.Voice.Bar.Staff.Track.Tuning.length&&t.Strings.push(s)}var i=this.Data.ReadByte(),n=new Uint8Array(5);this.Data.Read(n,0,n.length);for(l=0;l<i;l++)t.BarreFrets.push(n[l]);this.Data.Skip(26)}else{this.Data.Skip(25),t.Name=this.ReadStringByteLength(34),t.FirstFret=this.ReadInt32();for(l=0;l<6;l++){s=this.ReadInt32();l<e.Voice.Bar.Staff.Track.Tuning.length&&t.Strings.push(s)}this.Data.Skip(36)}else{var r=this._versionNumber>=406?7:6;if(t.Name=this.ReadStringIntByte(),t.FirstFret=this.ReadInt32(),t.FirstFret>0)for(var l=0;l<r;l++){var s=this.ReadInt32();l<e.Voice.Bar.Staff.Track.Tuning.length&&t.Strings.push(s)}}null!=t.Name&&0!=t.Name.length&&(e.ChordId=a,e.Voice.Bar.Staff.Track.Chords[e.ChordId]=t)},ReadBeatEffects:function(e){var t=this.Data.ReadByte(),a=0;if(this._versionNumber>=400&&(a=this.Data.ReadByte()),e.FadeIn=0!=(16&t),(this._versionNumber<400&&0!=(1&t)||0!=(2&t))&&(e.Vibrato=AlphaTab.Model.VibratoType.Slight),e.HasRasgueado=0!=(1&a),0!=(32&t)&&this._versionNumber>=400)switch(i=AlphaTab.Platform.Std.ReadSignedByte(this.Data)){case 1:e.Tap=!0;break;case 2:e.Slap=!0;break;case 3:e.Pop=!0}else if(0!=(32&t)){var i=AlphaTab.Platform.Std.ReadSignedByte(this.Data);switch(i){case 1:e.Tap=!0;break;case 2:e.Slap=!0;break;case 3:e.Pop=!0}this.Data.Skip(4)}if(0!=(4&a)&&this.ReadTremoloBarEffect(e),0!=(64&t)){var n,r;this._versionNumber<500?(r=this.Data.ReadByte(),n=this.Data.ReadByte()):(n=this.Data.ReadByte(),r=this.Data.ReadByte()),n>0?(e.BrushType=AlphaTab.Model.BrushType.BrushUp,e.BrushDuration=AlphaTab.Importer.Gp3To5Importer.ToStrokeValue(n)):r>0&&(e.BrushType=AlphaTab.Model.BrushType.BrushDown,e.BrushDuration=AlphaTab.Importer.Gp3To5Importer.ToStrokeValue(r))}if(0!=(2&a))switch(AlphaTab.Platform.Std.ReadSignedByte(this.Data)){case 0:e.PickStroke=AlphaTab.Model.PickStrokeType.None;break;case 1:e.PickStroke=AlphaTab.Model.PickStrokeType.Up;break;case 2:e.PickStroke=AlphaTab.Model.PickStrokeType.Down}},ReadTremoloBarEffect:function(e){this.Data.ReadByte(),this.ReadInt32();var t=this.ReadInt32();if(t>0)for(var a=0;a<t;a++){var i=new AlphaTab.Model.BendPoint(0,0);i.Offset=this.ReadInt32(),i.Value=this.ReadInt32()/25|0,this.ReadBool(),e.AddWhammyBarPoint(i)}},ReadMixTableChange:function(e){var t=new AlphaTab.Importer.MixTableChange;t.Instrument=AlphaTab.Platform.Std.ReadSignedByte(this.Data),this._versionNumber>=500&&this.Data.Skip(16),t.Volume=AlphaTab.Platform.Std.ReadSignedByte(this.Data),t.Balance=AlphaTab.Platform.Std.ReadSignedByte(this.Data);var a=AlphaTab.Platform.Std.ReadSignedByte(this.Data),i=AlphaTab.Platform.Std.ReadSignedByte(this.Data),n=AlphaTab.Platform.Std.ReadSignedByte(this.Data),r=AlphaTab.Platform.Std.ReadSignedByte(this.Data);if(this._versionNumber>=500&&(t.TempoName=this.ReadStringIntByte()),t.Tempo=this.ReadInt32(),t.Volume>=0&&this.Data.ReadByte(),t.Balance>=0&&this.Data.ReadByte(),a>=0&&this.Data.ReadByte(),i>=0&&this.Data.ReadByte(),n>=0&&this.Data.ReadByte(),r>=0&&this.Data.ReadByte(),t.Tempo>=0&&(t.Duration=AlphaTab.Platform.Std.ReadSignedByte(this.Data),this._versionNumber>=510&&this.Data.ReadByte()),this._versionNumber>=400&&this.Data.ReadByte(),this._versionNumber>=500&&this.Data.ReadByte(),this._versionNumber>=510&&(this.ReadStringIntByte(),this.ReadStringIntByte()),t.Volume>=0){var l=new AlphaTab.Model.Automation;l.IsLinear=!0,l.Type=AlphaTab.Model.AutomationType.Volume,l.Value=t.Volume,e.Automations.push(l)}if(t.Balance>=0){var s=new AlphaTab.Model.Automation;s.IsLinear=!0,s.Type=AlphaTab.Model.AutomationType.Balance,s.Value=t.Balance,e.Automations.push(s)}if(t.Instrument>=0){var o=new AlphaTab.Model.Automation;o.IsLinear=!0,o.Type=AlphaTab.Model.AutomationType.Instrument,o.Value=t.Instrument,e.Automations.push(o)}if(t.Tempo>=0){var h=new AlphaTab.Model.Automation;h.IsLinear=!0,h.Type=AlphaTab.Model.AutomationType.Tempo,h.Value=t.Tempo,e.Automations.push(h),e.Voice.Bar.get_MasterBar().TempoAutomation=h}},ReadNote:function(e,t,a,i,n){var r=new AlphaTab.Model.Note;r.String=e.Tuning.length-n;var l=this.Data.ReadByte();if(0!=(2&l)?r.Accentuated=AlphaTab.Model.AccentuationType.Heavy:0!=(64&l)&&(r.Accentuated=AlphaTab.Model.AccentuationType.Normal),r.IsGhost=0!=(4&l),0!=(32&l)){var s=this.Data.ReadByte();3==s?r.IsDead=!0:2==s&&(r.IsTieDestination=!0)}if(0!=(1&l)&&this._versionNumber<500&&(this.Data.ReadByte(),this.Data.ReadByte()),0!=(16&l)){var o=AlphaTab.Platform.Std.ReadSignedByte(this.Data);r.Dynamic=this.ToDynamicValue(o),i.Dynamic=r.Dynamic}if(0!=(32&l)&&(r.Fret=AlphaTab.Platform.Std.ReadSignedByte(this.Data)),0!=(128&l)&&(r.LeftHandFinger=AlphaTab.Platform.Std.ReadSignedByte(this.Data),r.RightHandFinger=AlphaTab.Platform.Std.ReadSignedByte(this.Data),r.IsFingering=!0),this._versionNumber>=500){0!=(1&l)&&(r.DurationPercent=this.ReadDouble());var h=this.Data.ReadByte();r.AccidentalMode=0!=(2&h)?AlphaTab.Model.NoteAccidentalMode.SwapAccidentals:AlphaTab.Model.NoteAccidentalMode.Default}i.AddNote(r),0!=(8&l)&&this.ReadNoteEffects(e,a,i,r)},ToDynamicValue:function(e){switch(e){case 1:return AlphaTab.Model.DynamicValue.PPP;case 2:return AlphaTab.Model.DynamicValue.PP;case 3:return AlphaTab.Model.DynamicValue.P;case 4:return AlphaTab.Model.DynamicValue.MP;case 5:return AlphaTab.Model.DynamicValue.MF;case 6:return AlphaTab.Model.DynamicValue.F;case 7:return AlphaTab.Model.DynamicValue.FF;case 8:return AlphaTab.Model.DynamicValue.FFF;default:return AlphaTab.Model.DynamicValue.F}},ReadNoteEffects:function(e,t,a,i){var n=this.Data.ReadByte(),r=0;this._versionNumber>=400&&(r=this.Data.ReadByte()),0!=(1&n)&&this.ReadBend(i),0!=(16&n)&&this.ReadGrace(t,i),0!=(4&r)&&this.ReadTremoloPicking(a),0!=(8&r)?this.ReadSlide(i):this._versionNumber<400&&0!=(4&n)&&(i.SlideType=AlphaTab.Model.SlideType.Shift),0!=(16&r)?this.ReadArtificialHarmonic(i):this._versionNumber<400&&(0!=(4&n)&&(i.HarmonicType=AlphaTab.Model.HarmonicType.Natural,i.HarmonicValue=this.DeltaFretToHarmonicValue(i.Fret)),0!=(8&n)&&(i.HarmonicType=AlphaTab.Model.HarmonicType.Artificial)),0!=(32&r)&&this.ReadTrill(i),i.IsLetRing=0!=(8&n),i.IsHammerPullOrigin=0!=(2&n),0!=(64&r)&&(i.Vibrato=AlphaTab.Model.VibratoType.Slight),i.IsPalmMute=0!=(2&r),i.IsStaccato=0!=(1&r)},ReadBend:function(e){this.Data.ReadByte(),this.ReadInt32();var t=this.ReadInt32();if(t>0)for(var a=0;a<t;a++){var i=new AlphaTab.Model.BendPoint(0,0);i.Offset=this.ReadInt32(),i.Value=this.ReadInt32()/25|0,this.ReadBool(),e.AddBendPoint(i)}},ReadGrace:function(e,t){var a=new AlphaTab.Model.Beat,i=new AlphaTab.Model.Note;switch(i.String=t.String,i.Fret=AlphaTab.Platform.Std.ReadSignedByte(this.Data),a.Duration=AlphaTab.Model.Duration.ThirtySecond,a.Dynamic=this.ToDynamicValue(AlphaTab.Platform.Std.ReadSignedByte(this.Data)),AlphaTab.Platform.Std.ReadSignedByte(this.Data)){case 0:break;case 1:i.SlideType=AlphaTab.Model.SlideType.Legato,i.SlideTarget=t;break;case 2:break;case 3:i.IsHammerPullOrigin=!0}if(i.Dynamic=a.Dynamic,this.Data.Skip(1),this._versionNumber<500)a.GraceType=AlphaTab.Model.GraceType.BeforeBeat;else{var n=this.Data.ReadByte();i.IsDead=0!=(1&n),a.GraceType=0!=(2&n)?AlphaTab.Model.GraceType.OnBeat:AlphaTab.Model.GraceType.BeforeBeat}a.AddNote(i),e.AddGraceBeat(a)},ReadTremoloPicking:function(e){switch(this.Data.ReadByte()){case 1:e.TremoloSpeed=AlphaTab.Model.Duration.Eighth;break;case 2:e.TremoloSpeed=AlphaTab.Model.Duration.Sixteenth;break;case 3:e.TremoloSpeed=AlphaTab.Model.Duration.ThirtySecond}},ReadSlide:function(e){if(this._versionNumber>=500)switch(t=AlphaTab.Platform.Std.ReadSignedByte(this.Data)){case 1:e.SlideType=AlphaTab.Model.SlideType.Shift;break;case 2:e.SlideType=AlphaTab.Model.SlideType.Legato;break;case 4:e.SlideType=AlphaTab.Model.SlideType.OutDown;break;case 8:e.SlideType=AlphaTab.Model.SlideType.OutUp;break;case 16:e.SlideType=AlphaTab.Model.SlideType.IntoFromBelow;break;case 32:e.SlideType=AlphaTab.Model.SlideType.IntoFromAbove;break;default:e.SlideType=AlphaTab.Model.SlideType.None}else{var t=AlphaTab.Platform.Std.ReadSignedByte(this.Data);switch(t){case 1:e.SlideType=AlphaTab.Model.SlideType.Shift;break;case 2:e.SlideType=AlphaTab.Model.SlideType.Legato;break;case 3:e.SlideType=AlphaTab.Model.SlideType.OutDown;break;case 4:e.SlideType=AlphaTab.Model.SlideType.OutUp;break;case-1:e.SlideType=AlphaTab.Model.SlideType.IntoFromBelow;break;case-2:e.SlideType=AlphaTab.Model.SlideType.IntoFromAbove;break;default:e.SlideType=AlphaTab.Model.SlideType.None}}},ReadArtificialHarmonic:function(e){var t=this.Data.ReadByte();if(this._versionNumber>=500)switch(t){case 1:e.HarmonicType=AlphaTab.Model.HarmonicType.Natural,e.HarmonicValue=this.DeltaFretToHarmonicValue(e.Fret);break;case 2:this.Data.ReadByte(),this.Data.ReadByte(),this.Data.ReadByte();e.HarmonicType=AlphaTab.Model.HarmonicType.Artificial;break;case 3:e.HarmonicType=AlphaTab.Model.HarmonicType.Tap,e.HarmonicValue=this.DeltaFretToHarmonicValue(this.Data.ReadByte());break;case 4:e.HarmonicType=AlphaTab.Model.HarmonicType.Pinch,e.HarmonicValue=12;break;case 5:e.HarmonicType=AlphaTab.Model.HarmonicType.Semi,e.HarmonicValue=12}else if(this._versionNumber>=400)switch(t){case 1:e.HarmonicType=AlphaTab.Model.HarmonicType.Natural;break;case 3:e.HarmonicType=AlphaTab.Model.HarmonicType.Tap;break;case 4:e.HarmonicType=AlphaTab.Model.HarmonicType.Pinch;break;case 5:e.HarmonicType=AlphaTab.Model.HarmonicType.Semi;break;case 15:case 17:case 22:e.HarmonicType=AlphaTab.Model.HarmonicType.Artificial}},DeltaFretToHarmonicValue:function(e){switch(e){case 2:return 2.4;case 3:return 3.2;case 4:case 5:case 7:case 9:case 12:case 16:case 17:case 19:case 24:return e;case 8:return 8.2;case 10:return 9.6;case 14:case 15:return 14.7;case 21:case 22:return 21.7;default:return 12}},ReadTrill:function(e){switch(e.TrillValue=this.Data.ReadByte()+e.get_StringTuning(),this.Data.ReadByte()){case 1:e.TrillSpeed=AlphaTab.Model.Duration.Sixteenth;break;case 2:e.TrillSpeed=AlphaTab.Model.Duration.ThirtySecond;break;case 3:e.TrillSpeed=AlphaTab.Model.Duration.SixtyFourth}},ReadDouble:function(){var e=new Uint8Array(8);this.Data.Read(e,0,e.length);var t=1-(e[0]>>7<<1),a=(e[0]<<4&2047|e[1]>>4)-1023,i=this.GetDoubleSig(e);return 0==i&&-1023==a?0:t*(1+Math.pow(2,-52)*i)*Math.pow(2,a)},GetDoubleSig:function(e){return 4294967296*((15&e[1])<<16|e[2]<<8|e[3])+2147483648*(e[4]>>7)+((127&e[4])<<24|e[5]<<16|e[6]<<8|e[7])|0},ReadColor:function(){var e=this.Data.ReadByte(),t=this.Data.ReadByte(),a=this.Data.ReadByte();return this.Data.Skip(1),new AlphaTab.Platform.Model.Color(e,t,a,255)},ReadBool:function(){return 0!=this.Data.ReadByte()},ReadInt32:function(){var e=new Uint8Array(4);return this.Data.Read(e,0,4),e[0]|e[1]<<8|e[2]<<16|e[3]<<24},ReadStringIntUnused:function(){return this.Data.Skip(4),this.ReadString(this.Data.ReadByte())},ReadStringInt:function(){return this.ReadString(this.ReadInt32())},ReadStringIntByte:function(){var e=this.ReadInt32()-1;return this.Data.ReadByte(),this.ReadString(e)},ReadString:function(e){var t=new Uint8Array(e);return this.Data.Read(t,0,t.length),AlphaTab.Platform.Std.ToString(t)},ReadStringByteLength:function(e){var t=this.Data.ReadByte(),a=this.ReadString(t);return t<e&&this.Data.Skip(e-t),a}},$StaticConstructor(function(){AlphaTab.Importer.Gp3To5Importer.VersionString="FICHIER GUITAR PRO ",AlphaTab.Importer.Gp3To5Importer.BendStep=25}),AlphaTab.Importer.Gp3To5Importer.ToStrokeValue=function(e){switch(e){case 1:case 2:return 30;case 3:return 60;case 4:return 120;case 5:return 240;case 6:return 480;default:return 0}},$Inherit(AlphaTab.Importer.Gp3To5Importer,AlphaTab.Importer.ScoreImporter),AlphaTab.Importer.GpxFile=function(){this.FileName=null,this.FileSize=0,this.Data=null},AlphaTab.Importer.GpxFileSystem=function(){this.FileFilter=null,this.Files=null,this.Files=[],this.FileFilter=$CreateAnonymousDelegate(this,function(e){return!0})},AlphaTab.Importer.GpxFileSystem.prototype={Load:function(e){var t=new AlphaTab.IO.BitReader(e);this.ReadBlock(t)},ReadHeader:function(e){return this.GetString(e.ReadBytes(4),0,4)},Decompress:function(e,t){var a,i=AlphaTab.IO.ByteBuffer.Empty(),n=this.GetInteger(e.ReadBytes(4),0);try{for(;i.get_Length()<n;)if(1==e.ReadBits(1)){var r=e.ReadBits(4),l=e.ReadBitsReversed(r),s=e.ReadBitsReversed(r),o=i.get_Length()-l,h=Math.min(l,s);a=i.GetBuffer(),i.Write(a,0|o,h)}else for(var s=e.ReadBitsReversed(2),p=0;p<s;p++)i.WriteByte(e.ReadByte())}catch(e){}a=i.GetBuffer();var d=t?4:0,u=i.get_Length()-d,c=new Uint8Array(0|u);return c.set(a.subarray(d,d+u|0),0),c},ReadBlock:function(e){var t=this.ReadHeader(e);if("BCFZ"==t)this.ReadUncompressedBlock(this.Decompress(e,!0));else{if("BCFS"!=t)throw $CreateException(new AlphaTab.Importer.UnsupportedFormatException(""),new Error);this.ReadUncompressedBlock(e.ReadAll())}},ReadUncompressedBlock:function(e){for(var t=4096;t+3<e.length;){if(2==this.GetInteger(e,t)){var a=new AlphaTab.Importer.GpxFile;a.FileName=this.GetString(e,t+4,127),a.FileSize=this.GetInteger(e,t+140);var i=null==this.FileFilter||this.FileFilter(a.FileName);i&&this.Files.push(a);for(var n=t+148,r=0,l=0,s=i?AlphaTab.IO.ByteBuffer.WithCapactiy(a.FileSize):null;0!=(r=this.GetInteger(e,n+4*l++));)t=4096*r,i&&s.Write(e,t,4096);if(i){a.Data=new Uint8Array(0|Math.min(a.FileSize,s.get_Length()));var o=s.ToArray();a.Data.set(o.subarray(0,0+a.Data.length),0)}}t+=4096}},GetString:function(e,t,a){for(var i=new String,n=0;n<a;n++){var r=255&e[t+n];if(0==r)break;i+=String.fromCharCode(r)}return i},GetInteger:function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]}},$StaticConstructor(function(){AlphaTab.Importer.GpxFileSystem.HeaderBcFs="BCFS",AlphaTab.Importer.GpxFileSystem.HeaderBcFz="BCFZ",AlphaTab.Importer.GpxFileSystem.ScoreGpif="score.gpif"}),AlphaTab.Importer.GpxImporter=function(){AlphaTab.Importer.ScoreImporter.call(this)},AlphaTab.Importer.GpxImporter.prototype={get_Name:function(){return"Guitar Pro 6"},ReadScore:function(){AlphaTab.Util.Logger.Info(this.get_Name(),"Loading GPX filesystem",null);var e=new AlphaTab.Importer.GpxFileSystem;e.FileFilter=$CreateAnonymousDelegate(this,function(e){return"score.gpif"==e}),e.Load(this.Data),AlphaTab.Util.Logger.Info(this.get_Name(),"GPX filesystem loaded",null);var t=e.Files[0].Data,a=AlphaTab.Platform.Std.ToString(t);e.Files=null,e=null,AlphaTab.Util.Logger.Info(this.get_Name(),"Start Parsing score.gpif",null);var i=new AlphaTab.Importer.GpxParser;return i.ParseXml(a),AlphaTab.Util.Logger.Info(this.get_Name(),"score.gpif parsed",null),i.Score}},$Inherit(AlphaTab.Importer.GpxImporter,AlphaTab.Importer.ScoreImporter),AlphaTab.Importer.GpxRhythm=function(){this.Dots=0,this.TupletDenominator=0,this.TupletNumerator=0,this.Value=AlphaTab.Model.Duration.QuadrupleWhole,this.TupletDenominator=-1,this.TupletNumerator=-1,this.Value=AlphaTab.Model.Duration.Quarter},AlphaTab.Importer.GpxParser=function(){this._masterTrackAutomations=null,this._tracksMapping=null,this._tracksById=null,this._masterBars=null,this._barsOfMasterBar=null,this._barsById=null,this._voicesOfBar=null,this._voiceById=null,this._beatsOfVoice=null,this._rhythmOfBeat=null,this._beatById=null,this._rhythmById=null,this._noteById=null,this._notesOfBeat=null,this._tappedNotes=null,this._lyricsByTrack=null,this.Score=null},AlphaTab.Importer.GpxParser.prototype={ParseXml:function(e){this._masterTrackAutomations={},this._tracksMapping=new Array(0),this._tracksById={},this._masterBars=[],this._barsOfMasterBar=[],this._voicesOfBar={},this._barsById={},this._voiceById={},this._beatsOfVoice={},this._beatById={},this._rhythmOfBeat={},this._rhythmById={},this._notesOfBeat={},this._noteById={},this._tappedNotes={},this._lyricsByTrack={};var t;try{t=new AlphaTab.Xml.XmlDocument(e)}catch(e){throw $CreateException(new AlphaTab.Importer.UnsupportedFormatException(""),new Error)}if(this.ParseDom(t),this.BuildModel(),this.Score.Finish(),Object.keys(this._lyricsByTrack).length>0)for(var a in this._lyricsByTrack)this._tracksById[a].ApplyLyrics(this._lyricsByTrack[a])},ParseDom:function(e){var t=e.DocumentElement;if(null!=t){if("GPIF"!=t.LocalName)throw $CreateException(new AlphaTab.Importer.UnsupportedFormatException(""),new Error);this.Score=new AlphaTab.Model.Score;for(var a=0,i=t.ChildNodes,n=i.length,r=i[a];a<n;a++,r=i[a])if(r.NodeType==AlphaTab.Xml.XmlNodeType.Element)switch(r.LocalName){case"Score":this.ParseScoreNode(r);break;case"MasterTrack":this.ParseMasterTrackNode(r);break;case"Tracks":this.ParseTracksNode(r);break;case"MasterBars":this.ParseMasterBarsNode(r);break;case"Bars":this.ParseBars(r);break;case"Voices":this.ParseVoices(r);break;case"Beats":this.ParseBeats(r);break;case"Notes":this.ParseNotes(r);break;case"Rhythms":this.ParseRhythms(r)}}},ParseScoreNode:function(e){for(var t=0,a=e.ChildNodes,i=a.length,n=a[t];t<i;t++,n=a[t])if(n.NodeType==AlphaTab.Xml.XmlNodeType.Element)switch(n.LocalName){case"Title":this.Score.Title=n.FirstChild.get_InnerText();break;case"SubTitle":this.Score.SubTitle=n.FirstChild.get_InnerText();break;case"Artist":this.Score.Artist=n.FirstChild.get_InnerText();break;case"Album":this.Score.Album=n.FirstChild.get_InnerText();break;case"Words":this.Score.Words=n.FirstChild.get_InnerText();break;case"Music":this.Score.Music=n.FirstChild.get_InnerText();break;case"WordsAndMusic":if(null!=n.FirstChild&&""!=n.FirstChild.toString()){var r=n.FirstChild.get_InnerText();null==r||0==r.length||null!=this.Score.Words&&0!=this.Score.Words.length||(this.Score.Words=r),null==r||0==r.length||null!=this.Score.Music&&0!=this.Score.Music.length||(this.Score.Music=r)}break;case"Copyright":this.Score.Copyright=n.FirstChild.get_InnerText();break;case"Tabber":this.Score.Tab=n.FirstChild.get_InnerText();break;case"Instructions":this.Score.Instructions=n.FirstChild.get_InnerText();break;case"Notices":this.Score.Notices=n.FirstChild.get_InnerText()}},ParseMasterTrackNode:function(e){for(var t=0,a=e.ChildNodes,i=a.length,n=a[t];t<i;t++,n=a[t])if(n.NodeType==AlphaTab.Xml.XmlNodeType.Element)switch(n.LocalName){case"Automations":this.ParseAutomations(n,this._masterTrackAutomations);break;case"Tracks":this._tracksMapping=n.get_InnerText().split(" ")}},ParseAutomations:function(e,t){for(var a=0,i=e.ChildNodes,n=i.length,r=i[a];a<n;a++,r=i[a])if(r.NodeType==AlphaTab.Xml.XmlNodeType.Element)switch(r.LocalName){case"Automation":this.ParseAutomation(r,t)}},ParseAutomation:function(e,t){for(var a=null,i=!1,n=null,r=0,l=0,s=0,o=null,h=0,p=e.ChildNodes,d=p.length,u=p[h];h<d;h++,u=p[h])if(u.NodeType==AlphaTab.Xml.XmlNodeType.Element)switch(u.LocalName){case"Type":a=u.get_InnerText();break;case"Linear":i="true"==u.get_InnerText().toLowerCase();break;case"Bar":n=u.get_InnerText();break;case"Position":r=AlphaTab.Platform.Std.ParseFloat(u.get_InnerText());break;case"Value":var c=u.get_InnerText().split(" ");l=AlphaTab.Platform.Std.ParseFloat(c[0]),s=AlphaTab.Platform.Std.ParseInt(c[1]);break;case"Text":o=u.get_InnerText()}if(null!=a){var T=null;switch(a){case"Tempo":T=AlphaTab.Model.Automation.BuildTempoAutomation(i,r,l,s)}null!=T&&(T.Text=o),null!=n&&(t.hasOwnProperty(n)||(t[n]=[]),t[n].push(T))}},ParseTracksNode:function(e){for(var t=0,a=e.ChildNodes,i=a.length,n=a[t];t<i;t++,n=a[t])if(n.NodeType==AlphaTab.Xml.XmlNodeType.Element)switch(n.LocalName){case"Track":this.ParseTrack(n)}},ParseTrack:function(e){for(var t=new AlphaTab.Model.Track(1),a=e.GetAttribute("id"),i=0,n=e.ChildNodes,r=n.length,l=n[i];i<r;i++,l=n[i])if(l.NodeType==AlphaTab.Xml.XmlNodeType.Element)switch(l.LocalName){case"Name":t.Name=l.get_InnerText();break;case"Color":var s=l.get_InnerText().split(" ");if(s.length>=3){var o=AlphaTab.Platform.Std.ParseInt(s[0]),h=AlphaTab.Platform.Std.ParseInt(s[1]),p=AlphaTab.Platform.Std.ParseInt(s[2]);t.Color=new AlphaTab.Platform.Model.Color(o,h,p,255)}break;case"Instrument":var d=l.GetAttribute("ref");d.lastIndexOf("-gs")!=d.length-"-gs".length&&d.lastIndexOf("GrandStaff")!=d.length-"GrandStaff".length||t.EnsureStaveCount(2);break;case"ShortName":t.ShortName=l.get_InnerText();break;case"Lyrics":this.ParseLyrics(a,l);break;case"Properties":this.ParseTrackProperties(t,l);break;case"GeneralMidi":this.ParseGeneralMidi(t,l);break;case"PlaybackState":var u=l.get_InnerText();t.PlaybackInfo.IsSolo="Solo"==u,t.PlaybackInfo.IsMute="Mute"==u;break;case"PartSounding":this.ParsePartSounding(t,l)}this._tracksById[a]=t},ParseLyrics:function(e,t){for(var a=[],i=0,n=t.ChildNodes,r=n.length,l=n[i];i<r;i++,l=n[i])if(l.NodeType==AlphaTab.Xml.XmlNodeType.Element)switch(l.LocalName){case"Line":a.push(this.ParseLyricsLine(l))}this._lyricsByTrack[e]=a},ParseLyricsLine:function(e){for(var t=new AlphaTab.Model.Lyrics,a=0,i=e.ChildNodes,n=i.length,r=i[a];a<n;a++,r=i[a])if(r.NodeType==AlphaTab.Xml.XmlNodeType.Element)switch(r.LocalName){case"Offset":t.StartBar=AlphaTab.Platform.Std.ParseInt(r.get_InnerText());break;case"Text":t.Text=r.get_InnerText()}return t},ParseDiagramCollection:function(e,t){for(var a=0,i=t.FindChildElement("Items").ChildNodes,n=i.length,r=i[a];a<n;a++,r=i[a])if(r.NodeType==AlphaTab.Xml.XmlNodeType.Element)switch(r.LocalName){case"Item":this.ParseDiagramItem(e,r)}},ParseDiagramItem:function(e,t){var a=new AlphaTab.Model.Chord,i=t.GetAttribute("id");a.Name=t.GetAttribute("name"),e.Chords[i]=a;var n=t.FindChildElement("Diagram"),r=AlphaTab.Platform.Std.ParseInt(n.GetAttribute("stringCount")),l=AlphaTab.Platform.Std.ParseInt(n.GetAttribute("baseFret"));a.FirstFret=l+1;for(var s=0;s<r;s++)a.Strings.push(-1);for(var o=0,h=n.ChildNodes,p=h.length,d=h[o];o<p;o++,d=h[o])if(d.NodeType==AlphaTab.Xml.XmlNodeType.Element)switch(d.LocalName){case"Fret":var u=AlphaTab.Platform.Std.ParseInt(d.GetAttribute("string"));a.Strings[r-u-1]=l+AlphaTab.Platform.Std.ParseInt(d.GetAttribute("fret"));break;case"Fingering":for(var c={},T=0,g=d.ChildNodes,f=g.length,b=g[T];T<f;T++,b=g[T])if(b.NodeType==AlphaTab.Xml.XmlNodeType.Element)switch(b.LocalName){case"Position":var A=AlphaTab.Model.Fingers.Unknown,y=l+AlphaTab.Platform.Std.ParseInt(b.GetAttribute("fret"));switch(b.GetAttribute("finger")){case"Index":A=AlphaTab.Model.Fingers.IndexFinger;break;case"Middle":A=AlphaTab.Model.Fingers.MiddleFinger;break;case"Rank":A=AlphaTab.Model.Fingers.AnnularFinger;break;case"Pinky":A=AlphaTab.Model.Fingers.LittleFinger;break;case"Thumb":A=AlphaTab.Model.Fingers.Thumb}A!=AlphaTab.Model.Fingers.Unknown&&(c.hasOwnProperty(A)?a.BarreFrets.push(y):c[A]=!0)}}},ParseTrackProperties:function(e,t){for(var a=0,i=t.ChildNodes,n=i.length,r=i[a];a<n;a++,r=i[a])if(r.NodeType==AlphaTab.Xml.XmlNodeType.Element)switch(r.LocalName){case"Property":this.ParseTrackProperty(e,r)}},ParseTrackProperty:function(e,t){switch(t.GetAttribute("name")){case"Tuning":for(var a=t.FindChildElement("Pitches").get_InnerText().split(" "),i=new Int32Array(a.length),n=0;n<i.length;n++)i[i.length-1-n]=AlphaTab.Platform.Std.ParseInt(a[n]);e.Tuning=i;break;case"DiagramCollection":case"ChordCollection":this.ParseDiagramCollection(e,t);break;case"CapoFret":e.Capo=AlphaTab.Platform.Std.ParseInt(t.FindChildElement("Fret").get_InnerText())}},ParseGeneralMidi:function(e,t){e.PlaybackInfo.Port=AlphaTab.Platform.Std.ParseInt(t.FindChildElement("Port").get_InnerText()),e.PlaybackInfo.Program=AlphaTab.Platform.Std.ParseInt(t.FindChildElement("Program").get_InnerText()),e.PlaybackInfo.PrimaryChannel=AlphaTab.Platform.Std.ParseInt(t.FindChildElement("PrimaryChannel").get_InnerText()),e.PlaybackInfo.SecondaryChannel=AlphaTab.Platform.Std.ParseInt(t.FindChildElement("SecondaryChannel").get_InnerText()),e.IsPercussion="Percussion"==t.GetAttribute("table")},ParsePartSounding:function(e,t){for(var a=0,i=t.ChildNodes,n=i.length,r=i[a];a<n;a++,r=i[a])if(r.NodeType==AlphaTab.Xml.XmlNodeType.Element)switch(r.LocalName){case"TranspositionPitch":e.DisplayTranspositionPitch=AlphaTab.Platform.Std.ParseInt(r.get_InnerText())}},ParseMasterBarsNode:function(e){for(var t=0,a=e.ChildNodes,i=a.length,n=a[t];t<i;t++,n=a[t])if(n.NodeType==AlphaTab.Xml.XmlNodeType.Element)switch(n.LocalName){case"MasterBar":this.ParseMasterBar(n)}},ParseMasterBar:function(e){for(var t=new AlphaTab.Model.MasterBar,a=0,i=e.ChildNodes,n=i.length,r=i[a];a<n;a++,r=i[a])if(r.NodeType==AlphaTab.Xml.XmlNodeType.Element)switch(r.LocalName){case"Time":var l=r.get_InnerText().split("/");t.TimeSignatureNumerator=AlphaTab.Platform.Std.ParseInt(l[0]),t.TimeSignatureDenominator=AlphaTab.Platform.Std.ParseInt(l[1]);break;case"DoubleBar":t.IsDoubleBar=!0;break;case"Section":t.Section=new AlphaTab.Model.Section,t.Section.Marker=r.FindChildElement("Letter").get_InnerText(),t.Section.Text=r.FindChildElement("Text").get_InnerText();break;case"Repeat":"true"==r.GetAttribute("start").toLowerCase()&&(t.IsRepeatStart=!0),"true"==r.GetAttribute("end").toLowerCase()&&null!=r.GetAttribute("count")&&(t.RepeatCount=AlphaTab.Platform.Std.ParseInt(r.GetAttribute("count")));break;case"AlternateEndings":for(var s=r.get_InnerText().split(" "),o=0,h=0;h<s.length;h++)o|=1<<-1+AlphaTab.Platform.Std.ParseInt(s[h]);t.AlternateEndings=o;break;case"Bars":this._barsOfMasterBar.push(r.get_InnerText().split(" "));break;case"TripletFeel":switch(r.get_InnerText()){case"NoTripletFeel":t.TripletFeel=AlphaTab.Model.TripletFeel.NoTripletFeel;break;case"Triplet8th":t.TripletFeel=AlphaTab.Model.TripletFeel.Triplet8th;break;case"Triplet16th":t.TripletFeel=AlphaTab.Model.TripletFeel.Triplet16th;break;case"Dotted8th":t.TripletFeel=AlphaTab.Model.TripletFeel.Dotted8th;break;case"Dotted16th":t.TripletFeel=AlphaTab.Model.TripletFeel.Dotted16th;break;case"Scottish8th":t.TripletFeel=AlphaTab.Model.TripletFeel.Scottish8th;break;case"Scottish16th":t.TripletFeel=AlphaTab.Model.TripletFeel.Scottish16th}break;case"Key":t.KeySignature=AlphaTab.Platform.Std.ParseInt(r.FindChildElement("AccidentalCount").get_InnerText());var p=r.FindChildElement("Mode");if(null!=p)switch(p.get_InnerText().toLowerCase()){case"major":t.KeySignatureType=AlphaTab.Model.KeySignatureType.Major;break;case"minor":t.KeySignatureType=AlphaTab.Model.KeySignatureType.Minor}}this._masterBars.push(t)},ParseBars:function(e){for(var t=0,a=e.ChildNodes,i=a.length,n=a[t];t<i;t++,n=a[t])if(n.NodeType==AlphaTab.Xml.XmlNodeType.Element)switch(n.LocalName){case"Bar":this.ParseBar(n)}},ParseBar:function(e){for(var t=new AlphaTab.Model.Bar,a=e.GetAttribute("id"),i=0,n=e.ChildNodes,r=n.length,l=n[i];i<r;i++,l=n[i])if(l.NodeType==AlphaTab.Xml.XmlNodeType.Element)switch(l.LocalName){case"Voices":this._voicesOfBar[a]=l.get_InnerText().split(" ");break;case"Clef":switch(l.get_InnerText()){case"Neutral":t.Clef=AlphaTab.Model.Clef.Neutral;break;case"G2":t.Clef=AlphaTab.Model.Clef.G2;break;case"F4":t.Clef=AlphaTab.Model.Clef.F4;break;case"C4":t.Clef=AlphaTab.Model.Clef.C4;break;case"C3":t.Clef=AlphaTab.Model.Clef.C3}break;case"Ottavia":switch(l.get_InnerText()){case"8va":t.ClefOttavia=AlphaTab.Model.ClefOttavia._8va;break;case"15ma":t.ClefOttavia=AlphaTab.Model.ClefOttavia._15ma;break;case"8vb":t.ClefOttavia=AlphaTab.Model.ClefOttavia._8vb;break;case"15mb":t.ClefOttavia=AlphaTab.Model.ClefOttavia._15mb}}this._barsById[a]=t},ParseVoices:function(e){for(var t=0,a=e.ChildNodes,i=a.length,n=a[t];t<i;t++,n=a[t])if(n.NodeType==AlphaTab.Xml.XmlNodeType.Element)switch(n.LocalName){case"Voice":this.ParseVoice(n)}},ParseVoice:function(e){for(var t=new AlphaTab.Model.Voice,a=e.GetAttribute("id"),i=0,n=e.ChildNodes,r=n.length,l=n[i];i<r;i++,l=n[i])if(l.NodeType==AlphaTab.Xml.XmlNodeType.Element)switch(l.LocalName){case"Beats":this._beatsOfVoice[a]=l.get_InnerText().split(" ")}this._voiceById[a]=t},ParseBeats:function(e){for(var t=0,a=e.ChildNodes,i=a.length,n=a[t];t<i;t++,n=a[t])if(n.NodeType==AlphaTab.Xml.XmlNodeType.Element)switch(n.LocalName){case"Beat":this.ParseBeat(n)}},ParseBeat:function(e){for(var t=new AlphaTab.Model.Beat,a=e.GetAttribute("id"),i=0,n=e.ChildNodes,r=n.length,l=n[i];i<r;i++,l=n[i])if(l.NodeType==AlphaTab.Xml.XmlNodeType.Element)switch(l.LocalName){case"Notes":this._notesOfBeat[a]=l.get_InnerText().split(" ");break;case"Rhythm":this._rhythmOfBeat[a]=l.GetAttribute("ref");break;case"Fadding":"FadeIn"==l.get_InnerText()&&(t.FadeIn=!0);break;case"Tremolo":switch(l.get_InnerText()){case"1/2":t.TremoloSpeed=AlphaTab.Model.Duration.Eighth;break;case"1/4":t.TremoloSpeed=AlphaTab.Model.Duration.Sixteenth;break;case"1/8":t.TremoloSpeed=AlphaTab.Model.Duration.ThirtySecond}break;case"Chord":t.ChordId=l.get_InnerText();break;case"Hairpin":switch(l.get_InnerText()){case"Crescendo":t.Crescendo=AlphaTab.Model.CrescendoType.Crescendo;break;case"Decrescendo":t.Crescendo=AlphaTab.Model.CrescendoType.Decrescendo}break;case"Arpeggio":"Up"==l.get_InnerText()?t.BrushType=AlphaTab.Model.BrushType.ArpeggioUp:t.BrushType=AlphaTab.Model.BrushType.ArpeggioDown;break;case"Properties":this.ParseBeatProperties(l,t);break;case"XProperties":this.ParseBeatXProperties(l,t);break;case"FreeText":t.Text=l.get_InnerText();break;case"Dynamic":switch(l.get_InnerText()){case"PPP":t.Dynamic=AlphaTab.Model.DynamicValue.PPP;break;case"PP":t.Dynamic=AlphaTab.Model.DynamicValue.PP;break;case"P":t.Dynamic=AlphaTab.Model.DynamicValue.P;break;case"MP":t.Dynamic=AlphaTab.Model.DynamicValue.MP;break;case"MF":t.Dynamic=AlphaTab.Model.DynamicValue.MF;break;case"F":t.Dynamic=AlphaTab.Model.DynamicValue.F;break;case"FF":t.Dynamic=AlphaTab.Model.DynamicValue.FF;break;case"FFF":t.Dynamic=AlphaTab.Model.DynamicValue.FFF}break;case"GraceNotes":switch(l.get_InnerText()){case"OnBeat":t.GraceType=AlphaTab.Model.GraceType.OnBeat;break;case"BeforeBeat":t.GraceType=AlphaTab.Model.GraceType.BeforeBeat}break;case"Legato":"true"==l.GetAttribute("origin")&&(t.IsLegatoOrigin=!0)}this._beatById[a]=t},ParseBeatXProperties:function(e,t){for(var a=0,i=e.ChildNodes,n=i.length,r=i[a];a<n;a++,r=i[a])if(r.NodeType==AlphaTab.Xml.XmlNodeType.Element)switch(r.LocalName){case"XProperty":switch(r.GetAttribute("id")){case"1124204545":var l=AlphaTab.Platform.Std.ParseInt(r.FindChildElement("Int").get_InnerText());t.InvertBeamDirection=1==l}}},ParseBeatProperties:function(e,t){for(var a=!1,i=null,n=null,r=null,l=null,s=null,o=0,h=e.ChildNodes,p=h.length,d=h[o];o<p;o++,d=h[o])if(d.NodeType==AlphaTab.Xml.XmlNodeType.Element)switch(d.LocalName){case"Property":switch(d.GetAttribute("name")){case"Brush":"Up"==d.FindChildElement("Direction").get_InnerText()?t.BrushType=AlphaTab.Model.BrushType.BrushUp:t.BrushType=AlphaTab.Model.BrushType.BrushDown;break;case"PickStroke":"Up"==d.FindChildElement("Direction").get_InnerText()?t.PickStroke=AlphaTab.Model.PickStrokeType.Up:t.PickStroke=AlphaTab.Model.PickStrokeType.Down;break;case"Slapped":null!=d.FindChildElement("Enable")&&(t.Slap=!0);break;case"Popped":null!=d.FindChildElement("Enable")&&(t.Pop=!0);break;case"VibratoWTremBar":switch(d.FindChildElement("Strength").get_InnerText()){case"Wide":t.Vibrato=AlphaTab.Model.VibratoType.Wide;break;case"Slight":t.Vibrato=AlphaTab.Model.VibratoType.Slight}break;case"WhammyBar":a=!0;break;case"WhammyBarExtend":break;case"WhammyBarOriginValue":null==i&&(i=new AlphaTab.Model.BendPoint(0,0)),i.Value=this.ToBendValue(AlphaTab.Platform.Std.ParseFloat(d.FindChildElement("Float").get_InnerText()));break;case"WhammyBarOriginOffset":null==i&&(i=new AlphaTab.Model.BendPoint(0,0)),i.Offset=this.ToBendOffset(AlphaTab.Platform.Std.ParseFloat(d.FindChildElement("Float").get_InnerText()));break;case"WhammyBarMiddleValue":n=this.ToBendValue(AlphaTab.Platform.Std.ParseFloat(d.FindChildElement("Float").get_InnerText()));break;case"WhammyBarMiddleOffset1":r=this.ToBendOffset(AlphaTab.Platform.Std.ParseFloat(d.FindChildElement("Float").get_InnerText()));break;case"WhammyBarMiddleOffset2":l=this.ToBendOffset(AlphaTab.Platform.Std.ParseFloat(d.FindChildElement("Float").get_InnerText()));break;case"WhammyBarDestinationValue":null==s&&(s=new AlphaTab.Model.BendPoint(60,0)),s.Value=this.ToBendValue(AlphaTab.Platform.Std.ParseFloat(d.FindChildElement("Float").get_InnerText()));break;case"WhammyBarDestinationOffset":null==s&&(s=new AlphaTab.Model.BendPoint(0,0)),s.Offset=this.ToBendOffset(AlphaTab.Platform.Std.ParseFloat(d.FindChildElement("Float").get_InnerText()))}}if(a){null==i&&(i=new AlphaTab.Model.BendPoint(0,0)),null==s&&(s=new AlphaTab.Model.BendPoint(60,0));var u=[];u.push(i),null!=r&&null!=n&&u.push(new AlphaTab.Model.BendPoint(r,n)),null!=l&&null!=n&&u.push(new AlphaTab.Model.BendPoint(l,n)),null==r&&null==l&&null!=n&&u.push(new AlphaTab.Model.BendPoint(30,n)),u.push(s),t.WhammyBarPoints=u}},ParseNotes:function(e){for(var t=0,a=e.ChildNodes,i=a.length,n=a[t];t<i;t++,n=a[t])if(n.NodeType==AlphaTab.Xml.XmlNodeType.Element)switch(n.LocalName){case"Note":this.ParseNote(n)}},ParseNote:function(e){for(var t=new AlphaTab.Model.Note,a=e.GetAttribute("id"),i=0,n=e.ChildNodes,r=n.length,l=n[i];i<r;i++,l=n[i])if(l.NodeType==AlphaTab.Xml.XmlNodeType.Element)switch(l.LocalName){case"Properties":this.ParseNoteProperties(l,t,a);break;case"AntiAccent":"normal"==l.get_InnerText().toLowerCase()&&(t.IsGhost=!0);break;case"LetRing":t.IsLetRing=!0;break;case"Trill":t.TrillValue=AlphaTab.Platform.Std.ParseInt(l.get_InnerText()),t.TrillSpeed=AlphaTab.Model.Duration.Sixteenth;break;case"Accent":var s=AlphaTab.Platform.Std.ParseInt(l.get_InnerText());0!=(1&s)&&(t.IsStaccato=!0),0!=(4&s)&&(t.Accentuated=AlphaTab.Model.AccentuationType.Heavy),0!=(8&s)&&(t.Accentuated=AlphaTab.Model.AccentuationType.Normal);break;case"Tie":"true"==l.GetAttribute("origin").toLowerCase()&&(t.IsTieOrigin=!0),"true"==l.GetAttribute("destination").toLowerCase()&&(t.IsTieDestination=!0);break;case"Vibrato":switch(l.get_InnerText()){case"Slight":t.Vibrato=AlphaTab.Model.VibratoType.Slight;break;case"Wide":t.Vibrato=AlphaTab.Model.VibratoType.Wide}break;case"LeftFingering":switch(t.IsFingering=!0,l.get_InnerText()){case"P":t.LeftHandFinger=AlphaTab.Model.Fingers.Thumb;break;case"I":t.LeftHandFinger=AlphaTab.Model.Fingers.IndexFinger;break;case"M":t.LeftHandFinger=AlphaTab.Model.Fingers.MiddleFinger;break;case"A":t.LeftHandFinger=AlphaTab.Model.Fingers.AnnularFinger;break;case"C":t.LeftHandFinger=AlphaTab.Model.Fingers.LittleFinger}break;case"RightFingering":switch(t.IsFingering=!0,l.get_InnerText()){case"P":t.RightHandFinger=AlphaTab.Model.Fingers.Thumb;break;case"I":t.RightHandFinger=AlphaTab.Model.Fingers.IndexFinger;break;case"M":t.RightHandFinger=AlphaTab.Model.Fingers.MiddleFinger;break;case"A":t.RightHandFinger=AlphaTab.Model.Fingers.AnnularFinger;break;case"C":t.RightHandFinger=AlphaTab.Model.Fingers.LittleFinger}}this._noteById[a]=t},ParseNoteProperties:function(e,t,a){for(var i=!1,n=null,r=null,l=null,s=null,o=null,h=0,p=e.ChildNodes,d=p.length,u=p[h];h<d;h++,u=p[h])if(u.NodeType==AlphaTab.Xml.XmlNodeType.Element)switch(u.LocalName){case"Property":switch(u.GetAttribute("name")){case"String":t.String=AlphaTab.Platform.Std.ParseInt(u.FindChildElement("String").get_InnerText())+1;break;case"Fret":t.Fret=AlphaTab.Platform.Std.ParseInt(u.FindChildElement("Fret").get_InnerText());break;case"Element":t.Element=AlphaTab.Platform.Std.ParseInt(u.FindChildElement("Element").get_InnerText());break;case"Variation":t.Variation=AlphaTab.Platform.Std.ParseInt(u.FindChildElement("Variation").get_InnerText());break;case"Tapped":this._tappedNotes[a]=!0;break;case"HarmonicType":var c=u.FindChildElement("HType");if(null!=c)switch(c.get_InnerText()){case"NoHarmonic":t.HarmonicType=AlphaTab.Model.HarmonicType.None;break;case"Natural":t.HarmonicType=AlphaTab.Model.HarmonicType.Natural;break;case"Artificial":t.HarmonicType=AlphaTab.Model.HarmonicType.Artificial;break;case"Pinch":t.HarmonicType=AlphaTab.Model.HarmonicType.Pinch;break;case"Tap":t.HarmonicType=AlphaTab.Model.HarmonicType.Tap;break;case"Semi":t.HarmonicType=AlphaTab.Model.HarmonicType.Semi;break;case"Feedback":t.HarmonicType=AlphaTab.Model.HarmonicType.Feedback}break;case"HarmonicFret":var T=u.FindChildElement("HFret");null!=T&&(t.HarmonicValue=AlphaTab.Platform.Std.ParseFloat(T.get_InnerText()));break;case"Muted":null!=u.FindChildElement("Enable")&&(t.IsDead=!0);break;case"PalmMuted":null!=u.FindChildElement("Enable")&&(t.IsPalmMute=!0);break;case"Octave":t.Octave=AlphaTab.Platform.Std.ParseInt(u.FindChildElement("Number").get_InnerText());break;case"Tone":t.Tone=AlphaTab.Platform.Std.ParseInt(u.FindChildElement("Step").get_InnerText());break;case"Bended":i=!0;break;case"BendOriginValue":null==n&&(n=new AlphaTab.Model.BendPoint(0,0)),n.Value=this.ToBendValue(AlphaTab.Platform.Std.ParseFloat(u.FindChildElement("Float").get_InnerText()));break;case"BendOriginOffset":null==n&&(n=new AlphaTab.Model.BendPoint(0,0)),n.Offset=this.ToBendOffset(AlphaTab.Platform.Std.ParseFloat(u.FindChildElement("Float").get_InnerText()));break;case"BendMiddleValue":r=this.ToBendValue(AlphaTab.Platform.Std.ParseFloat(u.FindChildElement("Float").get_InnerText()));break;case"BendMiddleOffset1":l=this.ToBendOffset(AlphaTab.Platform.Std.ParseFloat(u.FindChildElement("Float").get_InnerText()));break;case"BendMiddleOffset2":s=this.ToBendOffset(AlphaTab.Platform.Std.ParseFloat(u.FindChildElement("Float").get_InnerText()));break;case"BendDestinationValue":null==o&&(o=new AlphaTab.Model.BendPoint(60,0)),o.Value=this.ToBendValue(AlphaTab.Platform.Std.ParseFloat(u.FindChildElement("Float").get_InnerText()));break;case"BendDestinationOffset":null==o&&(o=new AlphaTab.Model.BendPoint(0,0)),o.Offset=this.ToBendOffset(AlphaTab.Platform.Std.ParseFloat(u.FindChildElement("Float").get_InnerText()));break;case"HopoOrigin":null!=u.FindChildElement("Enable")&&(t.IsHammerPullOrigin=!0);break;case"HopoDestination":break;case"Slide":var g=AlphaTab.Platform.Std.ParseInt(u.FindChildElement("Flags").get_InnerText());0!=(1&g)&&(t.SlideType=AlphaTab.Model.SlideType.Shift),0!=(2&g)&&(t.SlideType=AlphaTab.Model.SlideType.Legato),0!=(4&g)&&(t.SlideType=AlphaTab.Model.SlideType.OutDown),0!=(8&g)&&(t.SlideType=AlphaTab.Model.SlideType.OutUp),0!=(16&g)&&(t.SlideType=AlphaTab.Model.SlideType.IntoFromBelow),0!=(32&g)&&(t.SlideType=AlphaTab.Model.SlideType.IntoFromAbove)}}i&&(null==n&&(n=new AlphaTab.Model.BendPoint(0,0)),null==o&&(o=new AlphaTab.Model.BendPoint(60,0)),t.AddBendPoint(n),null!=l&&null!=r&&t.AddBendPoint(new AlphaTab.Model.BendPoint(l,r)),null!=s&&null!=r&&t.AddBendPoint(new AlphaTab.Model.BendPoint(s,r)),null==l&&null==s&&null!=r&&t.AddBendPoint(new AlphaTab.Model.BendPoint(30,r)),t.AddBendPoint(o))},ToBendValue:function(e){return 0|.04*e},ToBendOffset:function(e){return 0|.6*e},ParseRhythms:function(e){for(var t=0,a=e.ChildNodes,i=a.length,n=a[t];t<i;t++,n=a[t])if(n.NodeType==AlphaTab.Xml.XmlNodeType.Element)switch(n.LocalName){case"Rhythm":this.ParseRhythm(n)}},ParseRhythm:function(e){for(var t=new AlphaTab.Importer.GpxRhythm,a=e.GetAttribute("id"),i=0,n=e.ChildNodes,r=n.length,l=n[i];i<r;i++,l=n[i])if(l.NodeType==AlphaTab.Xml.XmlNodeType.Element)switch(l.LocalName){case"NoteValue":switch(l.get_InnerText()){case"Long":t.Value=AlphaTab.Model.Duration.QuadrupleWhole;break;case"DoubleWhole":t.Value=AlphaTab.Model.Duration.DoubleWhole;break;case"Whole":t.Value=AlphaTab.Model.Duration.Whole;break;case"Half":t.Value=AlphaTab.Model.Duration.Half;break;case"Quarter":t.Value=AlphaTab.Model.Duration.Quarter;break;case"Eighth":t.Value=AlphaTab.Model.Duration.Eighth;break;case"16th":t.Value=AlphaTab.Model.Duration.Sixteenth;break;case"32nd":t.Value=AlphaTab.Model.Duration.ThirtySecond;break;case"64th":t.Value=AlphaTab.Model.Duration.SixtyFourth;break;case"128th":t.Value=AlphaTab.Model.Duration.OneHundredTwentyEighth;break;case"256th":t.Value=AlphaTab.Model.Duration.TwoHundredFiftySixth}break;case"PrimaryTuplet":t.TupletNumerator=AlphaTab.Platform.Std.ParseInt(l.GetAttribute("num")),t.TupletDenominator=AlphaTab.Platform.Std.ParseInt(l.GetAttribute("den"));break;case"AugmentationDot":t.Dots=AlphaTab.Platform.Std.ParseInt(l.GetAttribute("count"))}this._rhythmById[a]=t},BuildModel:function(){for(var e=0,t=this._masterBars.length;e<t;e++){C=this._masterBars[e];this.Score.AddMasterBar(C)}for(var a=0,i=this._tracksMapping,n=i.length,r=i[a];a<n;a++,r=i[a])if(null!=r&&0!=r.length){var l=this._tracksById[r];this.Score.AddTrack(l)}for(var s=0;s<this._barsOfMasterBar.length;s++)for(var o=this._barsOfMasterBar[s],h=0,p=0,d=0;p<o.length&&d<this.Score.Tracks.length;p++)if("-1"!=(u=o[p])){c=this._barsById[u];(l=this.Score.Tracks[d]).AddBarToStaff(h,c),h==l.Staves.length-1?(d++,h=0):h++}else d++;for(var u in this._barsById){var c=this._barsById[u];if(this._voicesOfBar.hasOwnProperty(u))for(var T=0,g=this._voicesOfBar[u],f=g.length,b=g[T];T<f;T++,b=g[T])if("-1"!=b)c.AddVoice(this._voiceById[b]);else{M=new AlphaTab.Model.Voice;c.AddVoice(M),(y=new AlphaTab.Model.Beat).IsEmpty=!0,y.Duration=AlphaTab.Model.Duration.Quarter,M.AddBeat(y)}}for(var A in this._beatById){var y=this._beatById[A],m=this._rhythmOfBeat[A],S=this._rhythmById[m];if(y.Duration=S.Value,y.Dots=S.Dots,y.TupletNumerator=S.TupletNumerator,y.TupletDenominator=S.TupletDenominator,this._notesOfBeat.hasOwnProperty(A))for(var B=0,_=this._notesOfBeat[A],R=_.length,G=_[B];B<R;B++,G=_[B])"-1"!=G&&(y.AddNote(this._noteById[G]),this._tappedNotes.hasOwnProperty(G)&&(y.Tap=!0))}for(var b in this._voiceById){var M=this._voiceById[b];if(this._beatsOfVoice.hasOwnProperty(b))for(var v=0,I=this._beatsOfVoice[b],P=I.length,A=I[v];v<P;v++,A=I[v])"-1"!=A&&M.AddBeat(this._beatById[A].Clone())}for(var p in this._masterTrackAutomations)for(var N=this._masterTrackAutomations[p],C=this.Score.MasterBars[AlphaTab.Platform.Std.ParseInt(p)],e=0,t=N.length;e<t;e++){var F=N[e];F.Type==AlphaTab.Model.AutomationType.Tempo&&("0"==p&&(this.Score.Tempo=0|F.Value,null!=F.Text&&(this.Score.TempoLabel=F.Text)),C.TempoAutomation=F)}}},$StaticConstructor(function(){AlphaTab.Importer.GpxParser.InvalidId="-1",AlphaTab.Importer.GpxParser.BendPointPositionFactor=.6,AlphaTab.Importer.GpxParser.BendPointValueFactor=.04}),AlphaTab.Importer.MixTableChange=function(){this.Volume=0,this.Balance=0,this.Instrument=0,this.TempoName=null,this.Tempo=0,this.Duration=0,this.Volume=-1,this.Balance=-1,this.Instrument=-1,this.TempoName=null,this.Tempo=-1,this.Duration=0},AlphaTab.Importer.MusicXmlImporter=function(){this._score=null,this._trackById=null,this._trackFirstMeasureNumber=0,this._maxVoices=0,this._currentChord=null,this._divisionsPerQuarterNote=0,this._voiceOfStaff={},this._isBeamContinue=!1,this._previousBeatWasPulled=!1,this._previousBeat=null,AlphaTab.Importer.ScoreImporter.call(this)},AlphaTab.Importer.MusicXmlImporter.prototype={get_Name:function(){return"MusicXML"},ReadScore:function(){this._trackById={};var e,t=AlphaTab.Platform.Std.ToString(this.Data.ReadAll());try{e=new AlphaTab.Xml.XmlDocument(t)}catch(e){throw $CreateException(new AlphaTab.Importer.UnsupportedFormatException(""),new Error)}return this._score=new AlphaTab.Model.Score,this._score.Tempo=120,this.ParseDom(e),this._score.Finish(),this._score},ParseDom:function(e){var t=e.DocumentElement;if(null==t)throw $CreateException(new AlphaTab.Importer.UnsupportedFormatException(""),new Error);switch(t.LocalName){case"score-partwise":this.ParsePartwise(t);break;case"score-timewise":break;default:throw $CreateException(new AlphaTab.Importer.UnsupportedFormatException(""),new Error)}},ParsePartwise:function(e){for(var t=0,a=e.ChildNodes,i=a.length,n=a[t];t<i;t++,n=a[t])if(n.NodeType==AlphaTab.Xml.XmlNodeType.Element)switch(n.LocalName){case"movement-title":this._score.Title=n.FirstChild.get_InnerText();break;case"identification":this.ParseIdentification(n);break;case"part-list":this.ParsePartList(n);break;case"part":this.ParsePart(n)}},ParsePart:function(e){var t=e.GetAttribute("id");if(this._trackById.hasOwnProperty(t))for(var a=this._trackById[t],i=!0,n=0,r=e.ChildNodes,l=r.length,s=r[n];n<l;n++,s=r[n])if(s.NodeType==AlphaTab.Xml.XmlNodeType.Element)switch(s.LocalName){case"measure":this.ParseMeasure(s,a,i)&&(i=!1)}},ParseMeasure:function(e,t,a){if("yes"==e.GetAttribute("implicit")&&0==e.GetElementsByTagName("note").length)return!1;var i=0;if(a)this._divisionsPerQuarterNote=0,this._trackFirstMeasureNumber=AlphaTab.Platform.Std.ParseInt(e.GetAttribute("number")),-2147483648==this._trackFirstMeasureNumber&&(this._trackFirstMeasureNumber=0),i=0;else{if(-2147483648==(i=AlphaTab.Platform.Std.ParseInt(e.GetAttribute("number"))))return!1;i-=this._trackFirstMeasureNumber}if(a){var n=e.GetElementsByTagName("attributes");if(n.length>0){var r=n[0].GetElementsByTagName("staves");if(r.length>0){var l=AlphaTab.Platform.Std.ParseInt(r[0].get_InnerText());t.EnsureStaveCount(l)}}}for(var s=new Array(t.Staves.length),o=null,h=t.Staves[0].Bars.length;h<=i;h++)for(var p=0;p<t.Staves.length;p++){var d=s[p]=new AlphaTab.Model.Bar;if(t.Staves[p].Bars.length>0){var u=t.Staves[p].Bars[t.Staves[p].Bars.length-1];d.Clef=u.Clef}o=this.GetOrCreateMasterBar(i),t.AddBarToStaff(p,d);for(var c=0;c<this._maxVoices;c++){var T=new AlphaTab.Model.Voice;d.AddVoice(T);var g=function(){var e=new AlphaTab.Model.Beat;return e.IsEmpty=!0,e}.call(this);T.AddBeat(g)}}for(var f=!1,b=0,A=e.ChildNodes,y=A.length,m=A[b];b<y;b++,m=A[b])if(m.NodeType==AlphaTab.Xml.XmlNodeType.Element)switch(m.LocalName){case"note":this.ParseNoteBeat(m,s);break;case"forward":this.ParseForward(m,s);break;case"direction":this.ParseDirection(m,o);break;case"attributes":f||(this.ParseAttributes(m,s,o),f=!0);break;case"harmony":this.ParseHarmony(m,t);break;case"sound":break;case"barline":this.ParseBarline(m,o)}return!0},GetOrCreateBeat:function(e,t,a){var i=0,n=e.GetElementsByTagName("voice");n.length>0&&(i=AlphaTab.Platform.Std.ParseInt(n[0].get_InnerText())-1);var r=this._previousBeatWasPulled;this._previousBeatWasPulled=!1;var l=e.GetElementsByTagName("staff"),s=1;if(l.length>0){s=AlphaTab.Platform.Std.ParseInt(l[0].get_InnerText()),(this._isBeamContinue||r)&&this._previousBeat.Voice.Bar.Staff.Index!=s-1&&(s=this._previousBeat.Voice.Bar.Staff.Index+1,this._previousBeatWasPulled=!0);var o=t[0].Staff.Track.Index+"-"+s;this._voiceOfStaff.hasOwnProperty(o)||(this._voiceOfStaff[o]=i),i-=this._voiceOfStaff[o]}var h,p=t[s-1],d=this.GetOrCreateVoice(p,i);return a||1==d.Beats.length&&d.IsEmpty?h=d.Beats[d.Beats.length-1]:((h=new AlphaTab.Model.Beat).IsEmpty=!1,d.AddBeat(h)),this._isBeamContinue=!1,this._previousBeat=h,h},ParseForward:function(e,t){for(var a=this.GetOrCreateBeat(e,t,!1),i=4*AlphaTab.Platform.Std.ParseInt(e.FindChildElement("duration").get_InnerText())/this._divisionsPerQuarterNote,n=new Int32Array([64,32,16,8,4,2,1]),r=0,l=n.length,s=n[r];r<l;r++,s=n[r])if(i>=s){a.Duration=s,i-=s;break}a.IsEmpty=!1},ParseStaffDetails:function(e,t){for(var a=0,i=e.ChildNodes,n=i.length,r=i[a];a<n;a++,r=i[a])if(r.NodeType==AlphaTab.Xml.XmlNodeType.Element)switch(r.LocalName){case"staff-lines":t.Tuning=new Int32Array(AlphaTab.Platform.Std.ParseInt(r.get_InnerText()));break;case"staff-tuning":this.ParseStaffTuning(r,t)}this.IsEmptyTuning(t.Tuning)&&(t.Tuning=new Int32Array(0))},ParseStaffTuning:function(e,t){for(var a=AlphaTab.Platform.Std.ParseInt(e.GetAttribute("line")),i="C",n="",r=0,l=0,s=e.ChildNodes,o=s.length,h=s[l];l<o;l++,h=s[l])if(h.NodeType==AlphaTab.Xml.XmlNodeType.Element)switch(h.LocalName){case"tuning-step":i=h.get_InnerText();break;case"tuning-alter":r=AlphaTab.Platform.Std.ParseInt(h.get_InnerText());break;case"tuning-octave":n=h.get_InnerText()}t.Tuning[t.Tuning.length-a]=AlphaTab.Model.TuningParser.GetTuningForText(i+n)+r},ParseHarmony:function(e,t){var a=e.FindChildElement("root").FindChildElement("root-step").get_InnerText(),i=(e.FindChildElement("kind").get_InnerText(),new AlphaTab.Model.Chord);i.Name=a,this._currentChord=AlphaTab.Platform.Std.NewGuid(),t.Chords[this._currentChord]=i},ParseBarline:function(e,t){for(var a=0,i=e.ChildNodes,n=i.length,r=i[a];a<n;a++,r=i[a])if(r.NodeType==AlphaTab.Xml.XmlNodeType.Element)switch(r.LocalName){case"repeat":this.ParseRepeat(r,t);break;case"ending":this.ParseEnding(r,t)}},ParseEnding:function(e,t){var a=AlphaTab.Platform.Std.ParseInt(e.GetAttribute("number"));a>0&&(--a,t.AlternateEndings|=1<<a)},ParseRepeat:function(e,t){var a=e.GetAttribute("direction"),i=AlphaTab.Platform.Std.ParseInt(e.GetAttribute("times"));i<0&&(i=2),"backward"==a?t.RepeatCount=i:"forward"==a&&(t.IsRepeatStart=!0)},ParseNoteBeat:function(e,t){var a=e.GetElementsByTagName("chord").length>0,i=this.GetOrCreateBeat(e,t,a);i.ChordId=this._currentChord,this._currentChord=null;var n=new AlphaTab.Model.Note;i.Voice.IsEmpty=!1,i.IsEmpty=!1,i.AddNote(n),i.Dots=0;for(var r=0,l=e.ChildNodes,s=l.length,o=l[r];r<s;r++,o=l[r])if(o.NodeType==AlphaTab.Xml.XmlNodeType.Element)switch(o.LocalName){case"grace":i.GraceType=AlphaTab.Model.GraceType.BeforeBeat,i.Duration=AlphaTab.Model.Duration.ThirtySecond;break;case"duration":if(i.get_IsRest())switch(AlphaTab.Platform.Std.ParseInt(o.get_InnerText())){case 1:i.Duration=AlphaTab.Model.Duration.Whole;break;case 2:i.Duration=AlphaTab.Model.Duration.Half;break;case 4:i.Duration=AlphaTab.Model.Duration.Quarter;break;case 8:i.Duration=AlphaTab.Model.Duration.Eighth;break;case 16:i.Duration=AlphaTab.Model.Duration.Sixteenth;break;case 32:i.Duration=AlphaTab.Model.Duration.ThirtySecond;break;case 64:i.Duration=AlphaTab.Model.Duration.SixtyFourth;break;default:i.Duration=AlphaTab.Model.Duration.Quarter}break;case"tie":AlphaTab.Importer.MusicXmlImporter.ParseTied(o,n);break;case"cue":case"instrument":break;case"type":i.Duration=this.GetDuration(o.get_InnerText()),i.GraceType!=AlphaTab.Model.GraceType.None&&i.Duration<AlphaTab.Model.Duration.Sixteenth&&(i.Duration=AlphaTab.Model.Duration.Eighth);break;case"dot":i.Dots++;break;case"accidental":this.ParseAccidental(o,n);break;case"time-modification":this.ParseTimeModification(o,i);break;case"stem":break;case"notehead":"yes"==o.GetAttribute("parentheses")&&(n.IsGhost=!0);break;case"beam":"continue"==o.get_InnerText()&&(this._isBeamContinue=!0);break;case"notations":this.ParseNotations(o,i,n);break;case"lyric":this.ParseLyric(o,i);break;case"pitch":this.ParsePitch(o,n);break;case"unpitched":this.ParseUnpitched(o,n);break;case"rest":i.IsEmpty=!1,i.Notes=[]}if(n.get_IsStringed())for(var h=0;h<i.Notes.length;h++)if(i.Notes[h].String==n.String&&i.Notes[h]!=n){i.RemoveNote(n);break}},GetDuration:function(e){switch(e){case"256th":case"128th":case"64th":return AlphaTab.Model.Duration.SixtyFourth;case"32nd":return AlphaTab.Model.Duration.ThirtySecond;case"16th":return AlphaTab.Model.Duration.Sixteenth;case"eighth":return AlphaTab.Model.Duration.Eighth;case"quarter":return AlphaTab.Model.Duration.Quarter;case"half":return AlphaTab.Model.Duration.Half;case"long":case"breve":case"whole":return AlphaTab.Model.Duration.Whole}return AlphaTab.Model.Duration.Quarter},ParseLyric:function(e,t){for(var a=0,i=e.ChildNodes,n=i.length,r=i[a];a<n;a++,r=i[a])if(r.NodeType==AlphaTab.Xml.XmlNodeType.Element)switch(r.LocalName){case"text":null!=t.Text&&0!=t.Text.length?t.Text+=" "+r.get_InnerText():t.Text=r.get_InnerText()}},ParseAccidental:function(e,t){switch(e.get_InnerText()){case"sharp":t.AccidentalMode=AlphaTab.Model.NoteAccidentalMode.ForceSharp;break;case"natural":t.AccidentalMode=AlphaTab.Model.NoteAccidentalMode.ForceNatural;break;case"flat":t.AccidentalMode=AlphaTab.Model.NoteAccidentalMode.ForceFlat}},ParseNotations:function(e,t,a){for(var i=0,n=e.ChildNodes,r=n.length,l=n[i];i<r;i++,l=n[i])if(l.NodeType==AlphaTab.Xml.XmlNodeType.Element)switch(l.LocalName){case"articulations":this.ParseArticulations(l,a);break;case"tied":AlphaTab.Importer.MusicXmlImporter.ParseTied(l,a);break;case"slide":case"glissando":"start"==l.GetAttribute("type")&&(a.SlideType=AlphaTab.Model.SlideType.Shift);break;case"dynamics":this.ParseDynamics(l,t);break;case"technical":this.ParseTechnical(l,a);break;case"ornaments":this.ParseOrnaments(l,a);break;case"slur":"start"==l.GetAttribute("type")&&(t.IsLegatoOrigin=!0)}},ParseOrnaments:function(e,t){for(var a=0,i=e.ChildNodes,n=i.length,r=i[a];a<n;a++,r=i[a])if(r.NodeType==AlphaTab.Xml.XmlNodeType.Element)switch(r.LocalName){case"tremolo":switch(AlphaTab.Platform.Std.ParseInt(r.get_InnerText())){case 1:t.Beat.TremoloSpeed=AlphaTab.Model.Duration.Eighth;break;case 2:t.Beat.TremoloSpeed=AlphaTab.Model.Duration.Sixteenth;break;case 3:t.Beat.TremoloSpeed=AlphaTab.Model.Duration.ThirtySecond}}},ParseTechnical:function(e,t){for(var a=0,i=e.ChildNodes,n=i.length,r=i[a];a<n;a++,r=i[a])if(r.NodeType==AlphaTab.Xml.XmlNodeType.Element)switch(r.LocalName){case"string":t.String=AlphaTab.Platform.Std.ParseInt(r.get_InnerText()),-2147483648!=t.String&&(t.String=t.Beat.Voice.Bar.Staff.Track.Tuning.length-t.String+1);break;case"fret":t.Fret=AlphaTab.Platform.Std.ParseInt(r.get_InnerText())}-2147483648!=t.String&&-2147483648!=t.Fret||(t.String=-1,t.Fret=-1)},ParseArticulations:function(e,t){for(var a=0,i=e.ChildNodes,n=i.length,r=i[a];a<n;a++,r=i[a])switch(r.LocalName){case"accent":t.Accentuated=AlphaTab.Model.AccentuationType.Normal;break;case"strong-accent":t.Accentuated=AlphaTab.Model.AccentuationType.Heavy;break;case"staccato":case"detached-legato":t.IsStaccato=!0}},ParseDynamics:function(e,t){for(var a=0,i=e.ChildNodes,n=i.length,r=i[a];a<n;a++,r=i[a])if(r.NodeType==AlphaTab.Xml.XmlNodeType.Element)switch(r.LocalName){case"p":t.Dynamic=AlphaTab.Model.DynamicValue.P;break;case"pp":t.Dynamic=AlphaTab.Model.DynamicValue.PP;break;case"ppp":t.Dynamic=AlphaTab.Model.DynamicValue.PPP;break;case"f":t.Dynamic=AlphaTab.Model.DynamicValue.F;break;case"ff":t.Dynamic=AlphaTab.Model.DynamicValue.FF;break;case"fff":t.Dynamic=AlphaTab.Model.DynamicValue.FFF;break;case"mp":t.Dynamic=AlphaTab.Model.DynamicValue.MP;break;case"mf":t.Dynamic=AlphaTab.Model.DynamicValue.MF}},ParseTimeModification:function(e,t){for(var a=0,i=e.ChildNodes,n=i.length,r=i[a];a<n;a++,r=i[a])if(r.NodeType==AlphaTab.Xml.XmlNodeType.Element)switch(r.LocalName){case"actual-notes":t.TupletNumerator=AlphaTab.Platform.Std.ParseInt(r.get_InnerText());break;case"normal-notes":t.TupletDenominator=AlphaTab.Platform.Std.ParseInt(r.get_InnerText())}},ParseUnpitched:function(e,t){for(var a=null,i=0,n=0,r=0,l=e.ChildNodes,s=l.length,o=l[r];r<s;r++,o=l[r])if(o.NodeType==AlphaTab.Xml.XmlNodeType.Element)switch(o.LocalName){case"display-step":a=o.get_InnerText();break;case"display-alter":i=AlphaTab.Platform.Std.ParseInt(o.get_InnerText());break;case"display-octave":n=AlphaTab.Platform.Std.ParseInt(o.get_InnerText())}var h=12*n+AlphaTab.Model.TuningParser.GetToneForText(a)+i;t.Octave=h/12|0,t.Tone=h-12*t.Octave},ParsePitch:function(e,t){for(var a=null,i=0,n=0,r=0,l=e.ChildNodes,s=l.length,o=l[r];r<s;r++,o=l[r])if(o.NodeType==AlphaTab.Xml.XmlNodeType.Element)switch(o.LocalName){case"step":a=o.get_InnerText();break;case"alter":i=AlphaTab.Platform.Std.ParseFloat(o.get_InnerText()),isNaN(i)&&(i=0);break;case"octave":n=AlphaTab.Platform.Std.ParseInt(o.get_InnerText())}var h=12*n+AlphaTab.Model.TuningParser.GetToneForText(a)+i|0;t.Octave=h/12|0,t.Tone=h-12*t.Octave},GetOrCreateVoice:function(e,t){if(t<e.Voices.length)return e.Voices[t];for(var a=e.Voices.length;a<=t;a++)e.AddVoice(new AlphaTab.Model.Voice);return this._maxVoices=Math.max(this._maxVoices,e.Voices.length),e.Voices[t]},ParseDirection:function(e,t){for(var a=0,i=e.ChildNodes,n=i.length,r=i[a];a<n;a++,r=i[a])if(r.NodeType==AlphaTab.Xml.XmlNodeType.Element)switch(r.LocalName){case"sound":var l=r.GetAttribute("tempo");if(null!=l&&0!=l.length){var s=new AlphaTab.Model.Automation;s.IsLinear=!0,s.Type=AlphaTab.Model.AutomationType.Tempo,s.Value=AlphaTab.Platform.Std.ParseInt(l),t.TempoAutomation=s}break;case"direction-type":var o=r.FirstElement;switch(o.LocalName){case"words":t.Section=new AlphaTab.Model.Section,t.Section.Text=o.get_InnerText();break;case"metronome":this.ParseMetronome(r.FirstElement,t)}}},ParseMetronome:function(e,t){for(var a=AlphaTab.Model.Duration.Quarter,i=120,n=0,r=e.ChildNodes,l=r.length,s=r[n];n<l;n++,s=r[n])if(s.NodeType==AlphaTab.Xml.XmlNodeType.Element)switch(s.LocalName){case"beat-unit":a=this.GetDuration(s.get_InnerText());break;case"per-minute":i=AlphaTab.Platform.Std.ParseInt(s.get_InnerText())}var o=t.TempoAutomation=new AlphaTab.Model.Automation;o.Type=AlphaTab.Model.AutomationType.Tempo,o.Value=i*(a/4|0)},ParseAttributes:function(e,t,a){for(var i,n=!1,r=0,l=e.ChildNodes,s=l.length,o=l[r];r<s;r++,o=l[r])if(o.NodeType==AlphaTab.Xml.XmlNodeType.Element)switch(o.LocalName){case"divisions":this._divisionsPerQuarterNote=AlphaTab.Platform.Std.ParseInt(o.get_InnerText());break;case"key":this.ParseKey(o,a);break;case"time":this.ParseTime(o,a),n=!0;break;case"clef":-2147483648==(i=AlphaTab.Platform.Std.ParseInt(o.GetAttribute("number")))&&(i=1),this.ParseClef(o,t[i-1]);break;case"staff-details":-2147483648==(i=AlphaTab.Platform.Std.ParseInt(o.GetAttribute("number")))&&(i=1),this.ParseStaffDetails(o,t[i-1].Staff.Track)}n||(a.TimeSignatureCommon=!0)},ParseClef:function(e,t){for(var a=null,i=0,n=0,r=e.ChildNodes,l=r.length,s=r[n];n<l;n++,s=r[n])if(s.NodeType==AlphaTab.Xml.XmlNodeType.Element)switch(s.LocalName){case"sign":a=s.get_InnerText();break;case"line":i=AlphaTab.Platform.Std.ParseInt(s.get_InnerText());break;case"clef-octave-change":switch(AlphaTab.Platform.Std.ParseInt(s.get_InnerText())){case-2:t.ClefOttavia=AlphaTab.Model.ClefOttavia._15mb;break;case-1:t.ClefOttavia=AlphaTab.Model.ClefOttavia._8vb;break;case 1:t.ClefOttavia=AlphaTab.Model.ClefOttavia._8va;break;case 2:t.ClefOttavia=AlphaTab.Model.ClefOttavia._15mb}}switch(a){case"G":t.Clef=AlphaTab.Model.Clef.G2;break;case"F":t.Clef=AlphaTab.Model.Clef.F4;break;case"C":t.Clef=3==i?AlphaTab.Model.Clef.C3:AlphaTab.Model.Clef.C4;break;case"percussion":t.Clef=AlphaTab.Model.Clef.Neutral;break;default:t.Clef=AlphaTab.Model.Clef.G2}},ParseTime:function(e,t){"common"==e.GetAttribute("symbol")&&(t.TimeSignatureCommon=!0);for(var a=!1,i=!1,n=0,r=e.ChildNodes,l=r.length,s=r[n];n<l;n++,s=r[n])if(s.NodeType==AlphaTab.Xml.XmlNodeType.Element){var o=s.get_InnerText();switch(s.LocalName){case"beats":a||(-1!=!o.indexOf("+")?t.TimeSignatureNumerator=AlphaTab.Platform.Std.ParseInt(o):t.TimeSignatureNumerator=4,a=!0);break;case"beat-type":i||(-1!=!o.indexOf("+")?t.TimeSignatureDenominator=AlphaTab.Platform.Std.ParseInt(o):t.TimeSignatureDenominator=4,i=!0)}}},ParseKey:function(e,t){for(var a=-2147483648,i=null,n=0,r=e.ChildNodes,l=r.length,s=r[n];n<l;n++,s=r[n])if(s.NodeType==AlphaTab.Xml.XmlNodeType.Element)switch(s.LocalName){case"fifths":a=AlphaTab.Platform.Std.ParseInt(s.get_InnerText());break;case"key-step":AlphaTab.Platform.Std.ParseInt(s.get_InnerText());break;case"key-alter":AlphaTab.Platform.Std.ParseInt(s.get_InnerText());break;case"mode":i=s.get_InnerText()}t.KeySignature=-7<=a&&a<=7?a:0,t.KeySignatureType="minor"==i?AlphaTab.Model.KeySignatureType.Minor:AlphaTab.Model.KeySignatureType.Major},GetOrCreateMasterBar:function(e){if(e<this._score.MasterBars.length)return this._score.MasterBars[e];for(var t=this._score.MasterBars.length;t<=e;t++){var a=new AlphaTab.Model.MasterBar;if(this._score.MasterBars.length>0){var i=this._score.MasterBars[this._score.MasterBars.length-1];a.TimeSignatureDenominator=i.TimeSignatureDenominator,a.TimeSignatureNumerator=i.TimeSignatureNumerator,a.KeySignature=i.KeySignature,a.KeySignatureType=i.KeySignatureType}this._score.AddMasterBar(a)}return this._score.MasterBars[e]},ParseIdentification:function(e){for(var t=0,a=e.ChildNodes,i=a.length,n=a[t];t<i;t++,n=a[t])if(n.NodeType==AlphaTab.Xml.XmlNodeType.Element)switch(n.LocalName){case"creator":"composer"==n.GetAttribute("type")&&(this._score.Words=n.get_InnerText());break;case"rights":null!=this._score.Copyright&&0!=this._score.Copyright.length&&(this._score.Copyright+="\n"),this._score.Copyright+=n.get_InnerText()}},ParsePartList:function(e){for(var t=0,a=e.ChildNodes,i=a.length,n=a[t];t<i;t++,n=a[t])if(n.NodeType==AlphaTab.Xml.XmlNodeType.Element)switch(n.LocalName){case"score-part":this.ParseScorePart(n)}},ParseScorePart:function(e){var t=e.GetAttribute("id"),a=new AlphaTab.Model.Track(1);this._trackById[t]=a,this._score.AddTrack(a);for(var i=0,n=e.ChildNodes,r=n.length,l=n[i];i<r;i++,l=n[i])if(l.NodeType==AlphaTab.Xml.XmlNodeType.Element)switch(l.LocalName){case"part-name":a.Name=l.get_InnerText();break;case"part-abbreviation":a.ShortName=l.get_InnerText();break;case"midi-instrument":this.ParseMidiInstrument(l,a)}this.IsEmptyTuning(a.Tuning)&&(a.Tuning=new Int32Array(0))},IsEmptyTuning:function(e){if(null==e)return!0;for(var t=0;t<e.length;t++)if(0!=e[t])return!1;return!0},ParseMidiInstrument:function(e,t){for(var a=0,i=e.ChildNodes,n=i.length,r=i[a];a<n;a++,r=i[a])if(r.NodeType==AlphaTab.Xml.XmlNodeType.Element)switch(r.LocalName){case"midi-channel":t.PlaybackInfo.PrimaryChannel=AlphaTab.Platform.Std.ParseInt(r.get_InnerText());break;case"midi-program":t.PlaybackInfo.Program=AlphaTab.Platform.Std.ParseInt(r.get_InnerText());break;case"midi-volume":t.PlaybackInfo.Volume=AlphaTab.Platform.Std.ParseInt(r.get_InnerText())}}},AlphaTab.Importer.MusicXmlImporter.ParseTied=function(e,t){t.Beat.GraceType==AlphaTab.Model.GraceType.None&&("start"==e.GetAttribute("type")?t.IsTieOrigin=!0:t.IsTieDestination=!0)},$Inherit(AlphaTab.Importer.MusicXmlImporter,AlphaTab.Importer.ScoreImporter),AlphaTab.Importer.NoCompatibleReaderFoundException=function(){AlphaTab.AlphaTabException.call(this,"")},$Inherit(AlphaTab.Importer.NoCompatibleReaderFoundException,AlphaTab.AlphaTabException),AlphaTab.Importer.UnsupportedFormatException=function(e){AlphaTab.AlphaTabException.call(this,e)},$Inherit(AlphaTab.Importer.UnsupportedFormatException,AlphaTab.AlphaTabException),AlphaTab.IO=AlphaTab.IO||{},AlphaTab.IO.BitReader=function(e){this._currentByte=0,this._position=0,this._source=null,this._source=e,this._position=8},AlphaTab.IO.BitReader.prototype={ReadByte:function(){return this.ReadBits(8)},ReadBytes:function(e){for(var t=new Uint8Array(e),a=0;a<e;a++)t[a]=this.ReadByte();return t},ReadBits:function(e){for(var t=0,a=e-1;a>=0;)t|=this.ReadBit()<<a,a--;return t},ReadBitsReversed:function(e){for(var t=0,a=0;a<e;a++)t|=this.ReadBit()<<a;return t},ReadBit:function(){if(this._position>=8){if(this._currentByte=this._source.ReadByte(),-1==this._currentByte)throw $CreateException(new AlphaTab.IO.EndOfReaderException,new Error);this._position=0}var e=this._currentByte>>8-this._position-1&1;return this._position++,e},ReadAll:function(){var e=AlphaTab.IO.ByteBuffer.Empty();try{for(;;)e.WriteByte(this.ReadByte())}catch(e){}return e.ToArray()}},$StaticConstructor(function(){AlphaTab.IO.BitReader.ByteSize=8}),AlphaTab.IO.EndOfReaderException=function(){AlphaTab.AlphaTabException.call(this,"")},$Inherit(AlphaTab.IO.EndOfReaderException,AlphaTab.AlphaTabException),AlphaTab.IO.ByteBuffer=function(){this._buffer=null,this._position=0,this._length=0,this._capacity=0},AlphaTab.IO.ByteBuffer.prototype={get_Length:function(){return this._length},GetBuffer:function(){return this._buffer},Reset:function(){this._position=0},Skip:function(e){this._position+=e},SetCapacity:function(e){if(e!=this._capacity){if(e>0){var t=new Uint8Array(e);this._length>0&&t.set(this._buffer.subarray(0,0+this._length),0),this._buffer=t}else this._buffer=null;this._capacity=e}},ReadByte:function(){return this._length-this._position<=0?-1:this._buffer[this._position++]},Read:function(e,t,a){var i=this._length-this._position;if(i>a&&(i=a),i<=0)return 0;if(i<=8)for(var n=i;--n>=0;)e[t+n]=this._buffer[this._position+n];else e.set(this._buffer.subarray(this._position,this._position+i),t);return this._position+=i,i},WriteByte:function(e){var t=new Uint8Array(1);t[0]=e,this.Write(t,0,1)},Write:function(e,t,a){var i=this._position+a;if(i>this._length&&(i>this._capacity&&this.EnsureCapacity(i),this._length=i),a<=8&&e!=this._buffer)for(var n=a;--n>=0;)this._buffer[this._position+n]=e[t+n];else this._buffer.set(e.subarray(t,t+Math.min(a,e.length-t)),this._position);this._position=i},EnsureCapacity:function(e){if(e>this._capacity){var t=e;t<256&&(t=256),t<2*this._capacity&&(t=2*this._capacity),this.SetCapacity(t)}},ReadAll:function(){return this.ToArray()},ToArray:function(){var e=new Uint8Array(this._length);return e.set(this._buffer.subarray(0,0+this._length),0),e}},AlphaTab.IO.ByteBuffer.Empty=function(){return AlphaTab.IO.ByteBuffer.WithCapactiy(0)},AlphaTab.IO.ByteBuffer.WithCapactiy=function(e){var t=new AlphaTab.IO.ByteBuffer;return t._buffer=new Uint8Array(e),t._capacity=e,t},AlphaTab.IO.ByteBuffer.FromBuffer=function(e){var t=new AlphaTab.IO.ByteBuffer;return t._buffer=e,t._capacity=t._length=e.length,t},AlphaTab.Model.AccentuationType={None:0,Normal:1,Heavy:2},AlphaTab.Model.AccidentalType={None:0,Natural:1,Sharp:2,Flat:3},AlphaTab.Model.Automation=function(){this.IsLinear=!1,this.Type=AlphaTab.Model.AutomationType.Tempo,this.Value=0,this.RatioPosition=0,this.Text=null},AlphaTab.Model.Automation.prototype={Clone:function(){var e=new AlphaTab.Model.Automation;return AlphaTab.Model.Automation.CopyTo(this,e),e}},AlphaTab.Model.Automation.BuildTempoAutomation=function(e,t,a,i){(i<1||i>5)&&(i=2);var n=new Float32Array([1,.5,1,1.5,2,3]),r=new AlphaTab.Model.Automation;return r.Type=AlphaTab.Model.AutomationType.Tempo,r.IsLinear=e,r.RatioPosition=t,r.Value=a*n[i],r},AlphaTab.Model.Automation.CopyTo=function(e,t){t.IsLinear=e.IsLinear,t.RatioPosition=e.RatioPosition,t.Text=e.Text,t.Type=e.Type,t.Value=e.Value},AlphaTab.Model.AutomationType={Tempo:0,Volume:1,Instrument:2,Balance:3},AlphaTab.Model.Bar=function(){this.Id=0,this.Index=0,this.NextBar=null,this.PreviousBar=null,this.Clef=AlphaTab.Model.Clef.Neutral,this.ClefOttavia=AlphaTab.Model.ClefOttavia._15ma,this.Staff=null,this.Voices=null,this.Id=AlphaTab.Model.Bar.GlobalBarId++,this.Voices=[],this.Clef=AlphaTab.Model.Clef.G2,this.ClefOttavia=AlphaTab.Model.ClefOttavia.Regular},AlphaTab.Model.Bar.prototype={AddVoice:function(e){e.Bar=this,e.Index=this.Voices.length,this.Voices.push(e)},get_MasterBar:function(){return this.Staff.Track.Score.MasterBars[this.Index]},get_IsEmpty:function(){for(var e=0,t=this.Voices.length;e<t;e++)if(!this.Voices[e].IsEmpty)return!1;return!0},Finish:function(){for(var e=0,t=this.Voices.length;e<t;e++)this.Voices[e].Finish()}},$StaticConstructor(function(){AlphaTab.Model.Bar.GlobalBarId=0}),AlphaTab.Model.Bar.CopyTo=function(e,t){t.Id=e.Id,t.Index=e.Index,t.Clef=e.Clef,t.ClefOttavia=e.ClefOttavia},AlphaTab.Model.Beat=function(){this._minNote=null,this._maxNote=null,this._maxStringNote=null,this._minStringNote=null,this.PreviousBeat=null,this.NextBeat=null,this.Id=0,this.Index=0,this.Voice=null,this.Notes=null,this.IsEmpty=!1,this.IsLegatoOrigin=!1,this.Duration=AlphaTab.Model.Duration.QuadrupleWhole,this.Automations=null,this.Dots=0,this.FadeIn=!1,this.Lyrics=null,this.Pop=!1,this.HasRasgueado=!1,this.Slap=!1,this.Tap=!1,this.Text=null,this.BrushType=AlphaTab.Model.BrushType.None,this.BrushDuration=0,this.TupletDenominator=0,this.TupletNumerator=0,this.WhammyBarPoints=null,this.MaxWhammyPoint=null,this.Vibrato=AlphaTab.Model.VibratoType.None,this.ChordId=null,this.GraceType=AlphaTab.Model.GraceType.None,this.PickStroke=AlphaTab.Model.PickStrokeType.None,this.TremoloSpeed=null,this.Crescendo=AlphaTab.Model.CrescendoType.None,this.Start=0,this.Dynamic=AlphaTab.Model.DynamicValue.PPP,this.InvertBeamDirection=!1,this.Id=AlphaTab.Model.Beat.GlobalBeatId++,this.WhammyBarPoints=[],this.Notes=[],this.BrushType=AlphaTab.Model.BrushType.None,this.Vibrato=AlphaTab.Model.VibratoType.None,this.GraceType=AlphaTab.Model.GraceType.None,this.PickStroke=AlphaTab.Model.PickStrokeType.None,this.Duration=AlphaTab.Model.Duration.Quarter,this.TremoloSpeed=null,this.Automations=[],this.Dots=0,this.Start=0,this.TupletDenominator=-1,this.TupletNumerator=-1,this.Dynamic=AlphaTab.Model.DynamicValue.F,this.Crescendo=AlphaTab.Model.CrescendoType.None,this.InvertBeamDirection=!1},AlphaTab.Model.Beat.prototype={get_IsLegatoDestination:function(){return null!=this.PreviousBeat&&this.PreviousBeat.IsLegatoOrigin},get_MinNote:function(){return null==this._minNote&&this.RefreshNotes(),this._minNote},get_MaxNote:function(){return null==this._maxNote&&this.RefreshNotes(),this._maxNote},get_MaxStringNote:function(){return null==this._maxStringNote&&this.RefreshNotes(),this._maxStringNote},get_MinStringNote:function(){return null==this._minStringNote&&this.RefreshNotes(),this._minStringNote},get_IsRest:function(){return 0==this.Notes.length},get_HasTuplet:function(){return!(-1==this.TupletDenominator&&-1==this.TupletNumerator||1==this.TupletDenominator&&1==this.TupletNumerator)},get_HasWhammyBar:function(){return this.WhammyBarPoints.length>0},get_HasChord:function(){return null!=this.ChordId},get_Chord:function(){return this.Voice.Bar.Staff.Track.Chords[this.ChordId]},get_IsTremolo:function(){return null!=this.TremoloSpeed},get_AbsoluteStart:function(){return this.Voice.Bar.get_MasterBar().Start+this.Start},Clone:function(){for(var e=new AlphaTab.Model.Beat,t=e.Id,a=0,i=this.WhammyBarPoints.length;a<i;a++)e.AddWhammyBarPoint(this.WhammyBarPoints[a].Clone());for(var a=0,i=this.Notes.length;a<i;a++)e.AddNote(this.Notes[a].Clone());AlphaTab.Model.Beat.CopyTo(this,e);for(var a=0,i=this.Automations.length;a<i;a++)e.Automations.push(this.Automations[a].Clone());return e.Id=t,e},AddWhammyBarPoint:function(e){this.WhammyBarPoints.push(e),(null==this.MaxWhammyPoint||e.Value>this.MaxWhammyPoint.Value)&&(this.MaxWhammyPoint=e)},RemoveWhammyBarPoint:function(e){if(!(e<0||e>=this.WhammyBarPoints.length)&&(this.WhammyBarPoints.splice(e,1),this.WhammyBarPoints[e]==this.MaxWhammyPoint)){this.MaxWhammyPoint=null;for(var t=0,a=this.WhammyBarPoints,i=a.length,n=a[t];t<i;t++,n=a[t])(null==this.MaxWhammyPoint||n.Value>this.MaxWhammyPoint.Value)&&(this.MaxWhammyPoint=n)}},CalculateDuration:function(){var e=AlphaTab.Audio.MidiUtils.ToTicks(this.Duration);return 2==this.Dots?e=AlphaTab.Audio.MidiUtils.ApplyDot(e,!0):1==this.Dots&&(e=AlphaTab.Audio.MidiUtils.ApplyDot(e,!1)),this.TupletDenominator>0&&this.TupletNumerator>=0&&(e=AlphaTab.Audio.MidiUtils.ApplyTuplet(e,this.TupletNumerator,this.TupletDenominator)),e},AddNote:function(e){e.Beat=this,e.Index=this.Notes.length,this.Notes.push(e)},RemoveNote:function(e){var t=this.Notes.indexOf(e);t>=0&&this.Notes.splice(t,1),e!=this._minNote&&e!=this._maxNote&&e!=this._minStringNote&&e!=this._maxStringNote||this.RefreshNotes()},RefreshNotes:function(){for(var e=0,t=this.Notes.length;e<t;e++){var a=this.Notes[e];(null==this._minNote||a.get_RealValue()<this._minNote.get_RealValue())&&(this._minNote=a),(null==this._maxNote||a.get_RealValue()>this._maxNote.get_RealValue())&&(this._maxNote=a),(null==this._minStringNote||a.String<this._minStringNote.String)&&(this._minStringNote=a),(null==this._maxStringNote||a.String>this._maxStringNote.String)&&(this._maxStringNote=a)}},GetAutomation:function(e){for(var t=0,a=this.Automations.length;t<a;t++){var i=this.Automations[t];if(i.Type==e)return i}return null},GetNoteOnString:function(e){for(var t=0,a=this.Notes.length;t<a;t++){var i=this.Notes[t];if(i.String==e)return i}return null},Finish:function(){0==this.Index?this.Start=0:this.Start=this.PreviousBeat.Start+this.PreviousBeat.CalculateDuration();for(var e=0,t=this.Notes.length;e<t;e++)this.Notes[e].Finish()}},$StaticConstructor(function(){AlphaTab.Model.Beat.WhammyBarMaxPosition=60,AlphaTab.Model.Beat.WhammyBarMaxValue=24,AlphaTab.Model.Beat.GlobalBeatId=0}),AlphaTab.Model.Beat.CopyTo=function(e,t){if(t.Id=e.Id,t.Index=e.Index,t.IsEmpty=e.IsEmpty,t.Duration=e.Duration,t.Dots=e.Dots,t.FadeIn=e.FadeIn,null!=e.Lyrics){t.Lyrics=new Array(e.Lyrics.length);for(var a=0;a<e.Lyrics.length;a++)t.Lyrics[a]=e.Lyrics[a]}t.Pop=e.Pop,t.HasRasgueado=e.HasRasgueado,t.Slap=e.Slap,t.Tap=e.Tap,t.Text=e.Text,t.BrushType=e.BrushType,t.BrushDuration=e.BrushDuration,t.TupletDenominator=e.TupletDenominator,t.TupletNumerator=e.TupletNumerator,t.Vibrato=e.Vibrato,t.ChordId=e.ChordId,t.GraceType=e.GraceType,t.PickStroke=e.PickStroke,t.TremoloSpeed=e.TremoloSpeed,t.Crescendo=e.Crescendo,t.Start=e.Start,t.Dynamic=e.Dynamic,t.IsLegatoOrigin=e.IsLegatoOrigin,t.InvertBeamDirection=e.InvertBeamDirection},AlphaTab.Model.BendPoint=function(e,t){this.Offset=0,this.Value=0,this.Offset=e,this.Value=t},AlphaTab.Model.BendPoint.prototype={Clone:function(){var e=new AlphaTab.Model.BendPoint(0,0);return AlphaTab.Model.BendPoint.CopyTo(this,e),e}},$StaticConstructor(function(){AlphaTab.Model.BendPoint.MaxPosition=60,AlphaTab.Model.BendPoint.MaxValue=12}),AlphaTab.Model.BendPoint.CopyTo=function(e,t){t.Offset=e.Offset,t.Value=e.Value},AlphaTab.Model.BrushType={None:0,BrushUp:1,BrushDown:2,ArpeggioUp:3,ArpeggioDown:4},AlphaTab.Model.Chord=function(){this.Name=null,this.FirstFret=0,this.Strings=null,this.BarreFrets=null,this.Strings=[],this.BarreFrets=[]},AlphaTab.Model.Chord.CopyTo=function(e,t){t.FirstFret=e.FirstFret,t.Name=e.Name,t.Strings=e.Strings.slice()},AlphaTab.Model.Clef={Neutral:0,C3:1,C4:2,F4:3,G2:4},AlphaTab.Model.ClefOttavia={_15ma:0,_8va:1,Regular:2,_8vb:3,_15mb:4},AlphaTab.Model.CrescendoType={None:0,Crescendo:1,Decrescendo:2},AlphaTab.Model.Duration={QuadrupleWhole:-4,DoubleWhole:-2,Whole:1,Half:2,Quarter:4,Eighth:8,Sixteenth:16,ThirtySecond:32,SixtyFourth:64,OneHundredTwentyEighth:128,TwoHundredFiftySixth:256},AlphaTab.Model.DynamicValue={PPP:0,PP:1,P:2,MP:3,MF:4,F:5,FF:6,FFF:7},AlphaTab.Model.Fingers={Unknown:-2,NoOrDead:-1,Thumb:0,IndexFinger:1,MiddleFinger:2,AnnularFinger:3,LittleFinger:4},AlphaTab.Model.GraceType={None:0,OnBeat:1,BeforeBeat:2},AlphaTab.Model.HarmonicType={None:0,Natural:1,Artificial:2,Pinch:3,Tap:4,Semi:5,Feedback:6},AlphaTab.Model.KeySignatureType={Major:0,Minor:1},AlphaTab.Model.Lyrics=function(){this.StartBar=0,this.Text=null,this.Chunks=null},AlphaTab.Model.Lyrics.prototype={Finish:function(){var e=[];this.Parse(this.Text,0,e),this.Chunks=e.slice(0)},Parse:function(e,t,a){if(null!=e&&0!=e.length){for(var i=1,n=1,r=!1,l=0;t<e.length;){var s=e.charCodeAt(t);switch(i){case 0:switch(s){case 10:case 13:case 9:break;case 32:if(!r){i=n;continue}break;default:r=!1,i=n;continue}break;case 1:switch(s){case 91:i=3;break;default:l=t,i=2;continue}break;case 3:switch(s){case 93:i=1}break;case 2:switch(s){case 45:i=4;break;case 13:case 10:case 32:o=e.substr(l,t-l);a.push(this.PrepareChunk(o)),i=0,n=1}break;case 4:switch(s){case 45:break;default:var o=e.substr(l,t-l);a.push(this.PrepareChunk(o)),r=!0,i=0,n=1;continue}}t++}2==i&&t!=l&&a.push(e.substr(l,t-l))}},PrepareChunk:function(e){return e.replace("+"," ")}},$StaticConstructor(function(){AlphaTab.Model.Lyrics.CharCodeLF="\n",AlphaTab.Model.Lyrics.CharCodeTab="\t",AlphaTab.Model.Lyrics.CharCodeCR="\r",AlphaTab.Model.Lyrics.CharCodeSpace=" ",AlphaTab.Model.Lyrics.CharCodeBrackedClose="]",AlphaTab.Model.Lyrics.CharCodeBrackedOpen="[",AlphaTab.Model.Lyrics.CharCodeDash="-"}),AlphaTab.Model.MasterBar=function(){this.AlternateEndings=0,this.NextMasterBar=null,this.PreviousMasterBar=null,this.Index=0,this.KeySignature=0,this.KeySignatureType=AlphaTab.Model.KeySignatureType.Major,this.IsDoubleBar=!1,this.IsRepeatStart=!1,this.RepeatCount=0,this.RepeatGroup=null,this.TimeSignatureNumerator=0,this.TimeSignatureDenominator=0,this.TimeSignatureCommon=!1,this.TripletFeel=AlphaTab.Model.TripletFeel.NoTripletFeel,this.Section=null,this.TempoAutomation=null,this.VolumeAutomation=null,this.Score=null,this.Start=0,this.TimeSignatureDenominator=4,this.TimeSignatureNumerator=4,this.TripletFeel=AlphaTab.Model.TripletFeel.NoTripletFeel,this.KeySignatureType=AlphaTab.Model.KeySignatureType.Major,this.TimeSignatureCommon=!1},AlphaTab.Model.MasterBar.prototype={get_IsRepeatEnd:function(){return this.RepeatCount>0},get_IsSectionStart:function(){return null!=this.Section},CalculateDuration:function(){return this.TimeSignatureNumerator*AlphaTab.Audio.MidiUtils.ValueToTicks(this.TimeSignatureDenominator)}},$StaticConstructor(function(){AlphaTab.Model.MasterBar.MaxAlternateEndings=8}),AlphaTab.Model.MasterBar.CopyTo=function(e,t){t.AlternateEndings=e.AlternateEndings,t.Index=e.Index,t.KeySignature=e.KeySignature,t.KeySignatureType=e.KeySignatureType,t.IsDoubleBar=e.IsDoubleBar,t.IsRepeatStart=e.IsRepeatStart,t.RepeatCount=e.RepeatCount,t.TimeSignatureNumerator=e.TimeSignatureNumerator,t.TimeSignatureDenominator=e.TimeSignatureDenominator,t.TimeSignatureCommon=e.TimeSignatureCommon,t.TripletFeel=e.TripletFeel,t.Start=e.Start},AlphaTab.Model.ModelUtils=function(){},AlphaTab.Model.ModelUtils.GetIndex=function(e){return e<0?0:0|Math.log2(e)},AlphaTab.Model.ModelUtils.KeySignatureIsFlat=function(e){return e<0},AlphaTab.Model.ModelUtils.KeySignatureIsNatural=function(e){return 0==e},AlphaTab.Model.ModelUtils.KeySignatureIsSharp=function(e){return e>0},AlphaTab.Model.ModelUtils.ApplyPitchOffsets=function(e,t){for(var a=0;a<t.Tracks.length;a++)a<e.DisplayTranspositionPitches.length&&(t.Tracks[a].DisplayTranspositionPitch=-e.DisplayTranspositionPitches[a]),a<e.TranspositionPitches.length&&(t.Tracks[a].TranspositionPitch=-e.TranspositionPitches[a])},AlphaTab.Model.NoteAccidentalMode={Default:0,SwapAccidentals:1,ForceNatural:2,ForceSharp:3,ForceFlat:4},AlphaTab.Model.Note=function(){this.Id=0,this.Index=0,this.Accentuated=AlphaTab.Model.AccentuationType.None,this.BendPoints=null,this.MaxBendPoint=null,this.Fret=0,this.String=0,this.Octave=0,this.Tone=0,this.Element=0,this.Variation=0,this.IsHammerPullOrigin=!1,this.HammerPullOrigin=null,this.HammerPullDestination=null,this.HarmonicValue=0,this.HarmonicType=AlphaTab.Model.HarmonicType.None,this.IsGhost=!1,this.IsLetRing=!1,this.IsPalmMute=!1,this.IsDead=!1,this.IsStaccato=!1,this.SlideType=AlphaTab.Model.SlideType.None,this.SlideTarget=null,this.Vibrato=AlphaTab.Model.VibratoType.None,this.TieOrigin=null,this.TieDestination=null,this.IsTieDestination=!1,this.IsTieOrigin=!1,this.LeftHandFinger=AlphaTab.Model.Fingers.Thumb,this.RightHandFinger=AlphaTab.Model.Fingers.Thumb,this.IsFingering=!1,this.TrillValue=0,this.TrillSpeed=AlphaTab.Model.Duration.QuadrupleWhole,this.DurationPercent=0,this.AccidentalMode=AlphaTab.Model.NoteAccidentalMode.Default,this.Beat=null,this.Dynamic=AlphaTab.Model.DynamicValue.PPP,this.Id=AlphaTab.Model.Note.GlobalNoteId++,this.BendPoints=[],this.Dynamic=AlphaTab.Model.DynamicValue.F,this.Accentuated=AlphaTab.Model.AccentuationType.None,this.Fret=-2147483648,this.HarmonicType=AlphaTab.Model.HarmonicType.None,this.SlideType=AlphaTab.Model.SlideType.None,this.Vibrato=AlphaTab.Model.VibratoType.None,this.LeftHandFinger=AlphaTab.Model.Fingers.Unknown,this.RightHandFinger=AlphaTab.Model.Fingers.Unknown,this.TrillValue=-1,this.TrillSpeed=AlphaTab.Model.Duration.ThirtySecond,this.DurationPercent=1,this.Octave=-1,this.Tone=-1,this.Fret=-1,this.String=-1,this.Element=-1,this.Variation=-1},AlphaTab.Model.Note.prototype={get_HasBend:function(){return this.BendPoints.length>0},get_IsStringed:function(){return this.Fret>=0&&this.String>=0},get_IsPiano:function(){return!this.get_IsStringed()&&(this.Octave>=0&&this.Tone>=0)},get_IsPercussion:function(){return!this.get_IsStringed()&&(this.Element>=0&&this.Variation>=0)},get_IsHammerPullDestination:function(){return null!=this.HammerPullOrigin},get_IsHarmonic:function(){return this.HarmonicType!=AlphaTab.Model.HarmonicType.None},get_TrillFret:function(){return this.TrillValue-this.get_StringTuning()},get_IsTrill:function(){return this.TrillValue>=0},get_StringTuning:function(){return this.Beat.Voice.Bar.Staff.Track.Capo+AlphaTab.Model.Note.GetStringTuning(this.Beat.Voice.Bar.Staff.Track,this.String)},get_RealValue:function(){return this.get_IsPercussion()?AlphaTab.Rendering.Utils.PercussionMapper.MidiFromElementVariation(this):this.get_IsStringed()?this.Fret+this.get_StringTuning()-this.Beat.Voice.Bar.Staff.Track.TranspositionPitch:this.get_IsPiano()?12*this.Octave+this.Tone-this.Beat.Voice.Bar.Staff.Track.TranspositionPitch:0},Clone:function(){var e=new AlphaTab.Model.Note;AlphaTab.Model.Note.CopyTo(this,e);for(var t=0,a=this.BendPoints.length;t<a;t++)e.AddBendPoint(this.BendPoints[t].Clone());return e},AddBendPoint:function(e){this.BendPoints.push(e),(null==this.MaxBendPoint||e.Value>this.MaxBendPoint.Value)&&(this.MaxBendPoint=e)},Finish:function(){var e=new AlphaTab.Util.Lazy($CreateAnonymousDelegate(this,function(){return AlphaTab.Model.Note.NextNoteOnSameLine(this)})),t=new AlphaTab.Util.Lazy($CreateAnonymousDelegate(this,function(){return AlphaTab.Model.Note.PreviousNoteOnSameLine(this)}));this.IsTieDestination&&(null==t.get_Value()?this.IsTieDestination=!1:(this.TieOrigin=t.get_Value(),this.TieOrigin.IsTieOrigin=!0,this.TieOrigin.TieDestination=this,this.Fret=this.TieOrigin.Fret,this.Octave=this.TieOrigin.Octave,this.Tone=this.TieOrigin.Tone)),this.IsHammerPullOrigin&&(null==e.get_Value()?this.IsHammerPullOrigin=!1:(this.HammerPullDestination=e.get_Value(),this.HammerPullDestination.HammerPullOrigin=this)),this.SlideType!=AlphaTab.Model.SlideType.None&&(this.SlideTarget=e.get_Value())}},$StaticConstructor(function(){AlphaTab.Model.Note.GlobalNoteId=0,AlphaTab.Model.Note.MaxOffsetForSameLineSearch=3}),AlphaTab.Model.Note.GetStringTuning=function(e,t){return e.Tuning.length>0?e.Tuning[e.Tuning.length-(t-1)-1]:0},AlphaTab.Model.Note.CopyTo=function(e,t){t.Id=e.Id,t.Accentuated=e.Accentuated,t.Fret=e.Fret,t.String=e.String,t.IsHammerPullOrigin=e.IsHammerPullOrigin,t.HarmonicValue=e.HarmonicValue,t.HarmonicType=e.HarmonicType,t.IsGhost=e.IsGhost,t.IsLetRing=e.IsLetRing,t.IsPalmMute=e.IsPalmMute,t.IsDead=e.IsDead,t.IsStaccato=e.IsStaccato,t.SlideType=e.SlideType,t.Vibrato=e.Vibrato,t.IsTieDestination=e.IsTieDestination,t.LeftHandFinger=e.LeftHandFinger,t.RightHandFinger=e.RightHandFinger,t.IsFingering=e.IsFingering,t.TrillValue=e.TrillValue,t.TrillSpeed=e.TrillSpeed,t.DurationPercent=e.DurationPercent,t.AccidentalMode=e.AccidentalMode,t.Dynamic=e.Dynamic,t.Octave=e.Octave,t.Tone=e.Tone,t.Element=e.Element,t.Variation=e.Variation},AlphaTab.Model.Note.NextNoteOnSameLine=function(e){for(var t=e.Beat.NextBeat;null!=t&&t.Voice.Bar.Index<=e.Beat.Voice.Bar.Index+3;){var a=t.GetNoteOnString(e.String);if(null!=a)return a;t=t.NextBeat}return null},AlphaTab.Model.Note.PreviousNoteOnSameLine=function(e){for(var t=e.Beat.PreviousBeat;null!=t&&t.Voice.Bar.Index>=e.Beat.Voice.Bar.Index-3;){var a=t.GetNoteOnString(e.String);if(null!=a)return a;t=t.PreviousBeat}return null},AlphaTab.Model.PickStrokeType={None:0,Up:1,Down:2},AlphaTab.Model.PlaybackInformation=function(){this.Volume=0,this.Balance=0,this.Port=0,this.Program=0,this.PrimaryChannel=0,this.SecondaryChannel=0,this.IsMute=!1,this.IsSolo=!1,this.Volume=15,this.Balance=8,this.Port=1},AlphaTab.Model.PlaybackInformation.CopyTo=function(e,t){t.Volume=e.Volume,t.Balance=e.Balance,t.Port=e.Port,t.Program=e.Program,t.PrimaryChannel=e.PrimaryChannel,t.SecondaryChannel=e.SecondaryChannel,t.IsMute=e.IsMute,t.IsSolo=e.IsSolo},AlphaTab.Model.RepeatGroup=function(){this.MasterBars=null,this.Openings=null,this.Closings=null,this.IsClosed=!1,this.MasterBars=[],this.Openings=[],this.Closings=[],this.IsClosed=!1},AlphaTab.Model.RepeatGroup.prototype={AddMasterBar:function(e){0==this.Openings.length&&this.Openings.push(e),this.MasterBars.push(e),e.RepeatGroup=this,e.get_IsRepeatEnd()?(this.Closings.push(e),this.IsClosed=!0):this.IsClosed&&(this.IsClosed=!1,this.Openings.push(e))}},AlphaTab.Model.Score=function(){this._currentRepeatGroup=null,this.Album=null,this.Artist=null,this.Copyright=null,this.Instructions=null,this.Music=null,this.Notices=null,this.SubTitle=null,this.Title=null,this.Words=null,this.Tab=null,this.Tempo=0,this.TempoLabel=null,this.MasterBars=null,this.Tracks=null,this.MasterBars=[],this.Tracks=[],this._currentRepeatGroup=new AlphaTab.Model.RepeatGroup,this.Album=this.Artist=this.Copyright=this.Instructions=this.Music=this.Notices=this.SubTitle=this.Title=this.Words=this.Tab=this.TempoLabel="",this.Tempo=120},AlphaTab.Model.Score.prototype={AddMasterBar:function(e){e.Score=this,e.Index=this.MasterBars.length,0!=this.MasterBars.length&&(e.PreviousMasterBar=this.MasterBars[this.MasterBars.length-1],e.PreviousMasterBar.NextMasterBar=e,e.Start=e.PreviousMasterBar.Start+e.PreviousMasterBar.CalculateDuration()),(e.IsRepeatStart||this._currentRepeatGroup.IsClosed&&e.AlternateEndings<=0)&&(this._currentRepeatGroup=new AlphaTab.Model.RepeatGroup),this._currentRepeatGroup.AddMasterBar(e),this.MasterBars.push(e)},AddTrack:function(e){e.Score=this,e.Index=this.Tracks.length,this.Tracks.push(e)},Finish:function(){for(var e=0,t=this.Tracks.length;e<t;e++)this.Tracks[e].Finish()}},AlphaTab.Model.Score.CopyTo=function(e,t){t.Album=e.Album,t.Artist=e.Artist,t.Copyright=e.Copyright,t.Instructions=e.Instructions,t.Music=e.Music,t.Notices=e.Notices,t.SubTitle=e.SubTitle,t.Title=e.Title,t.Words=e.Words,t.Tab=e.Tab,t.Tempo=e.Tempo,t.TempoLabel=e.TempoLabel},AlphaTab.Model.Section=function(){this.Marker=null,this.Text=null,this.Text=this.Marker=""},AlphaTab.Model.Section.CopyTo=function(e,t){t.Marker=e.Marker,t.Text=e.Text},AlphaTab.Model.SlideType={None:0,Shift:1,Legato:2,IntoFromBelow:3,IntoFromAbove:4,OutUp:5,OutDown:6},AlphaTab.Model.Staff=function(){this.Bars=null,this.Track=null,this.Index=0,this.Bars=[]},AlphaTab.Model.Staff.prototype={Finish:function(){for(var e=0,t=this.Bars.length;e<t;e++)this.Bars[e].Finish()}},AlphaTab.Model.Track=function(e){this.Capo=0,this.TranspositionPitch=0,this.DisplayTranspositionPitch=0,this.Index=0,this.Name=null,this.ShortName=null,this.Tuning=null,this.TuningName=null,this.Color=null,this.PlaybackInfo=null,this.IsPercussion=!1,this.Score=null,this.Staves=null,this.Chords=null,this.Name="",this.ShortName="",this.Tuning=new Int32Array(0),this.Chords={},this.PlaybackInfo=new AlphaTab.Model.PlaybackInformation,this.Color=new AlphaTab.Platform.Model.Color(200,0,0,255),this.Staves=[],this.EnsureStaveCount(e)},AlphaTab.Model.Track.prototype={get_IsStringed:function(){return this.Tuning.length>0},EnsureStaveCount:function(e){for(;this.Staves.length<e;){var t=new AlphaTab.Model.Staff;t.Index=this.Staves.length,t.Track=this,this.Staves.push(t)}},AddBarToStaff:function(e,t){var a=this.Staves[e],i=a.Bars;t.Staff=a,t.Index=i.length,i.length>0&&(t.PreviousBar=i[i.length-1],t.PreviousBar.NextBar=t),i.push(t)},Finish:function(){null!=this.ShortName&&0!=this.ShortName.length||(this.ShortName=this.Name,this.ShortName.length>10&&(this.ShortName=this.ShortName.substr(0,10)));for(var e=0,t=this.Staves.length;e<t;e++)this.Staves[e].Finish()},ApplyLyrics:function(e){for(var t=0,a=e.length,i=e[t];t<a;t++,i=e[t])i.Finish();for(var n=this.Staves[0],r=0;r<e.length;r++)if((i=e[r]).StartBar>=0)for(var l=n.Bars[i.StartBar].Voices[0].Beats[0],s=0;s<i.Chunks.length&&null!=l;s++){for(;null!=l&&(l.IsEmpty||l.get_IsRest());)l=l.NextBeat;null!=l&&(null==l.Lyrics&&(l.Lyrics=new Array(e.length)),l.Lyrics[r]=i.Chunks[s],l=l.NextBeat)}}},$StaticConstructor(function(){AlphaTab.Model.Track.ShortNameMaxLength=10}),AlphaTab.Model.Track.CopyTo=function(e,t){t.Name=e.Name,t.Capo=e.Capo,t.Index=e.Index,t.ShortName=e.ShortName,t.Tuning=new Int32Array(e.Tuning),t.Color.Raw=e.Color.Raw,t.Color.RGBA=e.Color.RGBA,t.IsPercussion=e.IsPercussion,t.TranspositionPitch=e.TranspositionPitch,t.DisplayTranspositionPitch=e.DisplayTranspositionPitch},AlphaTab.Model.TripletFeel={NoTripletFeel:0,Triplet16th:1,Triplet8th:2,Dotted16th:3,Dotted8th:4,Scottish16th:5,Scottish8th:6},AlphaTab.Model.Tuning=function(e,t,a){this.IsStandard=!1,this.Name=null,this.Tunings=null,this.IsStandard=a,this.Name=e,this.Tunings=t},AlphaTab.Model.Tuning.GetTextForTuning=function(e,t){var a=e/12|0,i=["C","Db","D","Eb","E","F","Gb","G","Ab","A","Bb","B"][e%12];return t&&(i+=a-1),i},AlphaTab.Model.Tuning.GetDefaultTuningFor=function(e){return AlphaTab.Model.Tuning._defaultTunings.hasOwnProperty(e)?AlphaTab.Model.Tuning._defaultTunings[e]:null},AlphaTab.Model.Tuning.GetPresetsFor=function(e){switch(e){case 7:return AlphaTab.Model.Tuning._sevenStrings;case 6:return AlphaTab.Model.Tuning._sixStrings;case 5:return AlphaTab.Model.Tuning._fiveStrings;case 4:return AlphaTab.Model.Tuning._fourStrings}return[]},$StaticConstructor(function(){AlphaTab.Model.Tuning._sevenStrings=null,AlphaTab.Model.Tuning._sixStrings=null,AlphaTab.Model.Tuning._fiveStrings=null,AlphaTab.Model.Tuning._fourStrings=null,AlphaTab.Model.Tuning._defaultTunings=null,AlphaTab.Model.Tuning.Initialize()}),AlphaTab.Model.Tuning.Initialize=function(){AlphaTab.Model.Tuning._sevenStrings=[],AlphaTab.Model.Tuning._sixStrings=[],AlphaTab.Model.Tuning._fiveStrings=[],AlphaTab.Model.Tuning._fourStrings=[],AlphaTab.Model.Tuning._defaultTunings={},AlphaTab.Model.Tuning._defaultTunings[7]=new AlphaTab.Model.Tuning("Guitar 7 strings",new Int32Array([64,59,55,50,45,40,35]),!0),AlphaTab.Model.Tuning._sevenStrings.push(AlphaTab.Model.Tuning._defaultTunings[7]),AlphaTab.Model.Tuning._defaultTunings[6]=new AlphaTab.Model.Tuning("Guitar Standard Tuning",new Int32Array([64,59,55,50,45,40]),!0),AlphaTab.Model.Tuning._sixStrings.push(AlphaTab.Model.Tuning._defaultTunings[6]),AlphaTab.Model.Tuning._sixStrings.push(new AlphaTab.Model.Tuning("Guitar Tune down  step",new Int32Array([63,58,54,49,44,39]),!1)),AlphaTab.Model.Tuning._sixStrings.push(new AlphaTab.Model.Tuning("Guitar Tune down 1 step",new Int32Array([62,57,53,48,43,38]),!1)),AlphaTab.Model.Tuning._sixStrings.push(new AlphaTab.Model.Tuning("Guitar Tune down 2 step",new Int32Array([60,55,51,46,41,36]),!1)),AlphaTab.Model.Tuning._sixStrings.push(new AlphaTab.Model.Tuning("Guitar Dropped D Tuning",new Int32Array([64,59,55,50,45,38]),!1)),AlphaTab.Model.Tuning._sixStrings.push(new AlphaTab.Model.Tuning("Guitar Dropped D Tuning variant",new Int32Array([64,57,55,50,45,38]),!1)),AlphaTab.Model.Tuning._sixStrings.push(new AlphaTab.Model.Tuning("Guitar Double Dropped D Tuning",new Int32Array([62,59,55,50,45,38]),!1)),AlphaTab.Model.Tuning._sixStrings.push(new AlphaTab.Model.Tuning("Guitar Dropped E Tuning",new Int32Array([66,61,57,52,47,40]),!1)),AlphaTab.Model.Tuning._sixStrings.push(new AlphaTab.Model.Tuning("Guitar Dropped C Tuning",new Int32Array([62,57,53,48,43,36]),!1)),AlphaTab.Model.Tuning._sixStrings.push(new AlphaTab.Model.Tuning("Guitar Open C Tuning",new Int32Array([64,60,55,48,43,36]),!1)),AlphaTab.Model.Tuning._sixStrings.push(new AlphaTab.Model.Tuning("Guitar Open Cm Tuning",new Int32Array([63,60,55,48,43,36]),!1)),AlphaTab.Model.Tuning._sixStrings.push(new AlphaTab.Model.Tuning("Guitar Open C6 Tuning",new Int32Array([64,57,55,48,43,36]),!1)),AlphaTab.Model.Tuning._sixStrings.push(new AlphaTab.Model.Tuning("Guitar Open Cmaj7 Tuning",new Int32Array([64,59,55,52,43,36]),!1)),AlphaTab.Model.Tuning._sixStrings.push(new AlphaTab.Model.Tuning("Guitar Open D Tuning",new Int32Array([62,57,54,50,45,38]),!1)),AlphaTab.Model.Tuning._sixStrings.push(new AlphaTab.Model.Tuning("Guitar Open Dm Tuning",new Int32Array([62,57,53,50,45,38]),!1)),AlphaTab.Model.Tuning._sixStrings.push(new AlphaTab.Model.Tuning("Guitar Open D5 Tuning",new Int32Array([62,57,50,50,45,38]),!1)),AlphaTab.Model.Tuning._sixStrings.push(new AlphaTab.Model.Tuning("Guitar Open D6 Tuning",new Int32Array([62,59,54,50,45,38]),!1)),AlphaTab.Model.Tuning._sixStrings.push(new AlphaTab.Model.Tuning("Guitar Open Dsus4 Tuning",new Int32Array([62,57,55,50,45,38]),!1)),AlphaTab.Model.Tuning._sixStrings.push(new AlphaTab.Model.Tuning("Guitar Open E Tuning",new Int32Array([64,59,56,52,47,40]),!1)),AlphaTab.Model.Tuning._sixStrings.push(new AlphaTab.Model.Tuning("Guitar Open Em Tuning",new Int32Array([64,59,55,52,47,40]),!1)),AlphaTab.Model.Tuning._sixStrings.push(new AlphaTab.Model.Tuning("Guitar Open Esus11 Tuning",new Int32Array([64,59,55,52,45,40]),!1)),AlphaTab.Model.Tuning._sixStrings.push(new AlphaTab.Model.Tuning("Guitar Open F Tuning",new Int32Array([65,60,53,48,45,41]),!1)),AlphaTab.Model.Tuning._sixStrings.push(new AlphaTab.Model.Tuning("Guitar Open G Tuning",new Int32Array([62,59,55,50,43,38]),!1)),AlphaTab.Model.Tuning._sixStrings.push(new AlphaTab.Model.Tuning("Guitar Open Gm Tuning",new Int32Array([62,58,55,50,43,38]),!1)),AlphaTab.Model.Tuning._sixStrings.push(new AlphaTab.Model.Tuning("Guitar Open G6 Tuning",new Int32Array([64,59,55,50,43,38]),!1)),AlphaTab.Model.Tuning._sixStrings.push(new AlphaTab.Model.Tuning("Guitar Open Gsus4 Tuning",new Int32Array([62,60,55,50,43,38]),!1)),AlphaTab.Model.Tuning._sixStrings.push(new AlphaTab.Model.Tuning("Guitar Open A Tuning",new Int32Array([64,61,57,52,45,40]),!1)),AlphaTab.Model.Tuning._sixStrings.push(new AlphaTab.Model.Tuning("Guitar Open Am Tuning",new Int32Array([64,60,57,52,45,40]),!1)),AlphaTab.Model.Tuning._sixStrings.push(new AlphaTab.Model.Tuning("Guitar Nashville Tuning",new Int32Array([64,59,67,62,57,52]),!1)),AlphaTab.Model.Tuning._sixStrings.push(new AlphaTab.Model.Tuning("Bass 6 Strings Tuning",new Int32Array([48,43,38,33,28,23]),!1)),AlphaTab.Model.Tuning._sixStrings.push(new AlphaTab.Model.Tuning("Lute or Vihuela Tuning",new Int32Array([64,59,54,50,45,40]),!1)),AlphaTab.Model.Tuning._defaultTunings[5]=new AlphaTab.Model.Tuning("Bass 5 Strings Tuning",new Int32Array([43,38,33,28,23]),!0),AlphaTab.Model.Tuning._fiveStrings.push(AlphaTab.Model.Tuning._defaultTunings[5]),AlphaTab.Model.Tuning._fiveStrings.push(new AlphaTab.Model.Tuning("Banjo Dropped C Tuning",new Int32Array([62,59,55,48,67]),!1)),AlphaTab.Model.Tuning._fiveStrings.push(new AlphaTab.Model.Tuning("Banjo Open D Tuning",new Int32Array([62,57,54,50,69]),!1)),AlphaTab.Model.Tuning._fiveStrings.push(new AlphaTab.Model.Tuning("Banjo Open G Tuning",new Int32Array([62,59,55,50,67]),!1)),AlphaTab.Model.Tuning._fiveStrings.push(new AlphaTab.Model.Tuning("Banjo G Minor Tuning",new Int32Array([62,58,55,50,67]),!1)),AlphaTab.Model.Tuning._fiveStrings.push(new AlphaTab.Model.Tuning("Banjo G Modal Tuning",new Int32Array([62,57,55,50,67]),!1)),AlphaTab.Model.Tuning._defaultTunings[4]=new AlphaTab.Model.Tuning("Bass Standard Tuning",new Int32Array([43,38,33,28]),!0),AlphaTab.Model.Tuning._fourStrings.push(AlphaTab.Model.Tuning._defaultTunings[4]),AlphaTab.Model.Tuning._fourStrings.push(new AlphaTab.Model.Tuning("Bass Tune down  step",new Int32Array([42,37,32,27]),!1)),AlphaTab.Model.Tuning._fourStrings.push(new AlphaTab.Model.Tuning("Bass Tune down 1 step",new Int32Array([41,36,31,26]),!1)),AlphaTab.Model.Tuning._fourStrings.push(new AlphaTab.Model.Tuning("Bass Tune down 2 step",new Int32Array([39,34,29,24]),!1)),AlphaTab.Model.Tuning._fourStrings.push(new AlphaTab.Model.Tuning("Bass Dropped D Tuning",new Int32Array([43,38,33,26]),!1)),AlphaTab.Model.Tuning._fourStrings.push(new AlphaTab.Model.Tuning("Ukulele C Tuning",new Int32Array([45,40,36,43]),!1)),AlphaTab.Model.Tuning._fourStrings.push(new AlphaTab.Model.Tuning("Ukulele G Tuning",new Int32Array([52,47,43,38]),!1)),AlphaTab.Model.Tuning._fourStrings.push(new AlphaTab.Model.Tuning("Mandolin Standard Tuning",new Int32Array([64,57,50,43]),!1)),AlphaTab.Model.Tuning._fourStrings.push(new AlphaTab.Model.Tuning("Mandolin or Violin Tuning",new Int32Array([76,69,62,55]),!1)),AlphaTab.Model.Tuning._fourStrings.push(new AlphaTab.Model.Tuning("Viola Tuning",new Int32Array([69,62,55,48]),!1)),AlphaTab.Model.Tuning._fourStrings.push(new AlphaTab.Model.Tuning("Cello Tuning",new Int32Array([57,50,43,36]),!1))},AlphaTab.Model.Tuning.FindTuning=function(e){for(var t=AlphaTab.Model.Tuning.GetPresetsFor(e.length),a=0,i=t.length;a<i;a++){for(var n=t[a],r=!0,l=0,s=e.length;l<s;l++)if(e[l]!=n.Tunings[l]){r=!1;break}if(r)return n}return null},AlphaTab.Model.TuningParseResult=function(){this.Note=null,this.NoteValue=0,this.Octave=0},AlphaTab.Model.TuningParseResult.prototype={get_RealValue:function(){return 12*this.Octave+this.NoteValue}},AlphaTab.Model.TuningParser=function(){},AlphaTab.Model.TuningParser.IsTuning=function(e){return null!=AlphaTab.Model.TuningParser.Parse(e)},AlphaTab.Model.TuningParser.Parse=function(e){for(var t="",a="",i=0;i<e.length;i++){var n=e.charCodeAt(i);if(AlphaTab.Platform.Std.IsCharNumber(n,!1)){if(null==t||0==t.length)return null;a+=String.fromCharCode(n)}else{if(!(n>=65&&n<=90||n>=97&&n<=122||35==n))return null;t+=String.fromCharCode(n)}}if(null==a||0==a.length||null==t||0==t.length)return null;var r=new AlphaTab.Model.TuningParseResult;return r.Octave=AlphaTab.Platform.Std.ParseInt(a)+1,r.Note=t.toLowerCase(),r.NoteValue=AlphaTab.Model.TuningParser.GetToneForText(r.Note),r},AlphaTab.Model.TuningParser.GetTuningForText=function(e){var t=AlphaTab.Model.TuningParser.Parse(e);return null==t?-1:t.get_RealValue()},AlphaTab.Model.TuningParser.GetToneForText=function(e){var t;switch(e.toLowerCase()){case"c":t=0;break;case"c#":case"db":t=1;break;case"d":t=2;break;case"d#":case"eb":t=3;break;case"e":t=4;break;case"f":t=5;break;case"f#":case"gb":t=6;break;case"g":t=7;break;case"g#":case"ab":t=8;break;case"a":t=9;break;case"a#":case"bb":t=10;break;case"b":t=11;break;default:return 0}return t},AlphaTab.Model.VibratoType={None:0,Slight:1,Wide:2},AlphaTab.Model.Voice=function(){this.Index=0,this.Bar=null,this.Beats=null,this.IsEmpty=!1,this.Beats=[],this.IsEmpty=!0},AlphaTab.Model.Voice.prototype={AddBeat:function(e){e.Voice=this,e.Index=this.Beats.length,this.Beats.push(e),e.IsEmpty||(this.IsEmpty=!1)},Chain:function(e){if(null!=this.Bar)if(e.Index<this.Beats.length-1)e.NextBeat=this.Beats[e.Index+1],e.NextBeat.PreviousBeat=e;else if(e.Index==e.Voice.Beats.length-1&&null!=e.Voice.Bar.NextBar){var t=this.Bar.NextBar.Voices[this.Index];t.Beats.length>0?(e.NextBeat=t.Beats[0],e.NextBeat.PreviousBeat=e):e.NextBeat.PreviousBeat=e}},AddGraceBeat:function(e){if(0!=this.Beats.length){var t=this.Beats[this.Beats.length-1];this.Beats.splice(this.Beats.length-1,1),this.AddBeat(e),this.AddBeat(t),this.IsEmpty=!1}else this.AddBeat(e)},Finish:function(){for(var e=0,t=this.Beats.length;e<t;e++){var a=this.Beats[e];this.Chain(a)}for(var e=0,t=this.Beats.length;e<t;e++)(a=this.Beats[e]).Finish()}},AlphaTab.Model.Voice.CopyTo=function(e,t){t.Index=e.Index,t.IsEmpty=e.IsEmpty},AlphaTab.Platform.Model=AlphaTab.Platform.Model||{},AlphaTab.Platform.Model.Color=function(e,t,a,i){this.Raw=0,this.RGBA=null,this.Raw=i<<24|e<<16|t<<8|a,255==this.get_A()?this.RGBA="#"+AlphaTab.Platform.Std.ToHexString(this.get_R(),2)+AlphaTab.Platform.Std.ToHexString(this.get_G(),2)+AlphaTab.Platform.Std.ToHexString(this.get_B(),2):this.RGBA="rgba("+this.get_R()+","+this.get_G()+","+this.get_B()+","+this.get_A()/255+")"},AlphaTab.Platform.Model.Color.prototype={get_A:function(){return this.Raw>>24&255},get_R:function(){return this.Raw>>16&255},get_G:function(){return this.Raw>>8&255},get_B:function(){return 255&this.Raw}},$StaticConstructor(function(){AlphaTab.Platform.Model.Color.BlackRgb="#000000"}),AlphaTab.Platform.Model.FontStyle={Plain:0,Bold:1,Italic:2},AlphaTab.Platform.Model.Font=function(e,t,a){this._css=null,this.Family=null,this.Size=0,this.Style=AlphaTab.Platform.Model.FontStyle.Plain,this.Family=e,this.Size=t,this.Style=a,this._css=this.ToCssString(1)},AlphaTab.Platform.Model.Font.prototype={get_IsBold:function(){return(this.Style&AlphaTab.Platform.Model.FontStyle.Bold)!=AlphaTab.Platform.Model.FontStyle.Plain},get_IsItalic:function(){return(this.Style&AlphaTab.Platform.Model.FontStyle.Italic)!=AlphaTab.Platform.Model.FontStyle.Plain},Clone:function(){return new AlphaTab.Platform.Model.Font(this.Family,this.Size,this.Style)},ToCssString:function(e){if(null!=this._css&&1==e)return this._css;var t=new String;return this.get_IsBold()&&(t+="bold "),this.get_IsItalic()&&(t+="italic "),t+=this.Size*e,t+="px ",t+="'",t+=this.Family,t+="'"}},AlphaTab.Platform.Model.TextAlign={Left:0,Center:1,Right:2},AlphaTab.Platform.Model.TextBaseline={Top:0,Middle:1,Bottom:2},AlphaTab.Platform.Svg=AlphaTab.Platform.Svg||{},AlphaTab.Platform.Svg.FontSizes=function(){},$StaticConstructor(function(){AlphaTab.Platform.Svg.FontSizes.TimesNewRoman=new Uint8Array([3,4,5,6,6,9,9,2,4,4,6,6,3,4,3,3,6,6,6,6,6,6,6,6,6,6,3,3,6,6,6,5,10,8,7,7,8,7,6,7,8,4,4,8,7,10,8,8,7,8,7,5,8,8,7,11,8,8,7,4,3,4,5,6,4,5,5,5,5,5,4,5,6,3,3,6,3,9,6,6,6,5,4,4,4,5,6,7,6,6,5,5,2,5,6,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,4,6,6,6,6,2,5,4,8,4,6,6,0,8,6,4,6,3,3,4,5,5,4,4,3,3,6,8,8,8,5,8,8,8,8,8,8,11,7,7,7,7,7,4,4,4,4,8,8,8,8,8,8,8,6,8,8,8,8,8,8,6,5,5,5,5,5,5,5,8,5,5,5,5,5,3,3,3,3,6,6,6,6,6,6,6,6,6,5,5,5,5,6,6]),AlphaTab.Platform.Svg.FontSizes.Arial11Pt=new Uint8Array([3,3,4,6,6,10,7,2,4,4,4,6,3,4,3,3,6,6,6,6,6,6,6,6,6,6,3,3,6,6,6,6,11,7,7,8,8,7,7,9,8,3,6,7,6,9,8,9,7,9,8,7,7,8,7,10,7,7,7,3,3,3,5,6,4,6,6,6,6,6,3,6,6,2,2,6,2,9,6,6,6,6,4,6,3,6,6,8,6,6,6,4,3,4,6,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,3,4,6,6,6,6,3,6,4,8,4,6,6,0,8,6,4,6,4,4,4,6,6,4,4,4,4,6,9,9,9,7,7,7,7,7,7,7,11,8,7,7,7,7,3,3,3,3,8,8,9,9,9,9,9,6,9,8,8,8,8,7,7,7,6,6,6,6,6,6,10,6,6,6,6,6,3,3,3,3,6,6,6,6,6,6,6,6,7,6,6,6,6,6,6]),AlphaTab.Platform.Svg.FontSizes.ControlChars=32}),AlphaTab.Platform.Svg.FontSizes.MeasureString=function(e,t,a,i){var n,r,l=1;(i&AlphaTab.Platform.Model.FontStyle.Italic)!=AlphaTab.Platform.Model.FontStyle.Plain&&(l*=1.2),(i&AlphaTab.Platform.Model.FontStyle.Bold)!=AlphaTab.Platform.Model.FontStyle.Plain&&(l*=1.2),t==AlphaTab.Platform.Svg.SupportedFonts.TimesNewRoman?(n=AlphaTab.Platform.Svg.FontSizes.TimesNewRoman,r=11):t==AlphaTab.Platform.Svg.SupportedFonts.Arial?(n=AlphaTab.Platform.Svg.FontSizes.Arial11Pt,r=11):(n=new Uint8Array([8]),r=11);for(var s=0,o=0;o<e.length;o++){var h=Math.min(n.length-1,e.charCodeAt(o)-32);h>=0&&(s+=n[h]*a/r)}return s*l},AlphaTab.Platform.Svg.SupportedFonts={TimesNewRoman:0,Arial:1},AlphaTab.Platform.Svg.SvgCanvas=function(){this.Buffer=null,this._currentPath=null,this._currentPathIsEmpty=!1,this._Color=null,this._LineWidth=0,this._Font=null,this._TextAlign=AlphaTab.Platform.Model.TextAlign.Left,this._TextBaseline=AlphaTab.Platform.Model.TextBaseline.Top,this._Resources=null,this._currentPath=new String,this._currentPathIsEmpty=!0,this.set_Color(new AlphaTab.Platform.Model.Color(255,255,255,255)),this.set_LineWidth(1),this.set_Font(new AlphaTab.Platform.Model.Font("Arial",10,AlphaTab.Platform.Model.FontStyle.Plain)),this.set_TextAlign(AlphaTab.Platform.Model.TextAlign.Left),this.set_TextBaseline(AlphaTab.Platform.Model.TextBaseline.Top)},AlphaTab.Platform.Svg.SvgCanvas.prototype={get_Color:function(){return this._Color},set_Color:function(e){this._Color=e},get_LineWidth:function(){return this._LineWidth},set_LineWidth:function(e){this._LineWidth=e},get_Font:function(){return this._Font},set_Font:function(e){this._Font=e},get_TextAlign:function(){return this._TextAlign},set_TextAlign:function(e){this._TextAlign=e},get_TextBaseline:function(){return this._TextBaseline},set_TextBaseline:function(e){this._TextBaseline=e},get_Resources:function(){return this._Resources},set_Resources:function(e){this._Resources=e},BeginRender:function(e,t){this.Buffer=new String,this.Buffer+='<svg xmlns="http://www.w3.org/2000/svg" version="1.1" width="',this.Buffer+=e,this.Buffer+='px" height="',this.Buffer+=t,this.Buffer+='px" class="alphaTabSurfaceSvg">\n',this._currentPath=new String,this._currentPathIsEmpty=!0},BeginGroup:function(e){this.Buffer+='<g class="'+e+'">'},EndGroup:function(){this.Buffer+="</g>"},EndRender:function(){return this.Buffer+="</svg>",this.Buffer},FillRect:function(e,t,a,i){a>0&&(this.Buffer+='<rect x="'+(-.5|e)+'" y="'+(-.5|t)+'" width="'+a+'" height="'+i+'" fill="'+this.get_Color().RGBA+'" />\n')},StrokeRect:function(e,t,a,i){this.Buffer+='<rect x="'+(-.5|e)+'" y="'+(-.5|t)+'" width="'+a+'" height="'+i+'" stroke="'+this.get_Color().RGBA+'"',1!=this.get_LineWidth()&&(this.Buffer+=' stroke-width="'+this.get_LineWidth()+'"'),this.Buffer+=' fill="transparent" />\n'},BeginPath:function(){},ClosePath:function(){this._currentPath+=" z"},MoveTo:function(e,t){this._currentPath+=" M"+(e-.5)+","+(t-.5)},LineTo:function(e,t){this._currentPathIsEmpty=!1,this._currentPath+=" L"+(e-.5)+","+(t-.5)},QuadraticCurveTo:function(e,t,a,i){this._currentPathIsEmpty=!1,this._currentPath+=" Q"+e+","+t+","+a+","+i},BezierCurveTo:function(e,t,a,i,n,r){this._currentPathIsEmpty=!1,this._currentPath+=" C"+e+","+t+","+a+","+i+","+n+","+r},FillCircle:function(e,t,a){this._currentPathIsEmpty=!1,this._currentPath+=" M"+(e-a)+","+t+" A1,1 0 0,0 "+(e+a)+","+t+" A1,1 0 0,0 "+(e-a)+","+t+" z",this.Fill()},Fill:function(){this._currentPathIsEmpty||(this.Buffer+='<path d="'+this._currentPath+'"',"#000000"!=this.get_Color().RGBA&&(this.Buffer+=' fill="'+this.get_Color().RGBA+'"'),this.Buffer+=' stroke="none"/>'),this._currentPath=new String,this._currentPathIsEmpty=!0},Stroke:function(){if(!this._currentPathIsEmpty){var e='<path d="'+this._currentPath+'" stroke="'+this.get_Color().RGBA+'"';1!=this.get_LineWidth()&&(e+=' stroke-width="'+this.get_LineWidth()+'"'),e+=' fill="none" />',this.Buffer+=e}this._currentPath=new String,this._currentPathIsEmpty=!0},FillText:function(e,t,a){var i='<text x="'+(0|t)+'" y="'+(0|a)+'" style="font:'+this.get_Font().ToCssString(1)+'"  dominant-baseline="'+this.GetSvgBaseLine()+'"';"#000000"!=this.get_Color().RGBA&&(i+=' fill="'+this.get_Color().RGBA+'"'),this.get_TextAlign()!=AlphaTab.Platform.Model.TextAlign.Left&&(i+=' text-anchor="'+this.GetSvgTextAlignment()+'"'),i+=">"+e+"</text>",this.Buffer+=i},GetSvgTextAlignment:function(){switch(this.get_TextAlign()){case AlphaTab.Platform.Model.TextAlign.Left:return"start";case AlphaTab.Platform.Model.TextAlign.Center:return"middle";case AlphaTab.Platform.Model.TextAlign.Right:return"end"}return""},GetSvgBaseLine:function(){switch(this.get_TextBaseline()){case AlphaTab.Platform.Model.TextBaseline.Top:return"hanging";case AlphaTab.Platform.Model.TextBaseline.Middle:return"middle";case AlphaTab.Platform.Model.TextBaseline.Bottom:return"bottom";default:return""}},MeasureText:function(e){if(null==e||0==e.length)return 0;var t=AlphaTab.Platform.Svg.SupportedFonts.Arial;return-1!=this.get_Font().Family.indexOf("Times")&&(t=AlphaTab.Platform.Svg.SupportedFonts.TimesNewRoman),AlphaTab.Platform.Svg.FontSizes.MeasureString(e,t,this.get_Font().Size,this.get_Font().Style)},OnPreRender:function(){return null},OnRenderFinished:function(){return null}},$StaticConstructor(function(){AlphaTab.Platform.Svg.SvgCanvas.BlurCorrection=.5}),AlphaTab.Platform.Svg.CssFontSvgCanvas=function(){AlphaTab.Platform.Svg.SvgCanvas.call(this)},AlphaTab.Platform.Svg.CssFontSvgCanvas.prototype={FillMusicFontSymbol:function(e,t,a,i){this.Buffer+='<g transform="translate('+(-.5|e)+" "+(-.5|t)+')" class="at" ><text',1!=a&&(this.Buffer+='  style="font-size: '+100*a+'%"'),"#000000"!=this.get_Color().RGBA&&(this.Buffer+=' fill="'+this.get_Color().RGBA+'"'),this.Buffer+=">&#"+i+";</text></g>"}},$Inherit(AlphaTab.Platform.Svg.CssFontSvgCanvas,AlphaTab.Platform.Svg.SvgCanvas),AlphaTab.Rendering.BarRendererBase=function(e,t){this._preBeatGlyphs=null,this._voiceContainers=null,this._postBeatGlyphs=null,this._wasFirstOfLine=!1,this._appliedLayoutingInfo=0,this.Staff=null,this.X=0,this.Y=0,this.Width=0,this.Height=0,this.Index=0,this.TopOverflow=0,this.BottomOverflow=0,this.Helpers=null,this.Bar=null,this.IsLinkedToPrevious=!1,this.ScoreRenderer=null,this.LayoutingInfo=null,this.IsFinalized=!1,this.TopPadding=0,this.BottomPadding=0,this.Bar=t,this.ScoreRenderer=e,this.Helpers=new AlphaTab.Rendering.Utils.BarHelpers(t)},AlphaTab.Rendering.BarRendererBase.prototype={get_NextRenderer:function(){return null==this.Bar.NextBar?null:this.ScoreRenderer.Layout.GetRendererForBar(this.Staff.get_StaveId(),this.Bar.NextBar)},get_PreviousRenderer:function(){return null==this.Bar.PreviousBar?null:this.ScoreRenderer.Layout.GetRendererForBar(this.Staff.get_StaveId(),this.Bar.PreviousBar)},RegisterOverflowTop:function(e){e>this.TopOverflow&&(this.TopOverflow=e)},RegisterOverflowBottom:function(e){e>this.BottomOverflow&&(this.BottomOverflow=e)},ScaleToWidth:function(e){var t=e-this._preBeatGlyphs.Width-this._postBeatGlyphs.Width;for(var a in this._voiceContainers)this._voiceContainers[a].ScaleToWidth(t);this._postBeatGlyphs.X=this._preBeatGlyphs.X+this._preBeatGlyphs.Width+t,this.Width=e},get_Resources:function(){return this.ScoreRenderer.RenderingResources},get_Settings:function(){return this.ScoreRenderer.Settings},get_Scale:function(){return this.get_Settings().Scale},get_IsFirstOfLine:function(){return 0==this.Index},get_IsLast:function(){return this.Staff.StaveGroup.IsLast&&this.Index==this.Staff.BarRenderers.length-1},RegisterLayoutingInfo:function(){var e=this.LayoutingInfo,t=this._preBeatGlyphs.Width;e.PreBeatSize<t&&(e.PreBeatSize=t);for(var a in this._voiceContainers)this._voiceContainers[a].RegisterLayoutingInfo(e);var i=this._postBeatGlyphs.Width;e.PostBeatSize<i&&(e.PostBeatSize=i)},ApplyLayoutingInfo:function(){if(this._appliedLayoutingInfo>=this.LayoutingInfo.Version)return!1;this._appliedLayoutingInfo=this.LayoutingInfo.Version,this._preBeatGlyphs.Width=this.LayoutingInfo.PreBeatSize;var e=this._preBeatGlyphs.X+this._preBeatGlyphs.Width;for(var t in this._voiceContainers){var a=this._voiceContainers[t];a.X=this._preBeatGlyphs.X+this._preBeatGlyphs.Width,a.ApplyLayoutingInfo(this.LayoutingInfo);var i=a.X+a.Width;e<i&&(e=i)}return this._postBeatGlyphs.X=e,this._postBeatGlyphs.Width=this.LayoutingInfo.PostBeatSize,this.Width=this._postBeatGlyphs.X+this._postBeatGlyphs.Width,!0},FinalizeRenderer:function(){this.IsFinalized=!0},DoLayout:function(){this._preBeatGlyphs=new AlphaTab.Rendering.Glyphs.LeftToRightLayoutingGlyphGroup,this._preBeatGlyphs.Renderer=this,this._voiceContainers={},this._postBeatGlyphs=new AlphaTab.Rendering.Glyphs.LeftToRightLayoutingGlyphGroup,this._postBeatGlyphs.Renderer=this;for(var e=0;e<this.Bar.Voices.length;e++){var t=this.Bar.Voices[e];if(this.HasVoiceContainer(t)){var a=new AlphaTab.Rendering.Glyphs.VoiceContainerGlyph(0,0,t);a.Renderer=this,this._voiceContainers[this.Bar.Voices[e].Index]=a}}this.CreatePreBeatGlyphs(),this.CreateBeatGlyphs(),this.CreatePostBeatGlyphs(),this.UpdateSizes()},HasVoiceContainer:function(e){return!e.IsEmpty||0==e.Index},UpdateSizes:function(){this.Staff.RegisterStaffTop(this.TopPadding),this.Staff.RegisterStaffBottom(this.Height-this.BottomPadding);var e=this._voiceContainers,t=this.get_BeatGlyphsStart(),a=t;for(var i in e){var n=e[i];n.X=t,n.DoLayout();var r=n.X+n.Width;a<r&&(a=r)}this._postBeatGlyphs.X=a,this.Width=this._postBeatGlyphs.X+this._postBeatGlyphs.Width},AddPreBeatGlyph:function(e){this._preBeatGlyphs.AddGlyph(e)},AddBeatGlyph:function(e){e.Renderer=this,e.PreNotes.Renderer=this,e.OnNotes.Renderer=this,e.OnNotes.BeamingHelper=this.Helpers.BeamHelperLookup[e.Beat.Voice.Index][e.Beat.Index],this.GetOrCreateVoiceContainer(e.Beat.Voice).AddGlyph(e)},GetOrCreateVoiceContainer:function(e){return this._voiceContainers[e.Index]},GetBeatContainer:function(e){return this.GetOrCreateVoiceContainer(e.Voice).BeatGlyphs[e.Index]},GetPreNotesGlyphForBeat:function(e){return this.GetBeatContainer(e).PreNotes},GetOnNotesGlyphForBeat:function(e){return this.GetBeatContainer(e).OnNotes},Paint:function(e,t,a){this.PaintBackground(e,t,a),a.set_Color(this.get_Resources().MainGlyphColor),this._preBeatGlyphs.Paint(e+this.X,t+this.Y,a);for(var i in this._voiceContainers){var n=this._voiceContainers[i];a.set_Color(0==n.Voice.Index?this.get_Resources().MainGlyphColor:this.get_Resources().SecondaryGlyphColor),n.Paint(e+this.X,t+this.Y,a)}a.set_Color(this.get_Resources().MainGlyphColor),this._postBeatGlyphs.Paint(e+this.X,t+this.Y,a)},PaintBackground:function(e,t,a){},BuildBoundingsLookup:function(e,t,a){var i=new AlphaTab.Rendering.Utils.BarBounds;i.Bar=this.Bar,i.VisualBounds={X:t+this.X,Y:a+this.Y+this.TopPadding,W:this.Width,H:this.Height-this.TopPadding-this.BottomPadding},i.RealBounds={X:t+this.X,Y:a+this.Y,W:this.Width,H:this.Height},e.AddBar(i);for(var n in this._voiceContainers){var r=this._voiceContainers[n];if(!r.Voice.IsEmpty||this.Bar.get_IsEmpty()&&0==n)for(var l=0,s=r.BeatGlyphs.length;l<s;l++){var o=r.BeatGlyphs[l],h=new AlphaTab.Rendering.Utils.BeatBounds;h.Beat=o.Beat,h.VisualBounds={X:t+this.X+r.X+o.X+o.OnNotes.X,Y:i.VisualBounds.Y,W:o.OnNotes.Width,H:i.VisualBounds.H},h.RealBounds={X:t+this.X+r.X+o.X,Y:i.RealBounds.Y,W:o.Width,H:i.RealBounds.H},i.AddBeat(h)}}},AddPostBeatGlyph:function(e){this._postBeatGlyphs.AddGlyph(e)},CreatePreBeatGlyphs:function(){this._wasFirstOfLine=this.get_IsFirstOfLine()},CreateBeatGlyphs:function(){},CreatePostBeatGlyphs:function(){this.AddPostBeatGlyph(new AlphaTab.Rendering.Glyphs.SpacingGlyph(0,0,5*this.get_Scale()))},get_BeatGlyphsStart:function(){return this._preBeatGlyphs.X+this._preBeatGlyphs.Width},GetNoteX:function(e,t){return 0},GetBeatX:function(e,t){var a=this.GetBeatContainer(e);if(null!=a)switch(t){case AlphaTab.Rendering.BeatXPosition.PreNotes:return a.VoiceContainer.X+a.X+a.PreNotes.X;case AlphaTab.Rendering.BeatXPosition.OnNotes:return a.VoiceContainer.X+a.X+a.OnNotes.X;case AlphaTab.Rendering.BeatXPosition.PostNotes:return a.VoiceContainer.X+a.X+a.OnNotes.X+a.OnNotes.Width;case AlphaTab.Rendering.BeatXPosition.EndBeat:return a.VoiceContainer.X+a.X+a.Width}return 0},GetNoteY:function(e){return 0},ReLayout:function(){this._wasFirstOfLine^this.get_IsFirstOfLine()&&(this._preBeatGlyphs=new AlphaTab.Rendering.Glyphs.LeftToRightLayoutingGlyphGroup,this._preBeatGlyphs.Renderer=this,this.CreatePreBeatGlyphs()),this.UpdateSizes(),this.RegisterLayoutingInfo()}},AlphaTab.Rendering.BeatXPosition={PreNotes:0,OnNotes:1,PostNotes:2,EndBeat:3},AlphaTab.Rendering.BarRendererFactory=function(){this.IsInAccolade=!1,this.HideOnMultiTrack=!1,this.HideOnPercussionTrack=!1,this.IsInAccolade=!0,this.HideOnPercussionTrack=!1,this.HideOnMultiTrack=!1},AlphaTab.Rendering.BarRendererFactory.prototype={CanCreate:function(e,t){return!this.HideOnPercussionTrack||!e.IsPercussion}},AlphaTab.Rendering.EffectBarGlyphSizing={SinglePreBeat:0,SingleOnBeat:1,GroupedBeforeBeat:2,GroupedOnBeat:3,FullBar:4},AlphaTab.Rendering.Glyphs=AlphaTab.Rendering.Glyphs||{},AlphaTab.Rendering.Glyphs.Glyph=function(e,t){this.X=0,this.Y=0,this.Width=0,this.Renderer=null,this.X=e,this.Y=t},AlphaTab.Rendering.Glyphs.Glyph.prototype={get_Scale:function(){return this.Renderer.get_Scale()},DoLayout:function(){},Paint:function(e,t,a){}},AlphaTab.Rendering.EffectBand=function(e){this._uniqueEffectGlyphs=null,this._effectGlyphs=null,this.IsEmpty=!1,this.PreviousBand=null,this.IsLinkedToPrevious=!1,this.FirstBeat=null,this.LastBeat=null,this.Height=0,this.Info=null,AlphaTab.Rendering.Glyphs.Glyph.call(this,0,0),this.Info=e,this._uniqueEffectGlyphs=[],this._effectGlyphs=[],this.IsEmpty=!0},AlphaTab.Rendering.EffectBand.prototype={DoLayout:function(){AlphaTab.Rendering.Glyphs.Glyph.prototype.DoLayout.call(this);for(var e=0;e<this.Renderer.Bar.Voices.length;e++)this._effectGlyphs.push({}),this._uniqueEffectGlyphs.push([])},CreateGlyph:function(e){if(this.Info.ShouldCreateGlyph(e)&&(!this.Info.get_HideOnMultiTrack()||0==this.Renderer.Staff.TrackIndex)){this.IsEmpty=!1,(null==this.FirstBeat||this.FirstBeat.Index>e.Index)&&(this.FirstBeat=e),(null==this.LastBeat||this.LastBeat.Index<e.Index)&&(this.LastBeat=e);var t=this.CreateOrResizeGlyph(this.Info.get_SizingMode(),e);t.Height>this.Height&&(this.Height=t.Height)}},CreateOrResizeGlyph:function(e,t){var a;switch(e){case AlphaTab.Rendering.EffectBarGlyphSizing.FullBar:return a=this.Info.CreateNewGlyph(this.Renderer,t),a.Renderer=this.Renderer,a.Beat=t,a.DoLayout(),this._effectGlyphs[t.Voice.Index][t.Index]=a,this._uniqueEffectGlyphs[t.Voice.Index].push(a),a;case AlphaTab.Rendering.EffectBarGlyphSizing.SinglePreBeat:case AlphaTab.Rendering.EffectBarGlyphSizing.SingleOnBeat:return a=this.Info.CreateNewGlyph(this.Renderer,t),a.Renderer=this.Renderer,a.Beat=t,a.DoLayout(),this._effectGlyphs[t.Voice.Index][t.Index]=a,this._uniqueEffectGlyphs[t.Voice.Index].push(a),a;case AlphaTab.Rendering.EffectBarGlyphSizing.GroupedOnBeat:if(t.Index>0||this.Renderer.Index>0){var i=t.PreviousBeat;if(this.Info.ShouldCreateGlyph(i)){var n=null;if(t.Index>0&&this._effectGlyphs[t.Voice.Index].hasOwnProperty(i.Index))n=this._effectGlyphs[t.Voice.Index][i.Index];else if(this.Renderer.Index>0){var r=this.Renderer.get_PreviousRenderer().BandLookup[this.Info.get_EffectId()]._effectGlyphs[t.Voice.Index];r.hasOwnProperty(i.Index)&&(n=r[i.Index])}var l=this.CreateOrResizeGlyph(AlphaTab.Rendering.EffectBarGlyphSizing.SingleOnBeat,t);return null!=n&&this.Info.CanExpand(i,t)&&(n.NextGlyph=l,l.PreviousGlyph=n,this.IsLinkedToPrevious=!0),l}return this.CreateOrResizeGlyph(AlphaTab.Rendering.EffectBarGlyphSizing.SingleOnBeat,t)}return this.CreateOrResizeGlyph(AlphaTab.Rendering.EffectBarGlyphSizing.SingleOnBeat,t)}return null},Paint:function(e,t,a){AlphaTab.Rendering.Glyphs.Glyph.prototype.Paint.call(this,e,t,a);for(var i=0,n=this._uniqueEffectGlyphs.length;i<n;i++)for(var r=this._uniqueEffectGlyphs[i],l=0,s=r.length;l<s;l++)r[l].Paint(e+this.X,t+this.Y,a)},AlignGlyphs:function(){for(var e=0;e<this._effectGlyphs.length;e++)for(var t in this._effectGlyphs[e])this.AlignGlyph(this.Info.get_SizingMode(),this.Renderer.Bar.Voices[e].Beats[t])},AlignGlyph:function(e,t){var a,i=this._effectGlyphs[t.Voice.Index][t.Index],n=this.Renderer.GetBeatContainer(t);switch(e){case AlphaTab.Rendering.EffectBarGlyphSizing.SinglePreBeat:a=n.PreNotes,i.X=this.Renderer.get_BeatGlyphsStart()+a.X+n.X,i.Width=a.Width;break;case AlphaTab.Rendering.EffectBarGlyphSizing.SingleOnBeat:case AlphaTab.Rendering.EffectBarGlyphSizing.GroupedOnBeat:a=n.OnNotes,i.X=this.Renderer.get_BeatGlyphsStart()+a.X+n.X,i.Width=a.Width;break;case AlphaTab.Rendering.EffectBarGlyphSizing.FullBar:i.Width=this.Renderer.Width}}},$Inherit(AlphaTab.Rendering.EffectBand,AlphaTab.Rendering.Glyphs.Glyph),AlphaTab.Rendering.EffectBandSizingInfo=function(){this._effectSlot=null,this.Slots=null,this.Slots=[],this._effectSlot={}},AlphaTab.Rendering.EffectBandSizingInfo.prototype={GetOrCreateSlot:function(e){if(this._effectSlot.hasOwnProperty(e.Info.get_EffectId())&&(n=this._effectSlot[e.Info.get_EffectId()]).CanBeUsed(e))return n;for(var t=0,a=this.Slots,i=a.length,n=a[t];t<i;t++,n=a[t])if(n.CanBeUsed(e))return n;var r=new AlphaTab.Rendering.EffectBandSlot;return this.Slots.push(r),r},CopySlots:function(e){for(var t=0,a=e.Slots,i=a.length,n=a[t];t<i;t++,n=a[t]){var r=new AlphaTab.Rendering.EffectBandSlot;r.Y=n.Y,r.Height=n.Height,r.UniqueEffectId=n.UniqueEffectId,this.Slots.push(r);for(var l=0,s=n.Bands,o=s.length,h=s[l];l<o;l++,h=s[l])this._effectSlot[h.Info.get_EffectId()]=r}},Register:function(e){var t=this.GetOrCreateSlot(e);t.Update(e),this._effectSlot[e.Info.get_EffectId()]=t}},AlphaTab.Rendering.EffectBandSlot=function(){this.Y=0,this.Height=0,this.FirstBeat=null,this.LastBeat=null,this.Bands=null,this.UniqueEffectId=null,this.Bands=[]},AlphaTab.Rendering.EffectBandSlot.prototype={Update:function(e){e.Info.get_CanShareBand()||(this.UniqueEffectId=e.Info.get_EffectId()),this.Bands.push(e),e.Height>this.Height&&(this.Height=e.Height),(null==this.FirstBeat||this.FirstBeat.Index>e.FirstBeat.Index)&&(this.FirstBeat=e.FirstBeat),(null==this.LastBeat||this.LastBeat.Index<e.LastBeat.Index)&&(this.LastBeat=e.LastBeat)},CanBeUsed:function(e){return(null==this.UniqueEffectId&&e.Info.get_CanShareBand()||e.Info.get_EffectId()==this.UniqueEffectId)&&(null==this.FirstBeat||this.LastBeat.Index<e.FirstBeat.Index||e.LastBeat.Index<this.FirstBeat.Index)}},AlphaTab.Rendering.EffectBarRenderer=function(e,t,a){this._infos=null,this._bands=null,this.BandLookup=null,this.SizingInfo=null,AlphaTab.Rendering.BarRendererBase.call(this,e,t),this._infos=a},AlphaTab.Rendering.EffectBarRenderer.prototype={UpdateSizes:function(){this.TopOverflow=0,this.BottomOverflow=0,this.TopPadding=0,this.BottomPadding=0,this.UpdateHeight(),AlphaTab.Rendering.BarRendererBase.prototype.UpdateSizes.call(this)},UpdateHeight:function(){if(null!=this.SizingInfo){for(var e=0,t=0,a=this.SizingInfo.Slots,i=a.length,n=a[t];t<i;t++,n=a[t]){n.Y=e;for(var r=0,l=n.Bands,s=l.length,o=l[r];r<s;r++,o=l[r])o.Y=e,o.Height=n.Height;e+=n.Height}this.Height=e}},ApplyLayoutingInfo:function(){if(!AlphaTab.Rendering.BarRendererBase.prototype.ApplyLayoutingInfo.call(this))return!1;if(this.SizingInfo=new AlphaTab.Rendering.EffectBandSizingInfo,this.Index>0){var e=this.get_PreviousRenderer();this.SizingInfo.CopySlots(e.SizingInfo)}for(var t=0,a=this._bands,i=a.length,n=a[t];t<i;t++,n=a[t])n.AlignGlyphs(),n.IsEmpty||this.SizingInfo.Register(n);return this.UpdateHeight(),!0},ScaleToWidth:function(e){AlphaTab.Rendering.BarRendererBase.prototype.ScaleToWidth.call(this,e);for(var t=0,a=this._bands,i=a.length,n=a[t];t<i;t++,n=a[t])n.AlignGlyphs()},CreateBeatGlyphs:function(){this._bands=new Array(this._infos.length),this.BandLookup={};for(var e=0;e<this._infos.length;e++)this._bands[e]=new AlphaTab.Rendering.EffectBand(this._infos[e]),this._bands[e].Renderer=this,this._bands[e].DoLayout(),this.BandLookup[this._infos[e].get_EffectId()]=this._bands[e];for(var t=0,a=this.Bar.Voices,i=a.length,n=a[t];t<i;t++,n=a[t])this.HasVoiceContainer(n)&&this.CreateVoiceGlyphs(n);for(var r=0,l=this._bands,s=l.length,o=l[r];r<s;r++,o=l[r])o.IsLinkedToPrevious&&(this.IsLinkedToPrevious=!0)},CreateVoiceGlyphs:function(e){for(var t=0,a=e.Beats,i=a.length,n=a[t];t<i;t++,n=a[t]){var r=new AlphaTab.Rendering.Glyphs.BeatContainerGlyph(n,this.GetOrCreateVoiceContainer(e));r.PreNotes=new AlphaTab.Rendering.Glyphs.BeatGlyphBase,r.OnNotes=new AlphaTab.Rendering.Glyphs.BeatOnNoteGlyphBase,this.AddBeatGlyph(r);for(var l=0,s=this._bands,o=s.length,h=s[l];l<o;l++,h=s[l])h.CreateGlyph(n)}},Paint:function(e,t,a){this.PaintBackground(e,t,a),a.set_Color(this.get_Resources().MainGlyphColor);for(var i=0,n=this._bands,r=n.length,l=n[i];i<r;i++,l=n[i])l.Paint(e+this.X,t+this.Y,a)}},$Inherit(AlphaTab.Rendering.EffectBarRenderer,AlphaTab.Rendering.BarRendererBase),AlphaTab.Rendering.EffectBarRendererFactory=function(e,t){this._infos=null,this._staffId=null,AlphaTab.Rendering.BarRendererFactory.call(this),this._infos=t,this._staffId=e,this.IsInAccolade=!1},AlphaTab.Rendering.EffectBarRendererFactory.prototype={get_StaffId:function(){return this._staffId},Create:function(e,t,a){return new AlphaTab.Rendering.EffectBarRenderer(e,t,this._infos)}},$Inherit(AlphaTab.Rendering.EffectBarRendererFactory,AlphaTab.Rendering.BarRendererFactory),AlphaTab.Rendering.Effects=AlphaTab.Rendering.Effects||{},AlphaTab.Rendering.Effects.BeatVibratoEffectInfo=function(){},AlphaTab.Rendering.Effects.BeatVibratoEffectInfo.prototype={get_EffectId:function(){return"beat-vibrato"},get_HideOnMultiTrack:function(){return!1},get_CanShareBand:function(){return!0},get_SizingMode:function(){return AlphaTab.Rendering.EffectBarGlyphSizing.GroupedOnBeat},ShouldCreateGlyph:function(e){return e.Vibrato!=AlphaTab.Model.VibratoType.None},CreateNewGlyph:function(e,t){return new AlphaTab.Rendering.Glyphs.VibratoGlyph(0,5*e.get_Scale(),1.4)},CanExpand:function(e,t){return!0}},AlphaTab.Rendering.Effects.ChordsEffectInfo=function(){},AlphaTab.Rendering.Effects.ChordsEffectInfo.prototype={get_EffectId:function(){return"chords"},get_HideOnMultiTrack:function(){return!1},get_CanShareBand:function(){return!0},get_SizingMode:function(){return AlphaTab.Rendering.EffectBarGlyphSizing.SingleOnBeat},ShouldCreateGlyph:function(e){return e.get_HasChord()},CreateNewGlyph:function(e,t){return new AlphaTab.Rendering.Glyphs.TextGlyph(0,0,t.get_Chord().Name,e.get_Resources().EffectFont,AlphaTab.Platform.Model.TextAlign.Left)},CanExpand:function(e,t){return!1}},AlphaTab.Rendering.Effects.CrescendoEffectInfo=function(){},AlphaTab.Rendering.Effects.CrescendoEffectInfo.prototype={get_EffectId:function(){return"crescendo"},get_HideOnMultiTrack:function(){return!1},get_CanShareBand:function(){return!0},get_SizingMode:function(){return AlphaTab.Rendering.EffectBarGlyphSizing.GroupedOnBeat},ShouldCreateGlyph:function(e){return e.Crescendo!=AlphaTab.Model.CrescendoType.None},CreateNewGlyph:function(e,t){return new AlphaTab.Rendering.Glyphs.CrescendoGlyph(0,0,t.Crescendo)},CanExpand:function(e,t){return e.Crescendo==t.Crescendo}},AlphaTab.Rendering.Glyphs.EffectGlyph=function(e,t){this.Beat=null,this.NextGlyph=null,this.PreviousGlyph=null,this.Height=0,AlphaTab.Rendering.Glyphs.Glyph.call(this,e,t)},$Inherit(AlphaTab.Rendering.Glyphs.EffectGlyph,AlphaTab.Rendering.Glyphs.Glyph),AlphaTab.Rendering.Effects.DummyEffectGlyph=function(e,t,a){this._s=null,AlphaTab.Rendering.Glyphs.EffectGlyph.call(this,e,t),this._s=a},AlphaTab.Rendering.Effects.DummyEffectGlyph.prototype={DoLayout:function(){this.Width=20*this.get_Scale()},Paint:function(e,t,a){var i=this.Renderer.get_Resources();a.set_Color(i.MainGlyphColor),a.StrokeRect(e+this.X,t+this.Y,this.Width,20*this.get_Scale()),a.set_Font(i.TablatureFont),a.FillText(this._s,e+this.X,t+this.Y)}},$Inherit(AlphaTab.Rendering.Effects.DummyEffectGlyph,AlphaTab.Rendering.Glyphs.EffectGlyph),AlphaTab.Rendering.Effects.DynamicsEffectInfo=function(){},AlphaTab.Rendering.Effects.DynamicsEffectInfo.prototype={get_EffectId:function(){return"dynamics"},get_HideOnMultiTrack:function(){return!1},get_CanShareBand:function(){return!1},get_SizingMode:function(){return AlphaTab.Rendering.EffectBarGlyphSizing.SingleOnBeat},ShouldCreateGlyph:function(e){return 0==e.Voice.Index&&(0==e.Index&&0==e.Voice.Bar.Index||null!=e.PreviousBeat&&e.Dynamic!=e.PreviousBeat.Dynamic)},CreateNewGlyph:function(e,t){return new AlphaTab.Rendering.Glyphs.DynamicsGlyph(0,0,t.Dynamic)},CanExpand:function(e,t){return!0}},AlphaTab.Rendering.Effects.FadeInEffectInfo=function(){},AlphaTab.Rendering.Effects.FadeInEffectInfo.prototype={get_EffectId:function(){return"fade-in"},get_HideOnMultiTrack:function(){return!1},get_CanShareBand:function(){return!0},get_SizingMode:function(){return AlphaTab.Rendering.EffectBarGlyphSizing.SingleOnBeat},ShouldCreateGlyph:function(e){return e.FadeIn},CreateNewGlyph:function(e,t){return new AlphaTab.Rendering.Glyphs.FadeInGlyph(0,0)},CanExpand:function(e,t){return!0}},AlphaTab.Rendering.Effects.NoteEffectInfoBase=function(){this.LastCreateInfo=null},AlphaTab.Rendering.Effects.NoteEffectInfoBase.prototype={ShouldCreateGlyph:function(e){this.LastCreateInfo=[];for(var t=0,a=e.Notes.length;t<a;t++){var i=e.Notes[t];this.ShouldCreateGlyphForNote(i)&&this.LastCreateInfo.push(i)}return this.LastCreateInfo.length>0},get_HideOnMultiTrack:function(){return!1},get_CanShareBand:function(){return!0},CanExpand:function(e,t){return!0}},AlphaTab.Rendering.Effects.HarmonicsEffectInfo=function(){this._beat=null,this._beatType=AlphaTab.Model.HarmonicType.None,AlphaTab.Rendering.Effects.NoteEffectInfoBase.call(this)},AlphaTab.Rendering.Effects.HarmonicsEffectInfo.prototype={get_EffectId:function(){return"harmonics"},ShouldCreateGlyphForNote:function(e){return!!e.get_IsHarmonic()&&((e.Beat!=this._beat||e.HarmonicType>this._beatType)&&(this._beat=e.Beat,this._beatType=e.HarmonicType),!0)},get_SizingMode:function(){return AlphaTab.Rendering.EffectBarGlyphSizing.SingleOnBeat},CreateNewGlyph:function(e,t){return new AlphaTab.Rendering.Glyphs.TextGlyph(0,0,AlphaTab.Rendering.Effects.HarmonicsEffectInfo.HarmonicToString(this._beatType),e.get_Resources().EffectFont,AlphaTab.Platform.Model.TextAlign.Left)}},AlphaTab.Rendering.Effects.HarmonicsEffectInfo.HarmonicToString=function(e){switch(e){case AlphaTab.Model.HarmonicType.Natural:return"N.H.";case AlphaTab.Model.HarmonicType.Artificial:return"A.H.";case AlphaTab.Model.HarmonicType.Pinch:return"P.H.";case AlphaTab.Model.HarmonicType.Tap:return"T.H.";case AlphaTab.Model.HarmonicType.Semi:return"S.H.";case AlphaTab.Model.HarmonicType.Feedback:return"Fdbk."}return""},$Inherit(AlphaTab.Rendering.Effects.HarmonicsEffectInfo,AlphaTab.Rendering.Effects.NoteEffectInfoBase),AlphaTab.Rendering.Effects.LetRingEffectInfo=function(){AlphaTab.Rendering.Effects.NoteEffectInfoBase.call(this)},AlphaTab.Rendering.Effects.LetRingEffectInfo.prototype={get_EffectId:function(){return"let-ring"},get_CanShareBand:function(){return!1},ShouldCreateGlyphForNote:function(e){return e.IsLetRing},get_SizingMode:function(){return AlphaTab.Rendering.EffectBarGlyphSizing.GroupedOnBeat},CreateNewGlyph:function(e,t){return new AlphaTab.Rendering.Glyphs.LineRangedGlyph("LetRing")}},$Inherit(AlphaTab.Rendering.Effects.LetRingEffectInfo,AlphaTab.Rendering.Effects.NoteEffectInfoBase),AlphaTab.Rendering.Effects.MarkerEffectInfo=function(){},AlphaTab.Rendering.Effects.MarkerEffectInfo.prototype={get_EffectId:function(){return"marker"},get_HideOnMultiTrack:function(){return!0},get_CanShareBand:function(){return!0},get_SizingMode:function(){return AlphaTab.Rendering.EffectBarGlyphSizing.SinglePreBeat},ShouldCreateGlyph:function(e){return 0==e.Voice.Bar.Staff.Index&&0==e.Voice.Index&&0==e.Index&&e.Voice.Bar.get_MasterBar().get_IsSectionStart()},CreateNewGlyph:function(e,t){return new AlphaTab.Rendering.Glyphs.TextGlyph(0,0,t.Voice.Bar.get_MasterBar().Section.Text,e.get_Resources().MarkerFont,AlphaTab.Platform.Model.TextAlign.Left)},CanExpand:function(e,t){return!0}},AlphaTab.Rendering.Effects.NoteVibratoEffectInfo=function(){AlphaTab.Rendering.Effects.NoteEffectInfoBase.call(this)},AlphaTab.Rendering.Effects.NoteVibratoEffectInfo.prototype={get_EffectId:function(){return"note-vibrato"},ShouldCreateGlyphForNote:function(e){return e.Vibrato!=AlphaTab.Model.VibratoType.None||e.IsTieDestination&&e.TieOrigin.Vibrato!=AlphaTab.Model.VibratoType.None},get_SizingMode:function(){return AlphaTab.Rendering.EffectBarGlyphSizing.GroupedOnBeat},CreateNewGlyph:function(e,t){return new AlphaTab.Rendering.Glyphs.VibratoGlyph(0,5*e.get_Scale(),1.2)}},$Inherit(AlphaTab.Rendering.Effects.NoteVibratoEffectInfo,AlphaTab.Rendering.Effects.NoteEffectInfoBase),AlphaTab.Rendering.Effects.CapoEffectInfo=function(){},AlphaTab.Rendering.Effects.CapoEffectInfo.prototype={get_EffectId:function(){return"capo"},get_HideOnMultiTrack:function(){return!1},get_CanShareBand:function(){return!1},get_SizingMode:function(){return AlphaTab.Rendering.EffectBarGlyphSizing.SingleOnBeat},ShouldCreateGlyph:function(e){return 0==e.Index&&0==e.Voice.Bar.Index&&0!=e.Voice.Bar.Staff.Track.Capo},CreateNewGlyph:function(e,t){return new AlphaTab.Rendering.Glyphs.TextGlyph(0,0,"Capo. fret "+t.Voice.Bar.Staff.Track.Capo,e.get_Resources().EffectFont,AlphaTab.Platform.Model.TextAlign.Left)},CanExpand:function(e,t){return!1}},AlphaTab.Rendering.Effects.PalmMuteEffectInfo=function(){AlphaTab.Rendering.Effects.NoteEffectInfoBase.call(this)},AlphaTab.Rendering.Effects.PalmMuteEffectInfo.prototype={get_EffectId:function(){return"palm-mute"},ShouldCreateGlyphForNote:function(e){return e.IsPalmMute},get_SizingMode:function(){return AlphaTab.Rendering.EffectBarGlyphSizing.GroupedOnBeat},CreateNewGlyph:function(e,t){return new AlphaTab.Rendering.Glyphs.LineRangedGlyph("P.M.")}},$Inherit(AlphaTab.Rendering.Effects.PalmMuteEffectInfo,AlphaTab.Rendering.Effects.NoteEffectInfoBase),AlphaTab.Rendering.Effects.PickStrokeEffectInfo=function(){},AlphaTab.Rendering.Effects.PickStrokeEffectInfo.prototype={get_EffectId:function(){return"pick-stroke"},get_HideOnMultiTrack:function(){return!1},get_CanShareBand:function(){return!0},get_SizingMode:function(){return AlphaTab.Rendering.EffectBarGlyphSizing.SingleOnBeat},ShouldCreateGlyph:function(e){return e.PickStroke!=AlphaTab.Model.PickStrokeType.None},CreateNewGlyph:function(e,t){return new AlphaTab.Rendering.Glyphs.PickStrokeGlyph(0,0,t.PickStroke)},CanExpand:function(e,t){return!0}},AlphaTab.Rendering.Effects.TapEffectInfo=function(){},AlphaTab.Rendering.Effects.TapEffectInfo.prototype={get_EffectId:function(){return"tap"},get_HideOnMultiTrack:function(){return!1},get_CanShareBand:function(){return!0},get_SizingMode:function(){return AlphaTab.Rendering.EffectBarGlyphSizing.SingleOnBeat},ShouldCreateGlyph:function(e){return e.Slap||e.Pop||e.Tap},CreateNewGlyph:function(e,t){var a=e.get_Resources();return t.Slap?new AlphaTab.Rendering.Glyphs.TextGlyph(0,0,"S",a.EffectFont,AlphaTab.Platform.Model.TextAlign.Left):t.Pop?new AlphaTab.Rendering.Glyphs.TextGlyph(0,0,"P",a.EffectFont,AlphaTab.Platform.Model.TextAlign.Left):new AlphaTab.Rendering.Glyphs.TextGlyph(0,0,"T",a.EffectFont,AlphaTab.Platform.Model.TextAlign.Left)},CanExpand:function(e,t){return!0}},AlphaTab.Rendering.Effects.TempoEffectInfo=function(){},AlphaTab.Rendering.Effects.TempoEffectInfo.prototype={get_EffectId:function(){return"tempo"},get_HideOnMultiTrack:function(){return!0},get_CanShareBand:function(){return!1},get_SizingMode:function(){return AlphaTab.Rendering.EffectBarGlyphSizing.SinglePreBeat},ShouldCreateGlyph:function(e){return 0==e.Voice.Bar.Staff.Index&&0==e.Voice.Index&&0==e.Index&&(null!=e.Voice.Bar.get_MasterBar().TempoAutomation||0==e.Voice.Bar.Index)},CreateNewGlyph:function(e,t){var a;return a=null!=t.Voice.Bar.get_MasterBar().TempoAutomation?0|t.Voice.Bar.get_MasterBar().TempoAutomation.Value:t.Voice.Bar.Staff.Track.Score.Tempo,new AlphaTab.Rendering.Glyphs.TempoGlyph(0,0,a)},CanExpand:function(e,t){return!0}},AlphaTab.Rendering.Effects.LyricsEffectInfo=function(){},AlphaTab.Rendering.Effects.LyricsEffectInfo.prototype={get_EffectId:function(){return"lyrics"},get_HideOnMultiTrack:function(){return!1},get_CanShareBand:function(){return!1},get_SizingMode:function(){return AlphaTab.Rendering.EffectBarGlyphSizing.SingleOnBeat},ShouldCreateGlyph:function(e){return null!=e.Lyrics},CreateNewGlyph:function(e,t){return new AlphaTab.Rendering.Glyphs.LyricsGlyph(0,0,t.Lyrics,e.get_Resources().EffectFont,AlphaTab.Platform.Model.TextAlign.Center)},CanExpand:function(e,t){return!0}},AlphaTab.Rendering.Effects.TextEffectInfo=function(){},AlphaTab.Rendering.Effects.TextEffectInfo.prototype={get_EffectId:function(){return"text"},get_HideOnMultiTrack:function(){return!1},get_CanShareBand:function(){return!1},get_SizingMode:function(){return AlphaTab.Rendering.EffectBarGlyphSizing.SingleOnBeat},ShouldCreateGlyph:function(e){return!AlphaTab.Platform.Std.IsNullOrWhiteSpace(e.Text)},CreateNewGlyph:function(e,t){return new AlphaTab.Rendering.Glyphs.TextGlyph(0,0,t.Text,e.get_Resources().EffectFont,AlphaTab.Platform.Model.TextAlign.Left)},CanExpand:function(e,t){return!0}},AlphaTab.Rendering.Effects.TrillEffectInfo=function(){AlphaTab.Rendering.Effects.NoteEffectInfoBase.call(this)},AlphaTab.Rendering.Effects.TrillEffectInfo.prototype={get_EffectId:function(){return"trill"},ShouldCreateGlyphForNote:function(e){return e.get_IsTrill()},get_SizingMode:function(){return AlphaTab.Rendering.EffectBarGlyphSizing.SingleOnBeat},CreateNewGlyph:function(e,t){return new AlphaTab.Rendering.Glyphs.TrillGlyph(0,0)}},$Inherit(AlphaTab.Rendering.Effects.TrillEffectInfo,AlphaTab.Rendering.Effects.NoteEffectInfoBase),AlphaTab.Rendering.Effects.AlternateEndingsEffectInfo=function(){},AlphaTab.Rendering.Effects.AlternateEndingsEffectInfo.prototype={get_EffectId:function(){return"alternate-feel"},get_HideOnMultiTrack:function(){return!0},get_CanShareBand:function(){return!1},get_SizingMode:function(){return AlphaTab.Rendering.EffectBarGlyphSizing.FullBar},ShouldCreateGlyph:function(e){return 0==e.Index&&0!=e.Voice.Bar.get_MasterBar().AlternateEndings},CreateNewGlyph:function(e,t){return new AlphaTab.Rendering.Glyphs.AlternateEndingsGlyph(0,0,t.Voice.Bar.get_MasterBar().AlternateEndings)},CanExpand:function(e,t){return!0}},AlphaTab.Rendering.Effects.TripletFeelEffectInfo=function(){},AlphaTab.Rendering.Effects.TripletFeelEffectInfo.prototype={get_EffectId:function(){return"triplet-feel"},get_HideOnMultiTrack:function(){return!0},get_CanShareBand:function(){return!1},get_SizingMode:function(){return AlphaTab.Rendering.EffectBarGlyphSizing.SinglePreBeat},ShouldCreateGlyph:function(e){return 0==e.Index&&(0==e.Voice.Bar.get_MasterBar().Index&&e.Voice.Bar.get_MasterBar().TripletFeel!=AlphaTab.Model.TripletFeel.NoTripletFeel||e.Voice.Bar.get_MasterBar().Index>0&&e.Voice.Bar.get_MasterBar().TripletFeel!=e.Voice.Bar.get_MasterBar().PreviousMasterBar.TripletFeel)},CreateNewGlyph:function(e,t){return new AlphaTab.Rendering.Glyphs.TripletFeelGlyph(t.Voice.Bar.get_MasterBar().TripletFeel)},CanExpand:function(e,t){return!0}},AlphaTab.Rendering.Glyphs.MusicFontGlyph=function(e,t,a,i){this.GlyphScale=0,this._symbol=AlphaTab.Rendering.Glyphs.MusicFontSymbol.None,AlphaTab.Rendering.Glyphs.EffectGlyph.call(this,e,t),this.GlyphScale=a,this._symbol=i},AlphaTab.Rendering.Glyphs.MusicFontGlyph.prototype={Paint:function(e,t,a){a.FillMusicFontSymbol(e+this.X,t+this.Y,this.GlyphScale*this.get_Scale(),this._symbol)}},$Inherit(AlphaTab.Rendering.Glyphs.MusicFontGlyph,AlphaTab.Rendering.Glyphs.EffectGlyph),AlphaTab.Rendering.Glyphs.AccentuationGlyph=function(e,t,a){AlphaTab.Rendering.Glyphs.MusicFontGlyph.call(this,e,t,1,AlphaTab.Rendering.Glyphs.AccentuationGlyph.GetSymbol(a))},AlphaTab.Rendering.Glyphs.AccentuationGlyph.prototype={DoLayout:function(){this.Width=9*this.get_Scale()}},AlphaTab.Rendering.Glyphs.AccentuationGlyph.GetSymbol=function(e){switch(e){case AlphaTab.Model.AccentuationType.None:return AlphaTab.Rendering.Glyphs.MusicFontSymbol.None;case AlphaTab.Model.AccentuationType.Normal:return AlphaTab.Rendering.Glyphs.MusicFontSymbol.Accentuation;case AlphaTab.Model.AccentuationType.Heavy:return AlphaTab.Rendering.Glyphs.MusicFontSymbol.HeavyAccentuation;default:return AlphaTab.Rendering.Glyphs.MusicFontSymbol.None}},$Inherit(AlphaTab.Rendering.Glyphs.AccentuationGlyph,AlphaTab.Rendering.Glyphs.MusicFontGlyph),AlphaTab.Rendering.Glyphs.GlyphGroup=function(e,t){this.Glyphs=null,AlphaTab.Rendering.Glyphs.Glyph.call(this,e,t)},AlphaTab.Rendering.Glyphs.GlyphGroup.prototype={get_IsEmpty:function(){return null==this.Glyphs||0==this.Glyphs.length},DoLayout:function(){if(null!=this.Glyphs&&0!=this.Glyphs.length){for(var e=0,t=0,a=this.Glyphs.length;t<a;t++){var i=this.Glyphs[t];i.Renderer=this.Renderer,i.DoLayout(),e=Math.max(e,i.Width)}this.Width=e}else this.Width=0},AddGlyph:function(e){null==this.Glyphs&&(this.Glyphs=[]),this.Glyphs.push(e)},Paint:function(e,t,a){var i=this.Glyphs;if(null!=i&&0!=i.length)for(var n=0,r=i.length,l=i[n];n<r;n++,l=i[n])l.Paint(e+this.X,t+this.Y,a)}},$Inherit(AlphaTab.Rendering.Glyphs.GlyphGroup,AlphaTab.Rendering.Glyphs.Glyph),AlphaTab.Rendering.Glyphs.AccidentalGroupGlyph=function(){AlphaTab.Rendering.Glyphs.GlyphGroup.call(this,0,0)},AlphaTab.Rendering.Glyphs.AccidentalGroupGlyph.prototype={DoLayout:function(){if(null!=this.Glyphs){this.Glyphs.sort($CreateAnonymousDelegate(this,function(e,t){return e.Y-t.Y}));var e=[];e.push(-3e3);for(var t=21*this.get_Scale(),a=0,i=this.Glyphs.length;a<i;a++){(s=this.Glyphs[a]).Renderer=this.Renderer,s.DoLayout();for(var n=0;e[n]>s.Y;)++n==e.length&&e.push(-3e3);s.X=n,e[n]=s.Y+t}var r=8*this.get_Scale(),l=2*this.get_Scale();0==this.Glyphs.length?this.Width=0:this.Width=l+r*e.length;for(var a=0,i=this.Glyphs.length;a<i;a++){var s=this.Glyphs[a];s.X=l+(this.Width-(s.X+1)*r)}}else this.Width=0}},$StaticConstructor(function(){AlphaTab.Rendering.Glyphs.AccidentalGroupGlyph.NonReserved=-3e3}),$Inherit(AlphaTab.Rendering.Glyphs.AccidentalGroupGlyph,AlphaTab.Rendering.Glyphs.GlyphGroup),AlphaTab.Rendering.Glyphs.AlternateEndingsGlyph=function(e,t,a){this._endings=null,this._endingsString=null,AlphaTab.Rendering.Glyphs.EffectGlyph.call(this,e,t),this._endings=[];for(var i=0;i<8;i++)0!=(a&1<<i)&&this._endings.push(i)},AlphaTab.Rendering.Glyphs.AlternateEndingsGlyph.prototype={DoLayout:function(){AlphaTab.Rendering.Glyphs.Glyph.prototype.DoLayout.call(this),this.Height=this.Renderer.get_Resources().WordsFont.Size+(3*this.get_Scale()+2);for(var e=new String,t=0,a=this._endings.length;t<a;t++)e+=this._endings[t]+1,e+=". ";this._endingsString=e},Paint:function(e,t,a){if(AlphaTab.Rendering.Glyphs.Glyph.prototype.Paint.call(this,e,t,a),this._endings.length>0){var i=this.Renderer.get_Resources();a.set_Font(i.WordsFont),a.MoveTo(e+this.X,t+this.Y+this.Height),a.LineTo(e+this.X,t+this.Y),a.LineTo(e+this.X+this.Width,t+this.Y),a.Stroke(),a.FillText(this._endingsString,e+this.X+3*this.get_Scale(),t+this.Y*this.get_Scale())}}},$StaticConstructor(function(){AlphaTab.Rendering.Glyphs.AlternateEndingsGlyph.Padding=3}),$Inherit(AlphaTab.Rendering.Glyphs.AlternateEndingsGlyph,AlphaTab.Rendering.Glyphs.EffectGlyph),AlphaTab.Rendering.Glyphs.BarNumberGlyph=function(e,t,a){this._number=0,AlphaTab.Rendering.Glyphs.Glyph.call(this,e,t),this._number=a},AlphaTab.Rendering.Glyphs.BarNumberGlyph.prototype={DoLayout:function(){this.Renderer.ScoreRenderer.Canvas.set_Font(this.Renderer.get_Resources().BarNumberFont),this.Width=this.Renderer.ScoreRenderer.Canvas.MeasureText(this._number.toString())+5*this.get_Scale()},Paint:function(e,t,a){if(this.Renderer.Staff.IsFirstInAccolade){var i=this.Renderer.get_Resources();a.set_Color(i.BarNumberColor),a.set_Font(i.BarNumberFont),a.FillText(this._number.toString(),e+this.X,t+this.Y),a.set_Color(i.MainGlyphColor)}}},$Inherit(AlphaTab.Rendering.Glyphs.BarNumberGlyph,AlphaTab.Rendering.Glyphs.Glyph),AlphaTab.Rendering.Glyphs.BarSeperatorGlyph=function(e,t){AlphaTab.Rendering.Glyphs.Glyph.call(this,e,t)},AlphaTab.Rendering.Glyphs.BarSeperatorGlyph.prototype={DoLayout:function(){this.Width=8*this.get_Scale()},Paint:function(e,t,a){var i=4*this.get_Scale(),n=t+this.Y+this.Renderer.TopPadding,r=t+this.Y+this.Renderer.Height-this.Renderer.BottomPadding,l=e+this.X|0,s=r-n;this.Renderer.get_IsLast()?(a.FillRect(l,n,this.get_Scale(),s),a.FillRect(l+this.Width-i,n,i,s)):(a.FillRect(l+this.Width,n,this.get_Scale(),s),this.Renderer.Bar.get_MasterBar().IsDoubleBar&&a.FillRect(l+this.Width-5*this.get_Scale(),n,this.get_Scale(),s))}},$Inherit(AlphaTab.Rendering.Glyphs.BarSeperatorGlyph,AlphaTab.Rendering.Glyphs.Glyph),AlphaTab.Rendering.Glyphs.BeamGlyph=function(e,t,a,i,n){AlphaTab.Rendering.Glyphs.MusicFontGlyph.call(this,e,t,n?.75:1,AlphaTab.Rendering.Glyphs.BeamGlyph.GetSymbol(a,i,n))},AlphaTab.Rendering.Glyphs.BeamGlyph.prototype={DoLayout:function(){this.Width=0}},AlphaTab.Rendering.Glyphs.BeamGlyph.GetSymbol=function(e,t,a){if(t==AlphaTab.Rendering.Utils.BeamDirection.Up)switch(e){case AlphaTab.Model.Duration.Eighth:return AlphaTab.Rendering.Glyphs.MusicFontSymbol.FooterUpEighth;case AlphaTab.Model.Duration.Sixteenth:return AlphaTab.Rendering.Glyphs.MusicFontSymbol.FooterUpSixteenth;case AlphaTab.Model.Duration.ThirtySecond:return AlphaTab.Rendering.Glyphs.MusicFontSymbol.FooterUpThirtySecond;case AlphaTab.Model.Duration.SixtyFourth:return AlphaTab.Rendering.Glyphs.MusicFontSymbol.FooterUpSixtyFourth;case AlphaTab.Model.Duration.OneHundredTwentyEighth:return AlphaTab.Rendering.Glyphs.MusicFontSymbol.FooterUpOneHundredTwentyEighth;case AlphaTab.Model.Duration.TwoHundredFiftySixth:return AlphaTab.Rendering.Glyphs.MusicFontSymbol.FooterUpTwoHundredFiftySixth;default:return AlphaTab.Rendering.Glyphs.MusicFontSymbol.FooterUpEighth}else switch(e){case AlphaTab.Model.Duration.Eighth:return AlphaTab.Rendering.Glyphs.MusicFontSymbol.FooterDownEighth;case AlphaTab.Model.Duration.Sixteenth:return AlphaTab.Rendering.Glyphs.MusicFontSymbol.FooterDownSixteenth;case AlphaTab.Model.Duration.ThirtySecond:return AlphaTab.Rendering.Glyphs.MusicFontSymbol.FooterDownThirtySecond;case AlphaTab.Model.Duration.SixtyFourth:return AlphaTab.Rendering.Glyphs.MusicFontSymbol.FooterDownSixtyFourth;case AlphaTab.Model.Duration.OneHundredTwentyEighth:case AlphaTab.Model.Duration.TwoHundredFiftySixth:return AlphaTab.Rendering.Glyphs.MusicFontSymbol.FooterDownOneHundredTwentyEighth;default:return AlphaTab.Rendering.Glyphs.MusicFontSymbol.FooterDownEighth}},$Inherit(AlphaTab.Rendering.Glyphs.BeamGlyph,AlphaTab.Rendering.Glyphs.MusicFontGlyph),AlphaTab.Rendering.Glyphs.BeatContainerGlyph=function(e,t){this.VoiceContainer=null,this.Beat=null,this.PreNotes=null,this.OnNotes=null,this.Ties=null,this.MinWidth=0,this.OnTimeX=0,AlphaTab.Rendering.Glyphs.Glyph.call(this,0,0),this.Beat=e,this.Ties=[],this.VoiceContainer=t},AlphaTab.Rendering.Glyphs.BeatContainerGlyph.prototype={RegisterLayoutingInfo:function(e){var t=this.PreNotes.Width+this.OnNotes.Width/2;e.AddBeatSpring(this.Beat,this.MinWidth,t),e.SetPreBeatSize(this.Beat,this.PreNotes.Width),e.SetOnBeatSize(this.Beat,this.OnNotes.Width)},ApplyLayoutingInfo:function(e){this.PreNotes.Width=e.GetPreBeatSize(this.Beat),this.OnNotes.Width=e.GetOnBeatSize(this.Beat),this.OnNotes.X=this.PreNotes.X+this.PreNotes.Width,this.OnTimeX=this.OnNotes.X+this.OnNotes.Width/2,this.OnNotes.UpdateBeamingHelper()},DoLayout:function(){this.PreNotes.X=0,this.PreNotes.Renderer=this.Renderer,this.PreNotes.Container=this,this.PreNotes.DoLayout(),this.OnNotes.X=this.PreNotes.X+this.PreNotes.Width,this.OnNotes.Renderer=this.Renderer,this.OnNotes.Container=this,this.OnNotes.DoLayout();for(var e=this.Beat.Notes.length-1;e>=0;)this.CreateTies(this.Beat.Notes[e--]);if(this.MinWidth=this.PreNotes.Width+this.OnNotes.Width,!this.Beat.get_IsRest())if(1==this.OnNotes.BeamingHelper.Beats.length)this.Beat.Duration>=AlphaTab.Model.Duration.Eighth&&(this.MinWidth+=20*this.get_Scale());else switch(this.Beat.Duration){case AlphaTab.Model.Duration.OneHundredTwentyEighth:case AlphaTab.Model.Duration.TwoHundredFiftySixth:this.MinWidth+=10*this.get_Scale()}this.Width=this.MinWidth,this.OnTimeX=this.OnNotes.X+this.OnNotes.Width/2},ScaleToWidth:function(e){this.OnNotes.UpdateBeamingHelper(),this.Width=e},CreateTies:function(e){},Paint:function(e,t,a){if(!(this.Beat.Voice.IsEmpty||this.PreNotes.get_IsEmpty()&&this.OnNotes.get_IsEmpty()&&0==this.Ties.length)){a.BeginGroup("b"+this.Beat.Id);a.get_Color();this.PreNotes.Paint(e+this.X,t+this.Y,a),this.OnNotes.Paint(e+this.X,t+this.Y,a);for(var i=e-this.VoiceContainer.X-this.Renderer.X,n=t-this.VoiceContainer.Y-this.Renderer.Y,r=0,l=this.Ties.length;r<l;r++){var s=this.Ties[r];s.Renderer=this.Renderer,s.Paint(i,n,a)}a.EndGroup()}}},$Inherit(AlphaTab.Rendering.Glyphs.BeatContainerGlyph,AlphaTab.Rendering.Glyphs.Glyph),AlphaTab.Rendering.Glyphs.BeatGlyphBase=function(){this.Container=null,AlphaTab.Rendering.Glyphs.GlyphGroup.call(this,0,0)},AlphaTab.Rendering.Glyphs.BeatGlyphBase.prototype={DoLayout:function(){var e=0;if(null!=this.Glyphs)for(var t=0,a=this.Glyphs.length;t<a;t++){var i=this.Glyphs[t];i.X=e,i.Renderer=this.Renderer,i.DoLayout(),e+=i.Width}this.Width=e},NoteLoop:function(e){for(var t=this.Container.Beat.Notes.length-1;t>=0;t--)e(this.Container.Beat.Notes[t])}},$Inherit(AlphaTab.Rendering.Glyphs.BeatGlyphBase,AlphaTab.Rendering.Glyphs.GlyphGroup),AlphaTab.Rendering.Glyphs.BeatOnNoteGlyphBase=function(){this.BeamingHelper=null,AlphaTab.Rendering.Glyphs.BeatGlyphBase.call(this)},AlphaTab.Rendering.Glyphs.BeatOnNoteGlyphBase.prototype={UpdateBeamingHelper:function(){}},$Inherit(AlphaTab.Rendering.Glyphs.BeatOnNoteGlyphBase,AlphaTab.Rendering.Glyphs.BeatGlyphBase),AlphaTab.Rendering.Glyphs.BendGlyph=function(e,t){this._note=null,this._bendValueHeight=0,AlphaTab.Rendering.Glyphs.Glyph.call(this,0,0),this._note=e,this._bendValueHeight=t},AlphaTab.Rendering.Glyphs.BendGlyph.prototype={Paint:function(e,t,a){for(var i=this.Width/60,n=0,r=0,l=this._note.BendPoints.length;r<l;r++)this._note.BendPoints[r].Value>n&&(n=this._note.BendPoints[r].Value);e+=this.X,t+=this.Y,a.BeginPath();for(var r=0,l=this._note.BendPoints.length-1;r<l;r++){var s=this._note.BendPoints[r],o=this._note.BendPoints[r+1];0!=r||0==s.Value||this._note.IsTieDestination||this.PaintBend(new AlphaTab.Model.BendPoint(0,0),s,e,t,i,a),s.Value==o.Value&&r==this._note.BendPoints.length-2||this.PaintBend(s,o,e,t,i,a)}},PaintBend:function(e,t,a,i,n,r){var l=this.Renderer,s=this.Renderer.get_Resources(),o=l.get_LineOffset()/2,h=a+n*e.Offset,p=i-this._bendValueHeight*e.Value;0==e.Value?p+=l.GetNoteY(this._note):p+=o;var d=a+n*t.Offset,u=i-this._bendValueHeight*t.Value;0==t.Value?u+=l.GetNoteY(this._note):u+=o;var c=0,T=6*this.get_Scale();if(t.Value>e.Value?(r.BeginPath(),r.MoveTo(d,u),r.LineTo(d-.5*T,u+T),r.LineTo(d+.5*T,u+T),r.ClosePath(),r.Fill(),c=T):t.Value!=e.Value&&(r.BeginPath(),r.MoveTo(d,u),r.LineTo(d-.5*T,u-T),r.LineTo(d+.5*T,u-T),r.ClosePath(),r.Fill(),c=-T),r.Stroke(),e.Value==t.Value?(r.MoveTo(h,p),r.LineTo(d,u),r.Stroke()):d>h?(r.MoveTo(h,p),r.BezierCurveTo(d,p,d,u+c,d,u+c),r.Stroke()):(r.MoveTo(h,p),r.LineTo(d,u),r.Stroke()),0!=t.Value){var g=t.Value,f=t.Value>e.Value,b="";if(4==(g=Math.abs(g))&&f)b="full",g-=4;else if(g>=4||g<=-4){var A=g/4|0;b+=A,g-=4*A}if(g>0&&(b+=AlphaTab.Rendering.Glyphs.BendGlyph.GetFractionSign(g)),""!=b){f||(b="-"+b),r.set_Font(s.TablatureFont);var y=r.MeasureText(b),m=f?u-s.TablatureFont.Size-2*this.get_Scale():u+2*this.get_Scale(),S=d-y/2;r.FillText(b,S,m)}}}},AlphaTab.Rendering.Glyphs.BendGlyph.GetFractionSign=function(e){switch(e){case 1:return"";case 2:return"";case 3:return"";default:return e+"/ 4"}},$Inherit(AlphaTab.Rendering.Glyphs.BendGlyph,AlphaTab.Rendering.Glyphs.Glyph),AlphaTab.Rendering.Glyphs.ChineseCymbalGlyph=function(e,t,a){this._isGrace=!1,AlphaTab.Rendering.Glyphs.MusicFontGlyph.call(this,e,t,a?.75:1,AlphaTab.Rendering.Glyphs.MusicFontSymbol.NoteHarmonic),this._isGrace=a},AlphaTab.Rendering.Glyphs.ChineseCymbalGlyph.prototype={DoLayout:function(){this.Width=9*(this._isGrace?.75:1)*this.get_Scale()}},$Inherit(AlphaTab.Rendering.Glyphs.ChineseCymbalGlyph,AlphaTab.Rendering.Glyphs.MusicFontGlyph),AlphaTab.Rendering.Glyphs.CircleGlyph=function(e,t,a){this._size=0,AlphaTab.Rendering.Glyphs.Glyph.call(this,e,t),this._size=a},AlphaTab.Rendering.Glyphs.CircleGlyph.prototype={DoLayout:function(){this.Width=this._size+3*this.get_Scale()},Paint:function(e,t,a){a.FillCircle(e+this.X,t+this.Y,this._size)}},$Inherit(AlphaTab.Rendering.Glyphs.CircleGlyph,AlphaTab.Rendering.Glyphs.Glyph),AlphaTab.Rendering.Glyphs.ClefGlyph=function(e,t,a,i){this._clef=AlphaTab.Model.Clef.Neutral,this._clefOttavia=AlphaTab.Model.ClefOttavia._15ma,AlphaTab.Rendering.Glyphs.MusicFontGlyph.call(this,e,t,1,AlphaTab.Rendering.Glyphs.ClefGlyph.GetSymbol(a)),this._clef=a,this._clefOttavia=i},AlphaTab.Rendering.Glyphs.ClefGlyph.prototype={DoLayout:function(){switch(this._clef){case AlphaTab.Model.Clef.Neutral:this.Width=15*this.get_Scale();break;case AlphaTab.Model.Clef.C3:case AlphaTab.Model.Clef.C4:case AlphaTab.Model.Clef.F4:case AlphaTab.Model.Clef.G2:this.Width=28*this.get_Scale()}},Paint:function(e,t,a){AlphaTab.Rendering.Glyphs.MusicFontGlyph.prototype.Paint.call(this,e,t,a);var i,n=!1;switch(this._clefOttavia){case AlphaTab.Model.ClefOttavia._15ma:i=new AlphaTab.Rendering.Glyphs.NumberGlyph(this.Width/2,0,15,.5),n=!0;break;case AlphaTab.Model.ClefOttavia._8va:i=new AlphaTab.Rendering.Glyphs.NumberGlyph(0,0,8,.5),n=!0;break;case AlphaTab.Model.ClefOttavia._8vb:i=new AlphaTab.Rendering.Glyphs.NumberGlyph(0,0,8,.5);break;case AlphaTab.Model.ClefOttavia._15mb:i=new AlphaTab.Rendering.Glyphs.NumberGlyph(0,0,15,.5);break;default:return}var r;switch(this._clef){case AlphaTab.Model.Clef.Neutral:r=n?-25:10;break;case AlphaTab.Model.Clef.C3:case AlphaTab.Model.Clef.C4:r=n?-30:20;break;case AlphaTab.Model.Clef.F4:r=n?-25:20;break;case AlphaTab.Model.Clef.G2:r=n?-50:25;break;default:return}i.Renderer=this.Renderer,i.DoLayout();var l=(this.Width-i.Width)/2;i.Paint(e+this.X+l,t+this.Y+r*this.get_Scale(),a)}},AlphaTab.Rendering.Glyphs.ClefGlyph.GetSymbol=function(e){switch(e){case AlphaTab.Model.Clef.Neutral:return AlphaTab.Rendering.Glyphs.MusicFontSymbol.ClefNeutral;case AlphaTab.Model.Clef.C3:case AlphaTab.Model.Clef.C4:return AlphaTab.Rendering.Glyphs.MusicFontSymbol.ClefC;case AlphaTab.Model.Clef.F4:return AlphaTab.Rendering.Glyphs.MusicFontSymbol.ClefF;case AlphaTab.Model.Clef.G2:return AlphaTab.Rendering.Glyphs.MusicFontSymbol.ClefG;default:return AlphaTab.Rendering.Glyphs.MusicFontSymbol.None}},$Inherit(AlphaTab.Rendering.Glyphs.ClefGlyph,AlphaTab.Rendering.Glyphs.MusicFontGlyph),AlphaTab.Rendering.Glyphs.GroupedEffectGlyph=function(e){this._endPosition=AlphaTab.Rendering.BeatXPosition.PreNotes,AlphaTab.Rendering.Glyphs.EffectGlyph.call(this,0,0),this._endPosition=e},AlphaTab.Rendering.Glyphs.GroupedEffectGlyph.prototype={get_IsLinkedWithPrevious:function(){return null!=this.PreviousGlyph&&this.PreviousGlyph.Renderer.Staff.StaveGroup==this.Renderer.Staff.StaveGroup},get_IsLinkedWithNext:function(){return null!=this.NextGlyph&&this.NextGlyph.Renderer.IsFinalized&&this.NextGlyph.Renderer.Staff.StaveGroup==this.Renderer.Staff.StaveGroup},Paint:function(e,t,a){if(!this.get_IsLinkedWithPrevious())if(this.get_IsLinkedWithNext()){for(var i=this.NextGlyph;i.get_IsLinkedWithNext();)i=i.NextGlyph;var n=e-this.Renderer.X,r=i.Renderer,l=r.GetBeatX(i.Beat,this._endPosition),s=n+r.X+l;this.PaintGrouped(e,t,s,a)}else this.PaintNonGrouped(e,t,a)},PaintNonGrouped:function(e,t,a){var i=e+this.Renderer.GetBeatX(this.Beat,AlphaTab.Rendering.BeatXPosition.EndBeat);this.PaintGrouped(e,t,i,a)}},$Inherit(AlphaTab.Rendering.Glyphs.GroupedEffectGlyph,AlphaTab.Rendering.Glyphs.EffectGlyph),AlphaTab.Rendering.Glyphs.CrescendoGlyph=function(e,t,a){this._crescendo=AlphaTab.Model.CrescendoType.None,AlphaTab.Rendering.Glyphs.GroupedEffectGlyph.call(this,AlphaTab.Rendering.BeatXPosition.EndBeat),this._crescendo=a,this.X=e,this.Y=t},AlphaTab.Rendering.Glyphs.CrescendoGlyph.prototype={DoLayout:function(){AlphaTab.Rendering.Glyphs.Glyph.prototype.DoLayout.call(this),this.Height=17*this.get_Scale()},PaintGrouped:function(e,t,a,i){var n=e+this.X,r=this.Height*this.get_Scale();i.BeginPath(),this._crescendo==AlphaTab.Model.CrescendoType.Crescendo?(i.MoveTo(a,t+this.Y),i.LineTo(n,t+this.Y+r/2),i.LineTo(a,t+this.Y+r)):(i.MoveTo(e+this.X,t+this.Y),i.LineTo(a,t+this.Y+r/2),i.LineTo(e+this.X,t+this.Y+r)),i.Stroke()}},$Inherit(AlphaTab.Rendering.Glyphs.CrescendoGlyph,AlphaTab.Rendering.Glyphs.GroupedEffectGlyph),AlphaTab.Rendering.Glyphs.DeadNoteHeadGlyph=function(e,t,a){this._isGrace=!1,AlphaTab.Rendering.Glyphs.MusicFontGlyph.call(this,e,t,a?.75:1,AlphaTab.Rendering.Glyphs.MusicFontSymbol.NoteDead),this._isGrace=a},AlphaTab.Rendering.Glyphs.DeadNoteHeadGlyph.prototype={DoLayout:function(){this.Width=9*(this._isGrace?.75:1)*this.get_Scale()}},$Inherit(AlphaTab.Rendering.Glyphs.DeadNoteHeadGlyph,AlphaTab.Rendering.Glyphs.MusicFontGlyph),AlphaTab.Rendering.Glyphs.DiamondNoteHeadGlyph=function(e,t,a){this._isGrace=!1,AlphaTab.Rendering.Glyphs.MusicFontGlyph.call(this,e,t,a?.75:1,AlphaTab.Rendering.Glyphs.MusicFontSymbol.NoteHarmonic),this._isGrace=a},AlphaTab.Rendering.Glyphs.DiamondNoteHeadGlyph.prototype={DoLayout:function(){this.Width=9*(this._isGrace?.75:1)*this.get_Scale()}},$Inherit(AlphaTab.Rendering.Glyphs.DiamondNoteHeadGlyph,AlphaTab.Rendering.Glyphs.MusicFontGlyph),AlphaTab.Rendering.Glyphs.DigitGlyph=function(e,t,a,i){this._digit=0,this._scale=0,AlphaTab.Rendering.Glyphs.MusicFontGlyph.call(this,e,t,i,AlphaTab.Rendering.Glyphs.DigitGlyph.GetSymbol(a)),this._digit=a,this._scale=i},AlphaTab.Rendering.Glyphs.DigitGlyph.prototype={DoLayout:function(){this.Y+=7*this.get_Scale(),this.Width=this.GetDigitWidth(this._digit)*this.get_Scale()*this._scale},GetDigitWidth:function(e){switch(e){case 0:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:return 14;case 1:return 10;default:return 0}}},AlphaTab.Rendering.Glyphs.DigitGlyph.GetSymbol=function(e){switch(e){case 0:return AlphaTab.Rendering.Glyphs.MusicFontSymbol.Num0;case 1:return AlphaTab.Rendering.Glyphs.MusicFontSymbol.Num1;case 2:return AlphaTab.Rendering.Glyphs.MusicFontSymbol.Num2;case 3:return AlphaTab.Rendering.Glyphs.MusicFontSymbol.Num3;case 4:return AlphaTab.Rendering.Glyphs.MusicFontSymbol.Num4;case 5:return AlphaTab.Rendering.Glyphs.MusicFontSymbol.Num5;case 6:return AlphaTab.Rendering.Glyphs.MusicFontSymbol.Num6;case 7:return AlphaTab.Rendering.Glyphs.MusicFontSymbol.Num7;case 8:return AlphaTab.Rendering.Glyphs.MusicFontSymbol.Num8;case 9:return AlphaTab.Rendering.Glyphs.MusicFontSymbol.Num9;default:return AlphaTab.Rendering.Glyphs.MusicFontSymbol.None}},$Inherit(AlphaTab.Rendering.Glyphs.DigitGlyph,AlphaTab.Rendering.Glyphs.MusicFontGlyph),AlphaTab.Rendering.Glyphs.DrumSticksGlyph=function(e,t,a){this._isGrace=!1,AlphaTab.Rendering.Glyphs.MusicFontGlyph.call(this,e,t,a?.75:1,AlphaTab.Rendering.Glyphs.MusicFontSymbol.NoteSideStick),this._isGrace=a},AlphaTab.Rendering.Glyphs.DrumSticksGlyph.prototype={DoLayout:function(){this.Width=9*(this._isGrace?.75:1)*this.get_Scale()}},$Inherit(AlphaTab.Rendering.Glyphs.DrumSticksGlyph,AlphaTab.Rendering.Glyphs.MusicFontGlyph),AlphaTab.Rendering.Glyphs.DynamicsGlyph=function(e,t,a){AlphaTab.Rendering.Glyphs.MusicFontGlyph.call(this,e,t,.6,AlphaTab.Rendering.Glyphs.DynamicsGlyph.GetSymbol(a))},AlphaTab.Rendering.Glyphs.DynamicsGlyph.prototype={DoLayout:function(){AlphaTab.Rendering.Glyphs.Glyph.prototype.DoLayout.call(this),this.Height=17*this.get_Scale(),this.Y+=this.Height/2}},AlphaTab.Rendering.Glyphs.DynamicsGlyph.GetSymbol=function(e){switch(e){case AlphaTab.Model.DynamicValue.PPP:return AlphaTab.Rendering.Glyphs.MusicFontSymbol.DynamicPPP;case AlphaTab.Model.DynamicValue.PP:return AlphaTab.Rendering.Glyphs.MusicFontSymbol.DynamicPP;case AlphaTab.Model.DynamicValue.P:return AlphaTab.Rendering.Glyphs.MusicFontSymbol.DynamicP;case AlphaTab.Model.DynamicValue.MP:return AlphaTab.Rendering.Glyphs.MusicFontSymbol.DynamicMP;case AlphaTab.Model.DynamicValue.MF:return AlphaTab.Rendering.Glyphs.MusicFontSymbol.DynamicMF;case AlphaTab.Model.DynamicValue.F:return AlphaTab.Rendering.Glyphs.MusicFontSymbol.DynamicF;case AlphaTab.Model.DynamicValue.FF:case AlphaTab.Model.DynamicValue.FFF:return AlphaTab.Rendering.Glyphs.MusicFontSymbol.DynamicFFF;default:return AlphaTab.Rendering.Glyphs.MusicFontSymbol.None}},$Inherit(AlphaTab.Rendering.Glyphs.DynamicsGlyph,AlphaTab.Rendering.Glyphs.MusicFontGlyph),AlphaTab.Rendering.Glyphs.FadeInGlyph=function(e,t){AlphaTab.Rendering.Glyphs.EffectGlyph.call(this,e,t)},AlphaTab.Rendering.Glyphs.FadeInGlyph.prototype={DoLayout:function(){AlphaTab.Rendering.Glyphs.Glyph.prototype.DoLayout.call(this),this.Height=17*this.get_Scale()},Paint:function(e,t,a){var i=6*this.get_Scale(),n=Math.max(this.Width,14*this.get_Scale()),r=this.Height/2;a.BeginPath(),a.MoveTo(e+this.X,t+this.Y+r),a.QuadraticCurveTo(e+this.X+n/2,t+this.Y+r,e+this.X+n,t+this.Y+r-i),a.MoveTo(e+this.X,t+this.Y+r),a.QuadraticCurveTo(e+this.X+n/2,t+this.Y+r,e+this.X+n,t+this.Y+r+i),a.Stroke()}},$Inherit(AlphaTab.Rendering.Glyphs.FadeInGlyph,AlphaTab.Rendering.Glyphs.EffectGlyph),AlphaTab.Rendering.Glyphs.FlatGlyph=function(e,t,a){this._isGrace=!1,AlphaTab.Rendering.Glyphs.MusicFontGlyph.call(this,e,t,a?.75:1,AlphaTab.Rendering.Glyphs.MusicFontSymbol.AccidentalFlat),this._isGrace=a},AlphaTab.Rendering.Glyphs.FlatGlyph.prototype={DoLayout:function(){this.Width=8*(this._isGrace?.75:1)*this.get_Scale()}},$Inherit(AlphaTab.Rendering.Glyphs.FlatGlyph,AlphaTab.Rendering.Glyphs.MusicFontGlyph),AlphaTab.Rendering.Glyphs.HiHatGlyph=function(e,t,a){this._isGrace=!1,AlphaTab.Rendering.Glyphs.MusicFontGlyph.call(this,e,t,a?.75:1,AlphaTab.Rendering.Glyphs.MusicFontSymbol.NoteHiHat),this._isGrace=a},AlphaTab.Rendering.Glyphs.HiHatGlyph.prototype={DoLayout:function(){this.Width=9*(this._isGrace?.75:1)*this.get_Scale()}},$Inherit(AlphaTab.Rendering.Glyphs.HiHatGlyph,AlphaTab.Rendering.Glyphs.MusicFontGlyph),AlphaTab.Rendering.Glyphs.LeftToRightLayoutingGlyphGroup=function(){AlphaTab.Rendering.Glyphs.GlyphGroup.call(this,0,0),this.Glyphs=[]},AlphaTab.Rendering.Glyphs.LeftToRightLayoutingGlyphGroup.prototype={AddGlyph:function(e){e.X=0==this.Glyphs.length?0:this.Glyphs[this.Glyphs.length-1].X+this.Glyphs[this.Glyphs.length-1].Width,e.Renderer=this.Renderer,e.DoLayout(),this.Width=e.X+e.Width,AlphaTab.Rendering.Glyphs.GlyphGroup.prototype.AddGlyph.call(this,e)}},$Inherit(AlphaTab.Rendering.Glyphs.LeftToRightLayoutingGlyphGroup,AlphaTab.Rendering.Glyphs.GlyphGroup),AlphaTab.Rendering.Glyphs.LineRangedGlyph=function(e){this._label=null,AlphaTab.Rendering.Glyphs.GroupedEffectGlyph.call(this,AlphaTab.Rendering.BeatXPosition.PostNotes),this._label=e},AlphaTab.Rendering.Glyphs.LineRangedGlyph.prototype={DoLayout:function(){AlphaTab.Rendering.Glyphs.Glyph.prototype.DoLayout.call(this),this.Height=this.Renderer.get_Resources().EffectFont.Size},PaintNonGrouped:function(e,t,a){var i=this.Renderer.get_Resources();a.set_Font(i.EffectFont),a.set_TextAlign(AlphaTab.Platform.Model.TextAlign.Left),a.FillText(this._label,e+this.X,t+this.Y)},PaintGrouped:function(e,t,a,i){this.PaintNonGrouped(e,t,i);var n=3*this.get_Scale(),r=i.MeasureText(this._label),l=e+this.X+r+n,s=t+this.Y+8*this.get_Scale(),o=8*this.get_Scale();if(a>l){for(var h=l;h<a;)i.BeginPath(),i.MoveTo(h,0|s),i.LineTo(Math.min(h+o,a),0|s),h+=o+n,i.Stroke();i.BeginPath(),i.MoveTo(a,s-6*this.get_Scale()|0),i.LineTo(a,s+6*this.get_Scale()|0),i.Stroke()}}},$StaticConstructor(function(){AlphaTab.Rendering.Glyphs.LineRangedGlyph.LineSpacing=3,AlphaTab.Rendering.Glyphs.LineRangedGlyph.LineTopPadding=8,AlphaTab.Rendering.Glyphs.LineRangedGlyph.LineTopOffset=6,AlphaTab.Rendering.Glyphs.LineRangedGlyph.LineSize=8}),$Inherit(AlphaTab.Rendering.Glyphs.LineRangedGlyph,AlphaTab.Rendering.Glyphs.GroupedEffectGlyph),AlphaTab.Rendering.Glyphs.LyricsGlyph=function(e,t,a,i,n){this._lines=null,this.Font=null,this.TextAlign=AlphaTab.Platform.Model.TextAlign.Left,AlphaTab.Rendering.Glyphs.EffectGlyph.call(this,e,t),this._lines=a,this.Font=i,this.TextAlign=n},AlphaTab.Rendering.Glyphs.LyricsGlyph.prototype={DoLayout:function(){AlphaTab.Rendering.Glyphs.Glyph.prototype.DoLayout.call(this),this.Height=this.Font.Size*this._lines.length},Paint:function(e,t,a){a.set_Font(this.Font);var i=a.get_TextAlign();a.set_TextAlign(this.TextAlign);for(var n=0;n<this._lines.length;n++)null!=this._lines[n]&&a.FillText(this._lines[n],e+this.X,t+this.Y+n*this.Font.Size);a.set_TextAlign(i)}},$Inherit(AlphaTab.Rendering.Glyphs.LyricsGlyph,AlphaTab.Rendering.Glyphs.EffectGlyph),AlphaTab.Rendering.Glyphs.MusicFontSymbol={None:-1,ClefG:57424,ClefC:57436,ClefF:57442,ClefNeutral:57449,ClefTab:57453,ClefTabSmall:57454,RestQuadrupleWhole:58593,RestDoubleWhole:58594,RestWhole:58595,RestHalf:58596,RestQuarter:58597,RestEighth:58598,RestSixteenth:58599,RestThirtySecond:58600,RestSixtyFourth:58601,RestOneHundredTwentyEighth:58602,RestTwoHundredFiftySixth:58603,GraceUp:57815,GraceDown:57816,Trill:58726,Num0:57472,Num1:57473,Num2:57474,Num3:57475,Num4:57476,Num5:57477,Num6:57478,Num7:57479,Num8:57480,Num9:57481,TimeSignatureCommon:57482,TimeSignatureCutCommon:57483,NoteQuadrupleWhole:57505,NoteDoubleWhole:57504,NoteWhole:57506,NoteHalf:57507,NoteQuarter:57508,NoteDead:57514,NoteHarmonic:57564,NoteRideCymbal:57566,NoteHiHat:57523,NoteSideStick:57513,NoteHiHatHalf:57591,NoteChineseCymbal:57593,FooterUpEighth:57920,FooterDownEighth:57921,FooterUpSixteenth:57922,FooterDownSixteenth:57923,FooterUpThirtySecond:57924,FooterDownThirtySecond:57925,FooterUpSixtyFourth:57926,FooterDownSixtyFourth:57927,FooterUpOneHundredTwentyEighth:57928,FooterDownOneHundredTwentyEighth:57929,FooterUpTwoHundredFiftySixth:57930,FooterDownTwoHundredFiftySixth:57931,DynamicPPP:58666,DynamicPP:58667,DynamicP:58656,DynamicMP:58668,DynamicMF:58669,DynamicF:58658,DynamicFF:58671,DynamicFFF:58672,Accentuation:58528,HeavyAccentuation:58540,WaveHorizontal:60068,PickStrokeDown:58896,PickStrokeUp:58898,TremoloPickingThirtySecond:57890,TremoloPickingSixteenth:57889,TremoloPickingEighth:57888,Tempo:57813,NoteEighth:57815,AccidentalFlat:57952,AccidentalNatural:57953,AccidentalSharp:57954},AlphaTab.Rendering.Glyphs.NaturalizeGlyph=function(e,t,a){this._isGrace=!1,AlphaTab.Rendering.Glyphs.MusicFontGlyph.call(this,e,t,a?.75:1,AlphaTab.Rendering.Glyphs.MusicFontSymbol.AccidentalNatural),this._isGrace=a},AlphaTab.Rendering.Glyphs.NaturalizeGlyph.prototype={DoLayout:function(){this.Width=8*(this._isGrace?.75:1)*this.get_Scale()}},$Inherit(AlphaTab.Rendering.Glyphs.NaturalizeGlyph,AlphaTab.Rendering.Glyphs.MusicFontGlyph),AlphaTab.Rendering.Glyphs.NoteHeadGlyph=function(e,t,a,i){this._isGrace=!1,this._duration=AlphaTab.Model.Duration.QuadrupleWhole,AlphaTab.Rendering.Glyphs.MusicFontGlyph.call(this,e,t,i?.75:1,AlphaTab.Rendering.Glyphs.NoteHeadGlyph.GetSymbol(a)),this._isGrace=i,this._duration=a},AlphaTab.Rendering.Glyphs.NoteHeadGlyph.prototype={DoLayout:function(){switch(this._duration){case AlphaTab.Model.Duration.QuadrupleWhole:case AlphaTab.Model.Duration.DoubleWhole:case AlphaTab.Model.Duration.Whole:this.Width=14*(this._isGrace?.75:1)*this.get_Scale();break;default:this.Width=9*(this._isGrace?.75:1)*this.get_Scale()}}},$StaticConstructor(function(){AlphaTab.Rendering.Glyphs.NoteHeadGlyph.GraceScale=.75,AlphaTab.Rendering.Glyphs.NoteHeadGlyph.NoteHeadHeight=9}),AlphaTab.Rendering.Glyphs.NoteHeadGlyph.GetSymbol=function(e){switch(e){case AlphaTab.Model.Duration.QuadrupleWhole:return AlphaTab.Rendering.Glyphs.MusicFontSymbol.NoteQuadrupleWhole;case AlphaTab.Model.Duration.DoubleWhole:return AlphaTab.Rendering.Glyphs.MusicFontSymbol.NoteDoubleWhole;case AlphaTab.Model.Duration.Whole:return AlphaTab.Rendering.Glyphs.MusicFontSymbol.NoteWhole;case AlphaTab.Model.Duration.Half:return AlphaTab.Rendering.Glyphs.MusicFontSymbol.NoteHalf;default:return AlphaTab.Rendering.Glyphs.MusicFontSymbol.NoteQuarter}},$Inherit(AlphaTab.Rendering.Glyphs.NoteHeadGlyph,AlphaTab.Rendering.Glyphs.MusicFontGlyph),AlphaTab.Rendering.Glyphs.NoteNumberGlyph=function(e,t,a){this._noteString=null,this._noteStringWidth=0,this._trillNoteString=null,this._trillNoteStringWidth=0,this.IsEmpty=!1,AlphaTab.Rendering.Glyphs.Glyph.call(this,e,t),a.IsTieDestination?0==a.Beat.Index||a.get_HasBend()?this._noteString="("+(a.TieOrigin.Fret-a.Beat.Voice.Bar.Staff.Track.TranspositionPitch)+")":this._noteString="":(this._noteString=a.IsDead?"x":(a.Fret-a.Beat.Voice.Bar.Staff.Track.TranspositionPitch).toString(),a.IsGhost&&(this._noteString="("+this._noteString+")")),a.get_IsTrill()?this._trillNoteString="("+(a.get_TrillFret()-a.Beat.Voice.Bar.Staff.Track.TranspositionPitch)+")":this._trillNoteString=""},AlphaTab.Rendering.Glyphs.NoteNumberGlyph.prototype={DoLayout:function(){this.IsEmpty=!(null!=this._noteString&&0!=this._noteString.length||null!=this._trillNoteString&&0!=this._trillNoteString.length),this.IsEmpty||(this.Renderer.ScoreRenderer.Canvas.set_Font(this.Renderer.get_Resources().TablatureFont),this._noteStringWidth=this.Renderer.ScoreRenderer.Canvas.MeasureText(this._noteString),this._trillNoteStringWidth=this.Renderer.ScoreRenderer.Canvas.MeasureText(this._trillNoteString),this.Width=this._noteStringWidth+this._trillNoteStringWidth)},Paint:function(e,t,a){if(!this.IsEmpty){var i=this._noteStringWidth+this._trillNoteStringWidth,n=e+this.X+(this.Width-i)/2;a.FillText(this._noteString,n,t+this.Y),a.FillText(this._trillNoteString,n+this._noteStringWidth,t+this.Y)}}},$Inherit(AlphaTab.Rendering.Glyphs.NoteNumberGlyph,AlphaTab.Rendering.Glyphs.Glyph),AlphaTab.Rendering.Glyphs.NumberGlyph=function(e,t,a,i){this._number=0,this._scale=0,AlphaTab.Rendering.Glyphs.GlyphGroup.call(this,e,t),this._number=a,this._scale=i},AlphaTab.Rendering.Glyphs.NumberGlyph.prototype={DoLayout:function(){for(var e=this._number;e>0;){var t=e%10,a=new AlphaTab.Rendering.Glyphs.DigitGlyph(0,0,t,this._scale);this.AddGlyph(a),e=e/10|0}this.Glyphs.reverse();for(var i=0,n=0,r=this.Glyphs.length;n<r;n++){var l=this.Glyphs[n];l.X=i,l.Y=0,l.Renderer=this.Renderer,l.DoLayout(),i+=l.Width}this.Width=i}},$Inherit(AlphaTab.Rendering.Glyphs.NumberGlyph,AlphaTab.Rendering.Glyphs.GlyphGroup),AlphaTab.Rendering.Glyphs.PickStrokeGlyph=function(e,t,a){AlphaTab.Rendering.Glyphs.MusicFontGlyph.call(this,e,t,.75,AlphaTab.Rendering.Glyphs.PickStrokeGlyph.GetSymbol(a))},AlphaTab.Rendering.Glyphs.PickStrokeGlyph.prototype={DoLayout:function(){this.Width=9*this.get_Scale(),this.Height=10*this.get_Scale()},Paint:function(e,t,a){AlphaTab.Rendering.Glyphs.MusicFontGlyph.prototype.Paint.call(this,e,t+this.Height,a)}},AlphaTab.Rendering.Glyphs.PickStrokeGlyph.GetSymbol=function(e){switch(e){case AlphaTab.Model.PickStrokeType.Up:return AlphaTab.Rendering.Glyphs.MusicFontSymbol.PickStrokeUp;case AlphaTab.Model.PickStrokeType.Down:return AlphaTab.Rendering.Glyphs.MusicFontSymbol.PickStrokeDown;default:return AlphaTab.Rendering.Glyphs.MusicFontSymbol.None}},$Inherit(AlphaTab.Rendering.Glyphs.PickStrokeGlyph,AlphaTab.Rendering.Glyphs.MusicFontGlyph),AlphaTab.Rendering.Glyphs.RepeatCloseGlyph=function(e,t){AlphaTab.Rendering.Glyphs.Glyph.call(this,e,t)},AlphaTab.Rendering.Glyphs.RepeatCloseGlyph.prototype={DoLayout:function(){this.Width=11*this.get_Scale()},Paint:function(e,t,a){var i=4*this.get_Scale(),n=t+this.Y+this.Renderer.TopPadding,r=t+this.Y+this.Renderer.Height-this.Renderer.BottomPadding,l=e+this.X,s=r-n,o=1.5*this.get_Scale(),h=(n+r)/2;a.FillCircle(l,h-3*o,o),a.FillCircle(l,h+3*o,o),l+=4*this.get_Scale(),a.BeginPath(),a.MoveTo(l,n),a.LineTo(l,r),a.Stroke(),l+=3*this.get_Scale()+.5,a.FillRect(l,n,i,s)}},$Inherit(AlphaTab.Rendering.Glyphs.RepeatCloseGlyph,AlphaTab.Rendering.Glyphs.Glyph),AlphaTab.Rendering.Glyphs.RepeatCountGlyph=function(e,t,a){this._count=0,AlphaTab.Rendering.Glyphs.Glyph.call(this,e,t),this._count=a},AlphaTab.Rendering.Glyphs.RepeatCountGlyph.prototype={DoLayout:function(){this.Width=0},Paint:function(e,t,a){var i=this.Renderer.get_Resources(),n=a.get_TextAlign();a.set_Font(i.BarNumberFont),a.set_TextAlign(AlphaTab.Platform.Model.TextAlign.Right);var r="x"+this._count,l=a.MeasureText(r)/1.5;a.FillText(r,e+this.X-l,t+this.Y),a.set_TextAlign(n)}},$Inherit(AlphaTab.Rendering.Glyphs.RepeatCountGlyph,AlphaTab.Rendering.Glyphs.Glyph),AlphaTab.Rendering.Glyphs.RepeatOpenGlyph=function(e,t,a,i){this._dotOffset=0,this._circleSize=0,AlphaTab.Rendering.Glyphs.Glyph.call(this,e,t),this._dotOffset=i,this._circleSize=a},AlphaTab.Rendering.Glyphs.RepeatOpenGlyph.prototype={DoLayout:function(){this.Width=13*this.get_Scale()},Paint:function(e,t,a){var i=4*this.get_Scale(),n=t+this.Y+this.Renderer.TopPadding,r=t+this.Y+this.Renderer.Height-this.Renderer.BottomPadding,l=e+this.X+.5,s=r-n;a.FillRect(l,n,i,s),l+=2*i-.5,a.BeginPath(),a.MoveTo(l,n),a.LineTo(l,r),a.Stroke(),l+=3*this.get_Scale();var o=this._circleSize*this.get_Scale(),h=(n+r)/2;a.FillCircle(l,h-o*this._dotOffset,o),a.FillCircle(l,h+o*this._dotOffset,o)}},$Inherit(AlphaTab.Rendering.Glyphs.RepeatOpenGlyph,AlphaTab.Rendering.Glyphs.Glyph),AlphaTab.Rendering.Glyphs.TieGlyph=function(e,t,a){this.StartBeat=null,this.EndBeat=null,this.YOffset=0,this._forEnd=!1,AlphaTab.Rendering.Glyphs.Glyph.call(this,0,0),this.StartBeat=e,this.EndBeat=t,this._forEnd=a},AlphaTab.Rendering.Glyphs.TieGlyph.prototype={DoLayout:function(){this.Width=0},Paint:function(e,t,a){if(null!=this.EndBeat){var i=this.Renderer.ScoreRenderer.Layout.GetRendererForBar(this.Renderer.Staff.get_StaveId(),this.StartBeat.Voice.Bar),n=this.Renderer.ScoreRenderer.Layout.GetRendererForBar(this.Renderer.Staff.get_StaveId(),this.EndBeat.Voice.Bar),r=0,l=0,s=0,o=0,h=!1,p=this.GetBeamDirection(this.StartBeat,i);this._forEnd?i.Staff!=n.Staff&&(r=e+n.X,l=e+n.X+this.GetEndX(n),o=s=t+n.Y+this.GetEndY(n,p)+this.YOffset,h=!0):(i!=n?(r=e+i.X+this.GetStartX(i),s=t+i.Y+this.GetStartY(i,p)+this.YOffset,null==n||i.Staff!=n.Staff?(l=e+i.X+i.Width,o=s):(l=e+n.X+this.GetEndX(n),o=t+n.Y+this.GetEndY(n,p)+this.YOffset)):(r=e+i.X+this.GetStartX(i),l=e+n.X+this.GetEndX(n),s=t+i.Y+this.GetStartY(i,p)+this.YOffset,o=t+n.Y+this.GetEndY(n,p)+this.YOffset),h=!0),h&&(AlphaTab.Rendering.Glyphs.TieGlyph.PaintTie(a,this.get_Scale(),r,s,l,o,p==AlphaTab.Rendering.Utils.BeamDirection.Down),a.Fill())}},GetBeamDirection:function(e,t){return AlphaTab.Rendering.Utils.BeamDirection.Down},GetStartY:function(e,t){return 0},GetEndY:function(e,t){return 0},GetStartX:function(e){return 0},GetEndX:function(e){return 0}},AlphaTab.Rendering.Glyphs.TieGlyph.PaintTie=function(e,t,a,i,n,r,l){if(a!=n||i!=r){if(n<a){var s=a;a=n,n=s,s=i,i=r,r=s}var o=22*t,h=4*t,p=r-i,d=n-a,u=Math.sqrt(p*p+d*d);l?p*=-1:d*=-1;var c=(n+a)/2,T=(r+i)/2,g=c+o*(p/=u),f=T+o*(d/=u),b=c+(o-h)*p,A=T+(o-h)*d;e.BeginPath(),e.MoveTo(a,i),e.QuadraticCurveTo(g,f,n,r),e.QuadraticCurveTo(b,A,a,i),e.ClosePath()}},$Inherit(AlphaTab.Rendering.Glyphs.TieGlyph,AlphaTab.Rendering.Glyphs.Glyph),AlphaTab.Rendering.Glyphs.ScoreLegatoGlyph=function(e,t,a){AlphaTab.Rendering.Glyphs.TieGlyph.call(this,e,t,a)},AlphaTab.Rendering.Glyphs.ScoreLegatoGlyph.prototype={DoLayout:function(){AlphaTab.Rendering.Glyphs.TieGlyph.prototype.DoLayout.call(this),this.YOffset=4.5},GetBeamDirection:function(e,t){if(e.get_IsRest())return AlphaTab.Rendering.Utils.BeamDirection.Up;switch(t.GetBeatDirection(e)){case AlphaTab.Rendering.Utils.BeamDirection.Up:return AlphaTab.Rendering.Utils.BeamDirection.Down;case AlphaTab.Rendering.Utils.BeamDirection.Down:default:return AlphaTab.Rendering.Utils.BeamDirection.Up}},GetStartY:function(e,t){if(this.StartBeat.get_IsRest())return e.GetScoreY(9,0);switch(t){case AlphaTab.Rendering.Utils.BeamDirection.Up:return e.GetNoteY(this.StartBeat.get_MinNote());default:return e.GetNoteY(this.StartBeat.get_MaxNote())}},GetEndY:function(e,t){if(this.EndBeat.get_IsRest())switch(t){case AlphaTab.Rendering.Utils.BeamDirection.Up:return e.GetScoreY(9,0);default:return e.GetScoreY(0,0)}switch(t){case AlphaTab.Rendering.Utils.BeamDirection.Up:return e.GetNoteY(this.EndBeat.get_MinNote());default:return e.GetNoteY(this.EndBeat.get_MaxNote())}},GetStartX:function(e){return this.StartBeat.get_IsRest()?e.GetBeatX(this.StartBeat,AlphaTab.Rendering.BeatXPosition.PreNotes):e.GetNoteX(this.StartBeat.get_MinNote(),!0)},GetEndX:function(e){return this.EndBeat.get_IsRest()?e.GetBeatX(this.EndBeat,AlphaTab.Rendering.BeatXPosition.PreNotes):e.GetNoteX(this.EndBeat.get_MinNote(),!1)}},$Inherit(AlphaTab.Rendering.Glyphs.ScoreLegatoGlyph,AlphaTab.Rendering.Glyphs.TieGlyph),AlphaTab.Rendering.Glyphs.ScoreRestGlyph=function(e,t,a){this._duration=AlphaTab.Model.Duration.QuadrupleWhole,this.BeamingHelper=null,AlphaTab.Rendering.Glyphs.MusicFontGlyph.call(this,e,t,1,AlphaTab.Rendering.Glyphs.ScoreRestGlyph.GetSymbol(a)),this._duration=a},AlphaTab.Rendering.Glyphs.ScoreRestGlyph.prototype={DoLayout:function(){this.Width=AlphaTab.Rendering.Glyphs.ScoreRestGlyph.GetSize(this._duration)*this.get_Scale()},UpdateBeamingHelper:function(e){null!=this.BeamingHelper&&this.BeamingHelper.RegisterBeatLineX("score",this.Beat,e+this.X+this.Width/2,e+this.X+this.Width/2)}},AlphaTab.Rendering.Glyphs.ScoreRestGlyph.GetSymbol=function(e){switch(e){case AlphaTab.Model.Duration.QuadrupleWhole:return AlphaTab.Rendering.Glyphs.MusicFontSymbol.RestQuadrupleWhole;case AlphaTab.Model.Duration.DoubleWhole:return AlphaTab.Rendering.Glyphs.MusicFontSymbol.RestDoubleWhole;case AlphaTab.Model.Duration.Whole:return AlphaTab.Rendering.Glyphs.MusicFontSymbol.RestWhole;case AlphaTab.Model.Duration.Half:return AlphaTab.Rendering.Glyphs.MusicFontSymbol.RestHalf;case AlphaTab.Model.Duration.Quarter:return AlphaTab.Rendering.Glyphs.MusicFontSymbol.RestQuarter;case AlphaTab.Model.Duration.Eighth:return AlphaTab.Rendering.Glyphs.MusicFontSymbol.RestEighth;case AlphaTab.Model.Duration.Sixteenth:return AlphaTab.Rendering.Glyphs.MusicFontSymbol.RestSixteenth;case AlphaTab.Model.Duration.ThirtySecond:return AlphaTab.Rendering.Glyphs.MusicFontSymbol.RestThirtySecond;case AlphaTab.Model.Duration.SixtyFourth:return AlphaTab.Rendering.Glyphs.MusicFontSymbol.RestSixtyFourth;case AlphaTab.Model.Duration.OneHundredTwentyEighth:return AlphaTab.Rendering.Glyphs.MusicFontSymbol.RestOneHundredTwentyEighth;case AlphaTab.Model.Duration.TwoHundredFiftySixth:return AlphaTab.Rendering.Glyphs.MusicFontSymbol.RestTwoHundredFiftySixth;default:return AlphaTab.Rendering.Glyphs.MusicFontSymbol.None}},AlphaTab.Rendering.Glyphs.ScoreRestGlyph.GetSize=function(e){switch(e){case AlphaTab.Model.Duration.QuadrupleWhole:case AlphaTab.Model.Duration.DoubleWhole:case AlphaTab.Model.Duration.Whole:case AlphaTab.Model.Duration.Half:case AlphaTab.Model.Duration.Quarter:case AlphaTab.Model.Duration.Eighth:case AlphaTab.Model.Duration.Sixteenth:return 9;case AlphaTab.Model.Duration.ThirtySecond:return 12;case AlphaTab.Model.Duration.SixtyFourth:return 14;case AlphaTab.Model.Duration.OneHundredTwentyEighth:case AlphaTab.Model.Duration.TwoHundredFiftySixth:return 20}return 10},$Inherit(AlphaTab.Rendering.Glyphs.ScoreRestGlyph,AlphaTab.Rendering.Glyphs.MusicFontGlyph),AlphaTab.Rendering.Glyphs.RideCymbalGlyph=function(e,t,a){this._isGrace=!1,AlphaTab.Rendering.Glyphs.MusicFontGlyph.call(this,e,t,a?.75:1,AlphaTab.Rendering.Glyphs.MusicFontSymbol.NoteRideCymbal),this._isGrace=a},AlphaTab.Rendering.Glyphs.RideCymbalGlyph.prototype={DoLayout:function(){this.Width=9*(this._isGrace?.75:1)*this.get_Scale()}},$Inherit(AlphaTab.Rendering.Glyphs.RideCymbalGlyph,AlphaTab.Rendering.Glyphs.MusicFontGlyph),AlphaTab.Rendering.ScoreBeatContainerGlyph=function(e,t){AlphaTab.Rendering.Glyphs.BeatContainerGlyph.call(this,e,t)},AlphaTab.Rendering.ScoreBeatContainerGlyph.prototype={DoLayout:function(){if(AlphaTab.Rendering.Glyphs.BeatContainerGlyph.prototype.DoLayout.call(this),this.Beat.IsLegatoOrigin){if(null==this.Beat.PreviousBeat||!this.Beat.PreviousBeat.IsLegatoOrigin){for(var e=this.Beat.NextBeat;null!=e.NextBeat&&e.NextBeat.get_IsLegatoDestination();)e=e.NextBeat;this.Ties.push(new AlphaTab.Rendering.Glyphs.ScoreLegatoGlyph(this.Beat,e,!1))}}else if(this.Beat.get_IsLegatoDestination()&&!this.Beat.IsLegatoOrigin){for(var t=this.Beat.PreviousBeat;null!=t.PreviousBeat&&t.PreviousBeat.IsLegatoOrigin;)t=t.PreviousBeat;this.Ties.push(new AlphaTab.Rendering.Glyphs.ScoreLegatoGlyph(t,this.Beat,!0))}},CreateTies:function(e){if(e.IsTieOrigin){i=new AlphaTab.Rendering.Glyphs.ScoreTieGlyph(e,e.TieDestination,!1);this.Ties.push(i)}if(e.IsTieDestination){i=new AlphaTab.Rendering.Glyphs.ScoreTieGlyph(e.TieOrigin,e,!0);this.Ties.push(i)}else if(e.IsHammerPullOrigin){if(null==e.HammerPullOrigin){for(var t=e.HammerPullDestination;null!=t.HammerPullDestination;)t=t.HammerPullDestination;i=new AlphaTab.Rendering.Glyphs.ScoreTieGlyph(e,t,!1);this.Ties.push(i)}}else if(e.get_IsHammerPullDestination()){if(null==e.HammerPullDestination){for(var a=e.HammerPullOrigin;null!=a.HammerPullOrigin;)a=a.HammerPullOrigin;i=new AlphaTab.Rendering.Glyphs.ScoreTieGlyph(a,e,!0);this.Ties.push(i)}}else if(e.SlideType==AlphaTab.Model.SlideType.Legato){var i=new AlphaTab.Rendering.Glyphs.ScoreTieGlyph(e,e.SlideTarget,!1);this.Ties.push(i)}if(e.SlideType!=AlphaTab.Model.SlideType.None){var n=new AlphaTab.Rendering.Glyphs.ScoreSlideLineGlyph(e.SlideType,e,this);this.Ties.push(n)}}},$Inherit(AlphaTab.Rendering.ScoreBeatContainerGlyph,AlphaTab.Rendering.Glyphs.BeatContainerGlyph),AlphaTab.Rendering.Glyphs.ScoreBeatGlyph=function(){this.NoteHeads=null,this.RestGlyph=null,AlphaTab.Rendering.Glyphs.BeatOnNoteGlyphBase.call(this)},AlphaTab.Rendering.Glyphs.ScoreBeatGlyph.prototype={UpdateBeamingHelper:function(){null!=this.NoteHeads?this.NoteHeads.UpdateBeamingHelper(this.Container.X+this.X):null!=this.RestGlyph&&this.RestGlyph.UpdateBeamingHelper(this.Container.X+this.X)},DoLayout:function(){var e=this.Renderer;if(!this.Container.Beat.IsEmpty)if(this.Container.Beat.get_IsRest()){var t=0,a=0,i=0;switch(this.Container.Beat.Duration){case AlphaTab.Model.Duration.QuadrupleWhole:case AlphaTab.Model.Duration.DoubleWhole:a=6,t=5;break;case AlphaTab.Model.Duration.Whole:a=4,t=5;break;case AlphaTab.Model.Duration.Half:a=6,t=5;break;case AlphaTab.Model.Duration.Quarter:a=6,i=-2,t=5;break;case AlphaTab.Model.Duration.Eighth:case AlphaTab.Model.Duration.Sixteenth:a=6,t=5;break;case AlphaTab.Model.Duration.ThirtySecond:case AlphaTab.Model.Duration.SixtyFourth:case AlphaTab.Model.Duration.OneHundredTwentyEighth:case AlphaTab.Model.Duration.TwoHundredFiftySixth:a=6,t=3}var n=e.GetScoreY(a,i);if(this.RestGlyph=new AlphaTab.Rendering.Glyphs.ScoreRestGlyph(0,n,this.Container.Beat.Duration),this.RestGlyph.Beat=this.Container.Beat,this.RestGlyph.BeamingHelper=this.BeamingHelper,this.AddGlyph(this.RestGlyph),this.Container.Beat.Dots>0){this.AddGlyph(new AlphaTab.Rendering.Glyphs.SpacingGlyph(0,0,5*this.get_Scale()));for(h=0;h<this.Container.Beat.Dots;h++){p=new AlphaTab.Rendering.Glyphs.GlyphGroup(0,0);this.CreateBeatDot(t,p),this.AddGlyph(p)}}}else{this.NoteHeads=new AlphaTab.Rendering.Glyphs.ScoreNoteChordGlyph,this.NoteHeads.Beat=this.Container.Beat,this.NoteHeads.BeamingHelper=this.BeamingHelper;for(var r=0,l=this.Container.Beat.Notes,s=l.length,o=l[r];r<s;r++,o=l[r])this.CreateNoteGlyph(o);if(this.AddGlyph(this.NoteHeads),this.Container.Beat.Dots>0){this.AddGlyph(new AlphaTab.Rendering.Glyphs.SpacingGlyph(0,0,5*this.get_Scale()));for(var h=0;h<this.Container.Beat.Dots;h++){for(var p=new AlphaTab.Rendering.Glyphs.GlyphGroup(0,0),d=0,u=this.Container.Beat.Notes,c=u.length,o=u[d];d<c;d++,o=u[d])this.CreateBeatDot(e.GetNoteLine(o),p);this.AddGlyph(p)}}}AlphaTab.Rendering.Glyphs.BeatGlyphBase.prototype.DoLayout.call(this)},CreateBeatDot:function(e,t){var a=this.Renderer;t.AddGlyph(new AlphaTab.Rendering.Glyphs.CircleGlyph(0,a.GetScoreY(e,0),1.5*this.get_Scale()))},CreateNoteHeadGlyph:function(e){var t=this.Container.Beat.GraceType!=AlphaTab.Model.GraceType.None;if(e.Beat.Voice.Bar.Staff.Track.IsPercussion){var a=e.get_RealValue();return a<=30||a>=67||AlphaTab.Rendering.Glyphs.ScoreBeatGlyph.NormalKeys.hasOwnProperty(a)?new AlphaTab.Rendering.Glyphs.NoteHeadGlyph(0,0,AlphaTab.Model.Duration.Quarter,t):AlphaTab.Rendering.Glyphs.ScoreBeatGlyph.XKeys.hasOwnProperty(a)?new AlphaTab.Rendering.Glyphs.DrumSticksGlyph(0,0,t):46==a?new AlphaTab.Rendering.Glyphs.HiHatGlyph(0,0,t):49==a||57==a?new AlphaTab.Rendering.Glyphs.DiamondNoteHeadGlyph(0,0,t):52==a?new AlphaTab.Rendering.Glyphs.ChineseCymbalGlyph(0,0,t):51==a||53==a||59==a?new AlphaTab.Rendering.Glyphs.RideCymbalGlyph(0,0,t):new AlphaTab.Rendering.Glyphs.NoteHeadGlyph(0,0,AlphaTab.Model.Duration.Quarter,t)}return e.IsDead?new AlphaTab.Rendering.Glyphs.DeadNoteHeadGlyph(0,0,t):e.HarmonicType==AlphaTab.Model.HarmonicType.None?new AlphaTab.Rendering.Glyphs.NoteHeadGlyph(0,0,e.Beat.Duration,t):new AlphaTab.Rendering.Glyphs.DiamondNoteHeadGlyph(0,0,t)},CreateNoteGlyph:function(e){var t=this.Renderer,a=this.CreateNoteHeadGlyph(e),i=t.GetNoteLine(e);a.Y=t.GetScoreY(i,0),this.NoteHeads.AddNoteGlyph(a,e,i),e.IsStaccato&&!this.NoteHeads.BeatEffects.hasOwnProperty("Staccato")&&(this.NoteHeads.BeatEffects.Staccato=new AlphaTab.Rendering.Glyphs.CircleGlyph(0,0,1.5)),e.Accentuated!=AlphaTab.Model.AccentuationType.Normal||this.NoteHeads.BeatEffects.hasOwnProperty("Accent")||(this.NoteHeads.BeatEffects.Accent=new AlphaTab.Rendering.Glyphs.AccentuationGlyph(0,0,AlphaTab.Model.AccentuationType.Normal)),e.Accentuated!=AlphaTab.Model.AccentuationType.Heavy||this.NoteHeads.BeatEffects.hasOwnProperty("HAccent")||(this.NoteHeads.BeatEffects.HAccent=new AlphaTab.Rendering.Glyphs.AccentuationGlyph(0,0,AlphaTab.Model.AccentuationType.Heavy))}},$StaticConstructor(function(){AlphaTab.Rendering.Glyphs.ScoreBeatGlyph.NormalKeys=null,AlphaTab.Rendering.Glyphs.ScoreBeatGlyph.XKeys=null,AlphaTab.Rendering.Glyphs.ScoreBeatGlyph.NormalKeys={};for(var e=new Int32Array([32,34,35,36,38,39,40,41,43,45,47,48,50,55,56,58,60,61]),t=0;t<e.length;t++)AlphaTab.Rendering.Glyphs.ScoreBeatGlyph.NormalKeys[e[t]]=!0;AlphaTab.Rendering.Glyphs.ScoreBeatGlyph.XKeys={};for(var a=new Int32Array([31,33,37,42,44,54,62,63,64,65,66]),t=0;t<a.length;t++)AlphaTab.Rendering.Glyphs.ScoreBeatGlyph.XKeys[a[t]]=!0}),$Inherit(AlphaTab.Rendering.Glyphs.ScoreBeatGlyph,AlphaTab.Rendering.Glyphs.BeatOnNoteGlyphBase),AlphaTab.Rendering.Glyphs.ScoreBeatPreNotesGlyph=function(){AlphaTab.Rendering.Glyphs.BeatGlyphBase.call(this)},AlphaTab.Rendering.Glyphs.ScoreBeatPreNotesGlyph.prototype={DoLayout:function(){if(!this.Container.Beat.get_IsRest()){this.Container.Beat.BrushType!=AlphaTab.Model.BrushType.None&&(this.AddGlyph(new AlphaTab.Rendering.Glyphs.ScoreBrushGlyph(this.Container.Beat)),this.AddGlyph(new AlphaTab.Rendering.Glyphs.SpacingGlyph(0,0,4*this.get_Scale())));for(var e=new AlphaTab.Rendering.Glyphs.AccidentalGroupGlyph,t=0,a=this.Container.Beat.Notes,i=a.length,n=a[t];t<i;t++,n=a[t])this.CreateAccidentalGlyph(n,e);e.get_IsEmpty()||(this.AddGlyph(e),this.AddGlyph(new AlphaTab.Rendering.Glyphs.SpacingGlyph(0,0,4*(this.Container.Beat.GraceType!=AlphaTab.Model.GraceType.None?.75:1)*this.get_Scale())))}AlphaTab.Rendering.Glyphs.BeatGlyphBase.prototype.DoLayout.call(this)},CreateAccidentalGlyph:function(e,t){var a=this.Renderer,i=a.AccidentalHelper.ApplyAccidental(e),n=a.GetNoteLine(e),r=this.Container.Beat.GraceType!=AlphaTab.Model.GraceType.None;switch(i){case AlphaTab.Model.AccidentalType.Sharp:t.AddGlyph(new AlphaTab.Rendering.Glyphs.SharpGlyph(0,a.GetScoreY(n,0),r));break;case AlphaTab.Model.AccidentalType.Flat:t.AddGlyph(new AlphaTab.Rendering.Glyphs.FlatGlyph(0,a.GetScoreY(n,0),r));break;case AlphaTab.Model.AccidentalType.Natural:t.AddGlyph(new AlphaTab.Rendering.Glyphs.NaturalizeGlyph(0,a.GetScoreY(n,0),r))}}},$Inherit(AlphaTab.Rendering.Glyphs.ScoreBeatPreNotesGlyph,AlphaTab.Rendering.Glyphs.BeatGlyphBase),AlphaTab.Rendering.Glyphs.ScoreBrushGlyph=function(e){this._beat=null,AlphaTab.Rendering.Glyphs.Glyph.call(this,0,0),this._beat=e},AlphaTab.Rendering.Glyphs.ScoreBrushGlyph.prototype={DoLayout:function(){this.Width=10*this.get_Scale()},Paint:function(e,t,a){var i=this.Renderer,n=i.get_LineOffset(),r=t+this.Y+(i.GetNoteY(this._beat.get_MaxNote())-n/2),l=t+this.Y+i.GetNoteY(this._beat.get_MinNote())+n,s=e+this.X+this.Width/2,o=8*this.get_Scale();this._beat.BrushType!=AlphaTab.Model.BrushType.None&&(this._beat.BrushType==AlphaTab.Model.BrushType.ArpeggioUp?(a.BeginPath(),a.MoveTo(s,l),a.LineTo(s+o/2,l-o),a.LineTo(s-o/2,l-o),a.ClosePath(),a.Fill()):this._beat.BrushType==AlphaTab.Model.BrushType.ArpeggioDown&&(a.BeginPath(),a.MoveTo(s,r),a.LineTo(s+o/2,r+o),a.LineTo(s-o/2,r+o),a.ClosePath(),a.Fill()))}},$Inherit(AlphaTab.Rendering.Glyphs.ScoreBrushGlyph,AlphaTab.Rendering.Glyphs.Glyph),AlphaTab.Rendering.Glyphs.ScoreNoteGlyphInfo=function(e,t){this.Glyph=null,this.Line=0,this.Glyph=e,this.Line=t},AlphaTab.Rendering.Glyphs.ScoreNoteChordGlyph=function(){this._infos=null,this._noteLookup=null,this._tremoloPicking=null,this._noteHeadPadding=0,this.MinNote=null,this.MaxNote=null,this.SpacingChanged=null,this.UpLineX=0,this.DownLineX=0,this.BeatEffects=null,this.Beat=null,this.BeamingHelper=null,AlphaTab.Rendering.Glyphs.Glyph.call(this,0,0),this._infos=[],this.BeatEffects={},this._noteLookup={}},AlphaTab.Rendering.Glyphs.ScoreNoteChordGlyph.prototype={get_Direction:function(){return this.BeamingHelper.Direction},GetNoteX:function(e,t){if(this._noteLookup.hasOwnProperty(e.String)){var a=this._noteLookup[e.String],i=this.X+a.X;return t&&(i+=a.Width),i}return 0},GetNoteY:function(e){return this._noteLookup.hasOwnProperty(e.String)?this.Y+this._noteLookup[e.String].Y:0},AddNoteGlyph:function(e,t,a){var i=new AlphaTab.Rendering.Glyphs.ScoreNoteGlyphInfo(e,a);this._infos.push(i),this._noteLookup[t.String]=e,(null==this.MinNote||this.MinNote.Line>i.Line)&&(this.MinNote=i),(null==this.MaxNote||this.MaxNote.Line<i.Line)&&(this.MaxNote=i)},UpdateBeamingHelper:function(e){null!=this.BeamingHelper&&this.BeamingHelper.RegisterBeatLineX("score",this.Beat,e+this.X+this.UpLineX,e+this.X+this.DownLineX)},get_HasTopOverflow:function(){return null!=this.MinNote&&this.MinNote.Line<0},get_HasBottomOverflow:function(){return null!=this.MaxNote&&this.MaxNote.Line>8},DoLayout:function(){this._infos.sort($CreateAnonymousDelegate(this,function(e,t){return e.Line-t.Line}));for(var e=0,t=!1,a=0,i=!1,n=this.get_Direction(),r=0,l=0,s=this._infos.length;l<s;l++){var o=this._infos[l].Glyph;o.Renderer=this.Renderer,o.DoLayout();var h=!1;0==l?e=o.Width+0:Math.abs(a-this._infos[l].Line)<=1?t?t=!1:(h=!0,o.X=e-this.get_Scale(),i=!0,t=!0):t=!1,n==AlphaTab.Rendering.Utils.BeamDirection.Down?o.X=h?0:e:o.X=h?e:0,a=this._infos[l].Line,r=Math.max(r,o.X+o.Width)}i?(this._noteHeadPadding=0,this.UpLineX=e,this.DownLineX=e):(this._noteHeadPadding=n==AlphaTab.Rendering.Utils.BeamDirection.Down?-e:0,r+=this._noteHeadPadding,this.UpLineX=r,this.DownLineX=0);for(var p in this.BeatEffects){var d=this.BeatEffects[p];d.Renderer=this.Renderer,d.DoLayout()}if(this.Beat.get_IsTremolo()){var u,c=n==AlphaTab.Rendering.Utils.BeamDirection.Up?this.MinNote:this.MaxNote,T=n==AlphaTab.Rendering.Utils.BeamDirection.Up?e:0;switch(this.Beat.TremoloSpeed){case AlphaTab.Model.Duration.ThirtySecond:u=n==AlphaTab.Rendering.Utils.BeamDirection.Up?-15:15;break;case AlphaTab.Model.Duration.Sixteenth:u=n==AlphaTab.Rendering.Utils.BeamDirection.Up?-12:15;break;case AlphaTab.Model.Duration.Eighth:u=n==AlphaTab.Rendering.Utils.BeamDirection.Up?-10:10;break;default:u=n==AlphaTab.Rendering.Utils.BeamDirection.Up?-10:15}this._tremoloPicking=new AlphaTab.Rendering.Glyphs.TremoloPickingGlyph(T,c.Glyph.Y+u*this.get_Scale(),this.Beat.TremoloSpeed),this._tremoloPicking.Renderer=this.Renderer,this._tremoloPicking.DoLayout()}this.Width=r+0},Paint:function(e,t,a){e+=this.X,t+=this.Y;var i=this.Renderer,n=this.BeamingHelper.Direction==AlphaTab.Rendering.Utils.BeamDirection.Up?i.GetScoreY(this.MaxNote.Line,13.5):i.GetScoreY(this.MinNote.Line,-9),r=this.BeamingHelper.Direction==AlphaTab.Rendering.Utils.BeamDirection.Up?7*this.get_Scale():-7*this.get_Scale();for(var l in this.BeatEffects)(f=this.BeatEffects[l]).Y=n,f.X=this.Width/2,f.Paint(e,t,a),n+=r;var s=3*this.get_Scale(),o=this.Width+2*s;if(this.get_HasTopOverflow()){h=a.get_Color();a.set_Color(this.Renderer.ScoreRenderer.RenderingResources.StaveLineColor);for(p=-1;p>=this.MinNote.Line;){d=t+i.GetScoreY(p,0);a.FillRect(e-s,d,o,this.get_Scale()),p-=2}a.set_Color(h)}if(this.get_HasBottomOverflow()){var h=a.get_Color();a.set_Color(this.Renderer.ScoreRenderer.RenderingResources.StaveLineColor);for(var p=12;p<=this.MaxNote.Line;){var d=t+i.GetScoreY(p,0);a.FillRect(e-s,d,o,this.get_Scale()),p+=2}a.set_Color(h)}null!=this._tremoloPicking&&this._tremoloPicking.Paint(e,t,a);for(var u=this._infos,c=e+this._noteHeadPadding,T=0,g=u.length,f=u[T];T<g;T++,f=u[T])f.Glyph.Renderer=this.Renderer,f.Glyph.Paint(c,t,a)}},$Inherit(AlphaTab.Rendering.Glyphs.ScoreNoteChordGlyph,AlphaTab.Rendering.Glyphs.Glyph),AlphaTab.Rendering.Glyphs.ScoreSlideLineGlyph=function(e,t,a){this._startNote=null,this._type=AlphaTab.Model.SlideType.None,this._parent=null,AlphaTab.Rendering.Glyphs.Glyph.call(this,0,0),this._type=e,this._startNote=t,this._parent=a},AlphaTab.Rendering.Glyphs.ScoreSlideLineGlyph.prototype={DoLayout:function(){this.Width=0},Paint:function(e,t,a){var i=this.Renderer;e+=i.X,t+=i.Y;var n,r,l,s,o=12*this.get_Scale(),h=1*this.get_Scale();switch(this._type){case AlphaTab.Model.SlideType.Shift:case AlphaTab.Model.SlideType.Legato:n=e+i.GetNoteX(this._startNote,!0)+h,r=t+i.GetNoteY(this._startNote)+4.5,null!=this._startNote.SlideTarget?(l=e+i.GetNoteX(this._startNote.SlideTarget,!1)-h,s=t+i.GetNoteY(this._startNote.SlideTarget)+4.5):(l=e+this._parent.X,s=r);break;case AlphaTab.Model.SlideType.IntoFromBelow:l=e+i.GetNoteX(this._startNote,!1)-h,s=t+i.GetNoteY(this._startNote)+4.5,n=l-o,r=t+i.GetNoteY(this._startNote)+9;break;case AlphaTab.Model.SlideType.IntoFromAbove:l=e+i.GetNoteX(this._startNote,!1)-h,s=t+i.GetNoteY(this._startNote)+4.5,n=l-o,r=t+i.GetNoteY(this._startNote);break;case AlphaTab.Model.SlideType.OutUp:n=e+i.GetNoteX(this._startNote,!0)+h,r=t+i.GetNoteY(this._startNote)+4.5,l=n+o,s=t+i.GetNoteY(this._startNote);break;case AlphaTab.Model.SlideType.OutDown:n=e+i.GetNoteX(this._startNote,!0)+h,r=t+i.GetNoteY(this._startNote)+4.5,l=n+o,s=t+i.GetNoteY(this._startNote)+9;break;default:return}a.BeginPath(),a.MoveTo(n,r),a.LineTo(l,s),a.Stroke()}},$Inherit(AlphaTab.Rendering.Glyphs.ScoreSlideLineGlyph,AlphaTab.Rendering.Glyphs.Glyph),AlphaTab.Rendering.Glyphs.ScoreTieGlyph=function(e,t,a){this._startNote=null,this._endNote=null,AlphaTab.Rendering.Glyphs.TieGlyph.call(this,null==e?null:e.Beat,null==t?null:t.Beat,a),this._startNote=e,this._endNote=t},AlphaTab.Rendering.Glyphs.ScoreTieGlyph.prototype={DoLayout:function(){AlphaTab.Rendering.Glyphs.TieGlyph.prototype.DoLayout.call(this),this.YOffset=4.5},GetBeamDirection:function(e,t){switch(t.GetBeatDirection(e)){case AlphaTab.Rendering.Utils.BeamDirection.Up:return AlphaTab.Rendering.Utils.BeamDirection.Down;case AlphaTab.Rendering.Utils.BeamDirection.Down:default:return AlphaTab.Rendering.Utils.BeamDirection.Up}},GetStartY:function(e,t){return e.GetNoteY(this._startNote)},GetEndY:function(e,t){return e.GetNoteY(this._endNote)},GetStartX:function(e){return e.GetNoteX(this._startNote,!0)},GetEndX:function(e){return e.GetNoteX(this._endNote,!1)}},$Inherit(AlphaTab.Rendering.Glyphs.ScoreTieGlyph,AlphaTab.Rendering.Glyphs.TieGlyph),AlphaTab.Rendering.Glyphs.SharpGlyph=function(e,t,a){this._isGrace=!1,AlphaTab.Rendering.Glyphs.MusicFontGlyph.call(this,e,t,a?.75:1,AlphaTab.Rendering.Glyphs.MusicFontSymbol.AccidentalSharp),this._isGrace=a},AlphaTab.Rendering.Glyphs.SharpGlyph.prototype={DoLayout:function(){this.Width=8*(this._isGrace?.75:1)*this.get_Scale()}},$Inherit(AlphaTab.Rendering.Glyphs.SharpGlyph,AlphaTab.Rendering.Glyphs.MusicFontGlyph),AlphaTab.Rendering.Glyphs.SpacingGlyph=function(e,t,a){AlphaTab.Rendering.Glyphs.Glyph.call(this,e,t),this.Width=a},$Inherit(AlphaTab.Rendering.Glyphs.SpacingGlyph,AlphaTab.Rendering.Glyphs.Glyph),AlphaTab.Rendering.Glyphs.TabBeatContainerGlyph=function(e,t){this._bendGlyphs=null,AlphaTab.Rendering.Glyphs.BeatContainerGlyph.call(this,e,t)},AlphaTab.Rendering.Glyphs.TabBeatContainerGlyph.prototype={DoLayout:function(){AlphaTab.Rendering.Glyphs.BeatContainerGlyph.prototype.DoLayout.call(this),this._bendGlyphs=[];for(var e=0;e<this.Beat.Notes.length;e++){var t=this.Beat.Notes[e];if(t.get_HasBend()){var a=6*t.MaxBendPoint.Value;this.Renderer.RegisterOverflowTop(a);var i=new AlphaTab.Rendering.Glyphs.BendGlyph(t,6);i.X=this.OnNotes.X+this.OnNotes.Width,i.Renderer=this.Renderer,this._bendGlyphs.push(i)}}},ScaleToWidth:function(e){AlphaTab.Rendering.Glyphs.BeatContainerGlyph.prototype.ScaleToWidth.call(this,e);for(var t=0;t<this._bendGlyphs.length;t++){var a=this._bendGlyphs[t];a.Width=e-a.X}},CreateTies:function(e){var t=this.Renderer;if(e.IsTieOrigin&&t.ShowTiedNotes){n=new AlphaTab.Rendering.Glyphs.TabTieGlyph(e,e.TieDestination,!1,!1);this.Ties.push(n)}if(e.IsTieDestination&&t.ShowTiedNotes){n=new AlphaTab.Rendering.Glyphs.TabTieGlyph(e.TieOrigin,e,!1,!0);this.Ties.push(n)}else if(e.IsHammerPullOrigin){if(null==e.HammerPullOrigin){for(var a=e.HammerPullDestination;null!=a.HammerPullDestination;)a=a.HammerPullDestination;n=new AlphaTab.Rendering.Glyphs.TabTieGlyph(e,a,!1,!1);this.Ties.push(n)}}else if(e.get_IsHammerPullDestination()){if(null==e.HammerPullDestination){for(var i=e.HammerPullOrigin;null!=i.HammerPullOrigin;)i=i.HammerPullOrigin;n=new AlphaTab.Rendering.Glyphs.TabTieGlyph(i,e,!1,!0);this.Ties.push(n)}}else if(e.SlideType==AlphaTab.Model.SlideType.Legato){var n=new AlphaTab.Rendering.Glyphs.TabTieGlyph(e,e.SlideTarget,!0,!1);this.Ties.push(n)}if(e.SlideType!=AlphaTab.Model.SlideType.None){var r=new AlphaTab.Rendering.Glyphs.TabSlideLineGlyph(e.SlideType,e,this);this.Ties.push(r)}},Paint:function(e,t,a){AlphaTab.Rendering.Glyphs.BeatContainerGlyph.prototype.Paint.call(this,e,t,a);for(var i=0;i<this._bendGlyphs.length;i++)this._bendGlyphs[i].Paint(e+this.X,t+this.Y,a)}},$Inherit(AlphaTab.Rendering.Glyphs.TabBeatContainerGlyph,AlphaTab.Rendering.Glyphs.BeatContainerGlyph),AlphaTab.Rendering.Glyphs.TabBeatGlyph=function(){this.NoteNumbers=null,this.RestGlyph=null,AlphaTab.Rendering.Glyphs.BeatOnNoteGlyphBase.call(this)},AlphaTab.Rendering.Glyphs.TabBeatGlyph.prototype={DoLayout:function(){var e=this.Renderer;if(this.Container.Beat.get_IsRest()){var t=0,a=0;switch(this.Container.Beat.Duration){case AlphaTab.Model.Duration.QuadrupleWhole:case AlphaTab.Model.Duration.DoubleWhole:t=3,2;break;case AlphaTab.Model.Duration.Whole:t=2,2;break;case AlphaTab.Model.Duration.Half:t=3,3;break;case AlphaTab.Model.Duration.Quarter:t=3,2.5;break;case AlphaTab.Model.Duration.Eighth:case AlphaTab.Model.Duration.Sixteenth:t=2,2.5,a=5;break;case AlphaTab.Model.Duration.ThirtySecond:case AlphaTab.Model.Duration.SixtyFourth:case AlphaTab.Model.Duration.OneHundredTwentyEighth:case AlphaTab.Model.Duration.TwoHundredFiftySixth:t=3,2.5}var i=e.GetTabY(t,a);if(this.RestGlyph=new AlphaTab.Rendering.Glyphs.TabRestGlyph(0,i,e.ShowRests,this.Container.Beat.Duration),this.RestGlyph.Beat=this.Container.Beat,this.RestGlyph.BeamingHelper=this.BeamingHelper,this.AddGlyph(this.RestGlyph),this.Container.Beat.Dots>0&&e.ShowRests){this.AddGlyph(new AlphaTab.Rendering.Glyphs.SpacingGlyph(0,0,5*this.get_Scale()));for(d=0;d<this.Container.Beat.Dots;d++)this.AddGlyph(new AlphaTab.Rendering.Glyphs.CircleGlyph(0,i,1.5*this.get_Scale()))}}else{this.NoteNumbers=new AlphaTab.Rendering.Glyphs.TabNoteChordGlyph(0,0,this.Container.Beat.GraceType!=AlphaTab.Model.GraceType.None),this.NoteNumbers.Beat=this.Container.Beat,this.NoteNumbers.BeamingHelper=this.BeamingHelper;for(var n=0,r=this.Container.Beat.Notes,l=r.length,s=r[n];n<l;n++,s=r[n])this.CreateNoteGlyph(s);if(this.AddGlyph(this.NoteNumbers),this.Container.Beat.get_HasWhammyBar()&&!this.NoteNumbers.BeatEffects.hasOwnProperty("Whammy")){this.NoteNumbers.BeatEffects.Whammy=new AlphaTab.Rendering.Glyphs.WhammyBarGlyph(this.Container.Beat,this.Container);var o=60*this.get_Scale()/24,h=this.Container.Beat.MaxWhammyPoint.Value*o;this.Renderer.RegisterOverflowTop(h)}if(this.Container.Beat.get_IsTremolo()&&!this.NoteNumbers.BeatEffects.hasOwnProperty("Tremolo")){a=0;switch(this.Container.Beat.TremoloSpeed){case AlphaTab.Model.Duration.ThirtySecond:a=10;break;case AlphaTab.Model.Duration.Sixteenth:a=5;break;case AlphaTab.Model.Duration.Eighth:a=0}this.NoteNumbers.BeatEffects.Tremolo=new AlphaTab.Rendering.Glyphs.TremoloPickingGlyph(5*this.get_Scale(),a*this.get_Scale(),this.Container.Beat.TremoloSpeed)}if(this.Container.Beat.Dots>0&&e.RenderRhythm){this.AddGlyph(new AlphaTab.Rendering.Glyphs.SpacingGlyph(0,0,5*this.get_Scale()));for(d=0;d<this.Container.Beat.Dots;d++)this.AddGlyph(new AlphaTab.Rendering.Glyphs.CircleGlyph(0,e.get_LineOffset()*e.Bar.Staff.Track.Tuning.length+e.RhythmHeight,1.5*this.get_Scale()))}}if(null!=this.Glyphs){for(var p=0,d=0,u=this.Glyphs.length;d<u;d++){var c=this.Glyphs[d];c.X=p,c.Renderer=this.Renderer,c.DoLayout(),p+=c.Width}this.Width=p}},UpdateBeamingHelper:function(){this.Container.Beat.get_IsRest()?this.RestGlyph.UpdateBeamingHelper(this.Container.X+this.X):this.NoteNumbers.UpdateBeamingHelper(this.Container.X+this.X)},CreateNoteGlyph:function(e){var t=this.Renderer,a=new AlphaTab.Rendering.Glyphs.NoteNumberGlyph(0,0,e),i=e.Beat.Voice.Bar.Staff.Track.Tuning.length-e.String+1;a.Y=t.GetTabY(i,-2),a.Renderer=this.Renderer,a.DoLayout(),this.NoteNumbers.AddNoteGlyph(a,e)}},$Inherit(AlphaTab.Rendering.Glyphs.TabBeatGlyph,AlphaTab.Rendering.Glyphs.BeatOnNoteGlyphBase),AlphaTab.Rendering.Glyphs.TabBeatPreNotesGlyph=function(){AlphaTab.Rendering.Glyphs.BeatGlyphBase.call(this)},AlphaTab.Rendering.Glyphs.TabBeatPreNotesGlyph.prototype={DoLayout:function(){this.Container.Beat.BrushType==AlphaTab.Model.BrushType.None||this.Container.Beat.get_IsRest()||(this.AddGlyph(new AlphaTab.Rendering.Glyphs.TabBrushGlyph(this.Container.Beat)),this.AddGlyph(new AlphaTab.Rendering.Glyphs.SpacingGlyph(0,0,4*this.get_Scale()))),AlphaTab.Rendering.Glyphs.BeatGlyphBase.prototype.DoLayout.call(this)}},$Inherit(AlphaTab.Rendering.Glyphs.TabBeatPreNotesGlyph,AlphaTab.Rendering.Glyphs.BeatGlyphBase),AlphaTab.Rendering.Glyphs.TabBrushGlyph=function(e){this._beat=null,AlphaTab.Rendering.Glyphs.Glyph.call(this,0,0),this._beat=e},AlphaTab.Rendering.Glyphs.TabBrushGlyph.prototype={DoLayout:function(){this.Width=10*this.get_Scale()},Paint:function(e,t,a){var i=this.Renderer,n=this.Renderer.get_Resources(),r=t+this.X+(i.GetNoteY(this._beat.get_MaxNote())-n.TablatureFont.Size/2),l=t+this.Y+i.GetNoteY(this._beat.get_MinNote())+n.TablatureFont.Size/2,s=e+this.X+this.Width/2|0,o=8*this.get_Scale();this._beat.BrushType!=AlphaTab.Model.BrushType.None&&(this._beat.BrushType!=AlphaTab.Model.BrushType.BrushUp&&this._beat.BrushType!=AlphaTab.Model.BrushType.BrushDown||(a.BeginPath(),a.MoveTo(s,r),a.LineTo(s,l),a.Stroke()),this._beat.BrushType==AlphaTab.Model.BrushType.BrushUp||this._beat.BrushType==AlphaTab.Model.BrushType.ArpeggioUp?(a.BeginPath(),a.MoveTo(s,l),a.LineTo(s+o/2,l-o),a.LineTo(s-o/2,l-o),a.ClosePath(),a.Fill()):(a.BeginPath(),a.MoveTo(s,r),a.LineTo(s+o/2,r+o),a.LineTo(s-o/2,r+o),a.ClosePath(),a.Fill()))}},$Inherit(AlphaTab.Rendering.Glyphs.TabBrushGlyph,AlphaTab.Rendering.Glyphs.Glyph),AlphaTab.Rendering.Glyphs.TabClefGlyph=function(e,t){AlphaTab.Rendering.Glyphs.Glyph.call(this,e,t)},AlphaTab.Rendering.Glyphs.TabClefGlyph.prototype={DoLayout:function(){this.Width=28*this.get_Scale()},Paint:function(e,t,a){var i=this.Renderer.Bar.Staff.Track.Tuning.length,n=i*this.get_Scale()*.5,r=i<=4?AlphaTab.Rendering.Glyphs.MusicFontSymbol.ClefTabSmall:AlphaTab.Rendering.Glyphs.MusicFontSymbol.ClefTab,l=i<=4?i/4.5:i/6.5;a.FillMusicFontSymbol(e+this.X+5*this.get_Scale(),t+this.Y-n,l*this.get_Scale(),r)}},$Inherit(AlphaTab.Rendering.Glyphs.TabClefGlyph,AlphaTab.Rendering.Glyphs.Glyph),AlphaTab.Rendering.Glyphs.TabNoteChordGlyph=function(e,t,a){this._notes=null,this._isGrace=!1,this.Beat=null,this.BeamingHelper=null,this.MinStringNote=null,this.BeatEffects=null,this.NotesPerString=null,AlphaTab.Rendering.Glyphs.Glyph.call(this,e,t),this._isGrace=a,this._notes=[],this.BeatEffects={},this.NotesPerString={}},AlphaTab.Rendering.Glyphs.TabNoteChordGlyph.prototype={GetNoteX:function(e,t){if(this.NotesPerString.hasOwnProperty(e.String)){var a=this.NotesPerString[e.String],i=this.X+a.X;return t&&(i+=a.Width),i}return 0},GetNoteY:function(e){return this.NotesPerString.hasOwnProperty(e.String)?this.Y+this.NotesPerString[e.String].Y:0},DoLayout:function(){for(var e=0,t=0,a=this._notes.length;t<a;t++)(s=this._notes[t]).Renderer=this.Renderer,s.DoLayout(),s.Width>e&&(e=s.Width);var i=this.Renderer.get_Resources().TablatureFont.Size,n=this.GetNoteY(this.MinStringNote)+i/2,r=7*this.get_Scale();for(var l in this.BeatEffects){var s=this.BeatEffects[l];s.Y+=n,s.X+=this.Width/2,s.Renderer=this.Renderer,n+=r,s.DoLayout()}this.Width=e},AddNoteGlyph:function(e,t){this._notes.push(e),this.NotesPerString[t.String]=e,(null==this.MinStringNote||t.String<this.MinStringNote.String)&&(this.MinStringNote=t)},Paint:function(e,t,a){e+=this.X,t+=this.Y;var i=this.Renderer.get_Resources(),n=a.get_TextBaseline();a.set_TextBaseline(AlphaTab.Platform.Model.TextBaseline.Middle),a.set_Font(this._isGrace?i.GraceFont:i.TablatureFont);for(var r=this._notes,l=this.Width,s=0,o=r.length,h=r[s];s<o;s++,h=r[s])h.Renderer=this.Renderer,h.Width=l,h.Paint(e,t,a);a.set_TextBaseline(n);for(var p in this.BeatEffects)(h=this.BeatEffects[p]).Paint(e,t,a)},UpdateBeamingHelper:function(e){null!=this.BeamingHelper&&this.BeamingHelper.IsPositionFrom("tab",this.Beat)&&this.BeamingHelper.RegisterBeatLineX("tab",this.Beat,e+this.X+this.Width,e+this.X)}},$Inherit(AlphaTab.Rendering.Glyphs.TabNoteChordGlyph,AlphaTab.Rendering.Glyphs.Glyph),AlphaTab.Rendering.Glyphs.TabRestGlyph=function(e,t,a,i){this._isVisibleRest=!1,this._duration=AlphaTab.Model.Duration.QuadrupleWhole,this.BeamingHelper=null,AlphaTab.Rendering.Glyphs.MusicFontGlyph.call(this,e,t,1,AlphaTab.Rendering.Glyphs.ScoreRestGlyph.GetSymbol(i)),this._isVisibleRest=a,this._duration=i},AlphaTab.Rendering.Glyphs.TabRestGlyph.prototype={DoLayout:function(){this._isVisibleRest?this.Width=AlphaTab.Rendering.Glyphs.ScoreRestGlyph.GetSize(this._duration)*this.get_Scale():this.Width=10*this.get_Scale()},UpdateBeamingHelper:function(e){null!=this.BeamingHelper&&this.BeamingHelper.IsPositionFrom("tab",this.Beat)&&this.BeamingHelper.RegisterBeatLineX("tab",this.Beat,e+this.X+this.Width,e+this.X)},Paint:function(e,t,a){this._isVisibleRest&&AlphaTab.Rendering.Glyphs.MusicFontGlyph.prototype.Paint.call(this,e,t,a)}},$Inherit(AlphaTab.Rendering.Glyphs.TabRestGlyph,AlphaTab.Rendering.Glyphs.MusicFontGlyph),AlphaTab.Rendering.Glyphs.TabSlideLineGlyph=function(e,t,a){this._startNote=null,this._type=AlphaTab.Model.SlideType.None,this._parent=null,AlphaTab.Rendering.Glyphs.Glyph.call(this,0,0),this._type=e,this._startNote=t,this._parent=a},AlphaTab.Rendering.Glyphs.TabSlideLineGlyph.prototype={DoLayout:function(){this.Width=0},Paint:function(e,t,a){var i=this.Renderer;e+=i.X,t+=i.Y;var n,r,l,s,o=12*this.get_Scale(),h=3*this.get_Scale();switch(this._type){case AlphaTab.Model.SlideType.Shift:case AlphaTab.Model.SlideType.Legato:var p,d;null==this._startNote.SlideTarget?(p=0,d=0):this._startNote.SlideTarget.Fret>this._startNote.Fret?(p=h,d=-1*h):(p=-1*h,d=h),n=e+i.GetNoteX(this._startNote,!0),r=t+i.GetNoteY(this._startNote)+p,null!=this._startNote.SlideTarget?(l=e+i.GetNoteX(this._startNote.SlideTarget,!1),s=t+i.GetNoteY(this._startNote.SlideTarget)+d):(l=e+this._parent.X,s=r);break;case AlphaTab.Model.SlideType.IntoFromBelow:l=e+i.GetNoteX(this._startNote,!1),s=t+i.GetNoteY(this._startNote),n=l-o,r=t+i.GetNoteY(this._startNote)+h;break;case AlphaTab.Model.SlideType.IntoFromAbove:l=e+i.GetNoteX(this._startNote,!1),s=t+i.GetNoteY(this._startNote),n=l-o,r=t+i.GetNoteY(this._startNote)-h;break;case AlphaTab.Model.SlideType.OutUp:n=e+i.GetNoteX(this._startNote,!0),r=t+i.GetNoteY(this._startNote),l=n+o,s=t+i.GetNoteY(this._startNote)-h;break;case AlphaTab.Model.SlideType.OutDown:n=e+i.GetNoteX(this._startNote,!0),r=t+i.GetNoteY(this._startNote),l=n+o,s=t+i.GetNoteY(this._startNote)+h;break;default:return}a.BeginPath(),a.MoveTo(n,r),a.LineTo(l,s),a.Stroke()}},$Inherit(AlphaTab.Rendering.Glyphs.TabSlideLineGlyph,AlphaTab.Rendering.Glyphs.Glyph),AlphaTab.Rendering.Glyphs.TabTieGlyph=function(e,t,a,i){this._startNote=null,this._endNote=null,this._forSlide=!1,AlphaTab.Rendering.Glyphs.TieGlyph.call(this,e.Beat,t.Beat,i),this._startNote=e,this._endNote=t,this._forSlide=a},AlphaTab.Rendering.Glyphs.TabTieGlyph.prototype={get_Offset:function(){return this._forSlide?5*this.get_Scale():0},GetBeamDirection:function(e,t){return this._startNote.String>3?AlphaTab.Rendering.Utils.BeamDirection.Down:AlphaTab.Rendering.Utils.BeamDirection.Up},GetStartY:function(e,t){return e.GetNoteY(this._startNote)-this.get_Offset()},GetEndY:function(e,t){return e.GetNoteY(this._endNote)-this.get_Offset()},GetStartX:function(e){return e.GetNoteX(this._startNote,!0)},GetEndX:function(e){return e.GetNoteX(this._endNote,!1)}},$Inherit(AlphaTab.Rendering.Glyphs.TabTieGlyph,AlphaTab.Rendering.Glyphs.TieGlyph),AlphaTab.Rendering.Glyphs.TempoGlyph=function(e,t,a){this._tempo=0,AlphaTab.Rendering.Glyphs.EffectGlyph.call(this,e,t),this._tempo=a},AlphaTab.Rendering.Glyphs.TempoGlyph.prototype={DoLayout:function(){AlphaTab.Rendering.Glyphs.Glyph.prototype.DoLayout.call(this),this.Height=25*this.get_Scale()},Paint:function(e,t,a){var i=this.Renderer.get_Resources();a.set_Font(i.MarkerFont),a.FillMusicFontSymbol(e+this.X,t+this.Y+.8*this.Height,.75,AlphaTab.Rendering.Glyphs.MusicFontSymbol.Tempo),a.FillText("= "+this._tempo,e+this.X+this.Height/2,t+this.Y+a.get_Font().Size/2)}},$Inherit(AlphaTab.Rendering.Glyphs.TempoGlyph,AlphaTab.Rendering.Glyphs.EffectGlyph),AlphaTab.Rendering.Glyphs.TextGlyph=function(e,t,a,i,n){this._text=null,this.Font=null,this.TextAlign=AlphaTab.Platform.Model.TextAlign.Left,AlphaTab.Rendering.Glyphs.EffectGlyph.call(this,e,t),this._text=a,this.Font=i,this.TextAlign=n},AlphaTab.Rendering.Glyphs.TextGlyph.prototype={DoLayout:function(){AlphaTab.Rendering.Glyphs.Glyph.prototype.DoLayout.call(this),this.Height=this.Font.Size},Paint:function(e,t,a){a.set_Font(this.Font);var i=a.get_TextAlign();a.set_TextAlign(this.TextAlign),a.FillText(this._text,e+this.X,t+this.Y),a.set_TextAlign(i)}},$Inherit(AlphaTab.Rendering.Glyphs.TextGlyph,AlphaTab.Rendering.Glyphs.EffectGlyph),AlphaTab.Rendering.Glyphs.TimeSignatureGlyph=function(e,t,a,i,n){this._numerator=0,this._denominator=0,this._isCommon=!1,AlphaTab.Rendering.Glyphs.GlyphGroup.call(this,e,t),this._numerator=a,this._denominator=i,this._isCommon=n},AlphaTab.Rendering.Glyphs.TimeSignatureGlyph.prototype={DoLayout:function(){if(this._isCommon&&2==this._numerator&&2==this._denominator)(e=new AlphaTab.Rendering.Glyphs.MusicFontGlyph(0,this.get_CommonY(),this.get_CommonScale(),AlphaTab.Rendering.Glyphs.MusicFontSymbol.TimeSignatureCutCommon)).Width=14*this.get_Scale(),this.AddGlyph(e),AlphaTab.Rendering.Glyphs.GlyphGroup.prototype.DoLayout.call(this);else if(this._isCommon&&4==this._numerator&&4==this._denominator){var e=new AlphaTab.Rendering.Glyphs.MusicFontGlyph(0,this.get_CommonY(),this.get_CommonScale(),AlphaTab.Rendering.Glyphs.MusicFontSymbol.TimeSignatureCommon);e.Width=14*this.get_Scale(),this.AddGlyph(e),AlphaTab.Rendering.Glyphs.GlyphGroup.prototype.DoLayout.call(this)}else{var t=new AlphaTab.Rendering.Glyphs.NumberGlyph(0,this.get_NumeratorY(),this._numerator,this.get_NumberScale()),a=new AlphaTab.Rendering.Glyphs.NumberGlyph(0,this.get_DenominatorY(),this._denominator,this.get_NumberScale());this.AddGlyph(t),this.AddGlyph(a),AlphaTab.Rendering.Glyphs.GlyphGroup.prototype.DoLayout.call(this);for(var i=0,n=this.Glyphs.length;i<n;i++){var r=this.Glyphs[i];r.X=(this.Width-r.Width)/2}}}},$Inherit(AlphaTab.Rendering.Glyphs.TimeSignatureGlyph,AlphaTab.Rendering.Glyphs.GlyphGroup),AlphaTab.Rendering.Glyphs.ScoreTimeSignatureGlyph=function(e,t,a,i,n){AlphaTab.Rendering.Glyphs.TimeSignatureGlyph.call(this,e,t,a,i,n)},AlphaTab.Rendering.Glyphs.ScoreTimeSignatureGlyph.prototype={get_CommonY:function(){return this.Renderer.GetScoreY(4,0)},get_NumeratorY:function(){return 2*this.get_Scale()},get_DenominatorY:function(){return 20*this.get_Scale()},get_CommonScale:function(){return 1},get_NumberScale:function(){return 1}},$Inherit(AlphaTab.Rendering.Glyphs.ScoreTimeSignatureGlyph,AlphaTab.Rendering.Glyphs.TimeSignatureGlyph),AlphaTab.Rendering.Glyphs.TabTimeSignatureGlyph=function(e,t,a,i,n){AlphaTab.Rendering.Glyphs.TimeSignatureGlyph.call(this,e,t,a,i,n)},AlphaTab.Rendering.Glyphs.TabTimeSignatureGlyph.prototype={get_CommonY:function(){return this.Renderer.GetTabY(0,0)},get_NumeratorY:function(){var e=this.Renderer,t=e.Bar.Staff.Track.Tuning.length<=4?.25:.3333333;return e.get_LineOffset()*e.Bar.Staff.Track.Tuning.length*t*this.get_Scale()},get_DenominatorY:function(){var e=this.Renderer,t=(e.Bar.Staff.Track.Tuning.length,.6);return e.get_LineOffset()*e.Bar.Staff.Track.Tuning.length*t*this.get_Scale()},get_CommonScale:function(){return 1},get_NumberScale:function(){return this.Renderer.Bar.Staff.Track.Tuning.length<=4?.75:1}},$Inherit(AlphaTab.Rendering.Glyphs.TabTimeSignatureGlyph,AlphaTab.Rendering.Glyphs.TimeSignatureGlyph),AlphaTab.Rendering.Glyphs.TremoloPickingGlyph=function(e,t,a){AlphaTab.Rendering.Glyphs.MusicFontGlyph.call(this,e,t,1,AlphaTab.Rendering.Glyphs.TremoloPickingGlyph.GetSymbol(a))},AlphaTab.Rendering.Glyphs.TremoloPickingGlyph.prototype={DoLayout:function(){this.Width=12*this.get_Scale()}},AlphaTab.Rendering.Glyphs.TremoloPickingGlyph.GetSymbol=function(e){switch(e){case AlphaTab.Model.Duration.ThirtySecond:return AlphaTab.Rendering.Glyphs.MusicFontSymbol.TremoloPickingThirtySecond;case AlphaTab.Model.Duration.Sixteenth:return AlphaTab.Rendering.Glyphs.MusicFontSymbol.TremoloPickingSixteenth;case AlphaTab.Model.Duration.Eighth:return AlphaTab.Rendering.Glyphs.MusicFontSymbol.TremoloPickingEighth;default:return AlphaTab.Rendering.Glyphs.MusicFontSymbol.None}},$Inherit(AlphaTab.Rendering.Glyphs.TremoloPickingGlyph,AlphaTab.Rendering.Glyphs.MusicFontGlyph),AlphaTab.Rendering.Glyphs.TrillGlyph=function(e,t){AlphaTab.Rendering.Glyphs.EffectGlyph.call(this,e,t)},AlphaTab.Rendering.Glyphs.TrillGlyph.prototype={DoLayout:function(){AlphaTab.Rendering.Glyphs.Glyph.prototype.DoLayout.call(this),this.Height=20*this.get_Scale()},Paint:function(e,t,a){var i=this.Renderer.get_Resources();a.set_Font(i.MarkerFont);var n=a.MeasureText("tr");a.FillText("tr",e+this.X,t+this.Y+a.get_Font().Size/2);for(var r=n+3*this.get_Scale(),l=this.Width-r,s=11*this.get_Scale()*1.2,o=Math.max(1,(l-r)/s),h=r,p=t+this.Y+this.Height,d=0;d<o;d++)a.FillMusicFontSymbol(e+this.X+h,p,1.2,AlphaTab.Rendering.Glyphs.MusicFontSymbol.WaveHorizontal),h+=s}},$Inherit(AlphaTab.Rendering.Glyphs.TrillGlyph,AlphaTab.Rendering.Glyphs.EffectGlyph),AlphaTab.Rendering.Glyphs.TripletFeelGlyph=function(e){this._tripletFeel=AlphaTab.Model.TripletFeel.NoTripletFeel,AlphaTab.Rendering.Glyphs.EffectGlyph.call(this,0,0),this._tripletFeel=e},AlphaTab.Rendering.Glyphs.TripletFeelGlyph.prototype={DoLayout:function(){AlphaTab.Rendering.Glyphs.Glyph.prototype.DoLayout.call(this),this.Height=25*this.get_Scale()},Paint:function(e,t,a){e+=this.X;var i=(t+=this.Y)+.75*this.Height;a.set_Font(this.Renderer.get_Resources().EffectFont),a.FillText("(",e,t+.3*this.Height);var n=e+10*this.get_Scale(),r=e+40*this.get_Scale();switch(this._tripletFeel){case AlphaTab.Model.TripletFeel.NoTripletFeel:this.RenderBarNote(n,i,.4,a,[AlphaTab.Rendering.Glyphs.TripletFeelGlyph.BarType.Full]),this.RenderBarNote(r,i,.4,a,[AlphaTab.Rendering.Glyphs.TripletFeelGlyph.BarType.Full]);break;case AlphaTab.Model.TripletFeel.Triplet8th:this.RenderBarNote(n,i,.4,a,[AlphaTab.Rendering.Glyphs.TripletFeelGlyph.BarType.Full]),a.FillMusicFontSymbol(r,i,.4,AlphaTab.Rendering.Glyphs.MusicFontSymbol.Tempo),a.FillMusicFontSymbol(r+12*this.get_Scale(),i,.4,AlphaTab.Rendering.Glyphs.MusicFontSymbol.NoteEighth),this.RenderTriplet(r,t,a);break;case AlphaTab.Model.TripletFeel.Triplet16th:this.RenderBarNote(n,i,.4,a,[AlphaTab.Rendering.Glyphs.TripletFeelGlyph.BarType.Full,AlphaTab.Rendering.Glyphs.TripletFeelGlyph.BarType.Full]),this.RenderBarNote(r,i,.4,a,[AlphaTab.Rendering.Glyphs.TripletFeelGlyph.BarType.Full,AlphaTab.Rendering.Glyphs.TripletFeelGlyph.BarType.PartialRight]),this.RenderTriplet(r,t,a);break;case AlphaTab.Model.TripletFeel.Dotted8th:this.RenderBarNote(n,i,.4,a,[AlphaTab.Rendering.Glyphs.TripletFeelGlyph.BarType.Full]),this.RenderBarNote(r,i,.4,a,[AlphaTab.Rendering.Glyphs.TripletFeelGlyph.BarType.Full,AlphaTab.Rendering.Glyphs.TripletFeelGlyph.BarType.PartialRight]),a.FillCircle(r+9*this.get_Scale(),i,this.get_Scale());break;case AlphaTab.Model.TripletFeel.Dotted16th:this.RenderBarNote(n,i,.4,a,[AlphaTab.Rendering.Glyphs.TripletFeelGlyph.BarType.Full,AlphaTab.Rendering.Glyphs.TripletFeelGlyph.BarType.Full]),this.RenderBarNote(r,i,.4,a,[AlphaTab.Rendering.Glyphs.TripletFeelGlyph.BarType.Full,AlphaTab.Rendering.Glyphs.TripletFeelGlyph.BarType.Full,AlphaTab.Rendering.Glyphs.TripletFeelGlyph.BarType.PartialRight]),a.FillCircle(r+9*this.get_Scale(),i,this.get_Scale());break;case AlphaTab.Model.TripletFeel.Scottish8th:this.RenderBarNote(n,i,.4,a,[AlphaTab.Rendering.Glyphs.TripletFeelGlyph.BarType.Full]),this.RenderBarNote(r,i,.4,a,[AlphaTab.Rendering.Glyphs.TripletFeelGlyph.BarType.Full,AlphaTab.Rendering.Glyphs.TripletFeelGlyph.BarType.PartialLeft]),a.FillCircle(r+12*this.get_Scale()+8*this.get_Scale(),i,this.get_Scale());break;case AlphaTab.Model.TripletFeel.Scottish16th:this.RenderBarNote(n,i,.4,a,[AlphaTab.Rendering.Glyphs.TripletFeelGlyph.BarType.Full,AlphaTab.Rendering.Glyphs.TripletFeelGlyph.BarType.Full]),this.RenderBarNote(r,i,.4,a,[AlphaTab.Rendering.Glyphs.TripletFeelGlyph.BarType.Full,AlphaTab.Rendering.Glyphs.TripletFeelGlyph.BarType.Full,AlphaTab.Rendering.Glyphs.TripletFeelGlyph.BarType.PartialLeft]),a.FillCircle(r+12*this.get_Scale()+8*this.get_Scale(),i,this.get_Scale())}a.FillText("=",e+30*this.get_Scale(),t+5*this.get_Scale()),a.FillText(")",e+65*this.get_Scale(),t+.3*this.Height)},RenderBarNote:function(e,t,a,i,n){i.FillMusicFontSymbol(e,t,a,AlphaTab.Rendering.Glyphs.MusicFontSymbol.Tempo);for(var r=6*this.get_Scale(),l=0;l<n.length;l++)switch(n[l]){case AlphaTab.Rendering.Glyphs.TripletFeelGlyph.BarType.Full:i.FillRect(e+4*this.get_Scale(),t-12*this.get_Scale()+3*this.get_Scale()*l,12*this.get_Scale(),2*this.get_Scale());break;case AlphaTab.Rendering.Glyphs.TripletFeelGlyph.BarType.PartialLeft:i.FillRect(e+4*this.get_Scale(),t-12*this.get_Scale()+3*this.get_Scale()*l,r,2*this.get_Scale());break;case AlphaTab.Rendering.Glyphs.TripletFeelGlyph.BarType.PartialRight:i.FillRect(e+4*this.get_Scale()+r,t-12*this.get_Scale()+3*this.get_Scale()*l,r,2*this.get_Scale())}i.FillMusicFontSymbol(e+12*this.get_Scale(),t,a,AlphaTab.Rendering.Glyphs.MusicFontSymbol.Tempo)},RenderTriplet:function(e,t,a){t+=2*this.get_Scale();var i=this.Renderer.get_Resources().EffectFont;a.set_Font(new AlphaTab.Platform.Model.Font(i.Family,.8*i.Size,i.Style));var n=e+12*this.get_Scale()+3*this.get_Scale();a.BeginPath(),a.MoveTo(e,t+3*this.get_Scale()),a.LineTo(e,t),a.LineTo(e+5*this.get_Scale(),t),a.MoveTo(n+5*this.get_Scale(),t+3*this.get_Scale()),a.LineTo(n+5*this.get_Scale(),t),a.LineTo(n,t),a.Stroke(),a.FillText("3",e+7*this.get_Scale(),t-10*this.get_Scale()),a.set_Font(i)}},$StaticConstructor(function(){AlphaTab.Rendering.Glyphs.TripletFeelGlyph.NoteScale=.4,AlphaTab.Rendering.Glyphs.TripletFeelGlyph.NoteHeight=12,AlphaTab.Rendering.Glyphs.TripletFeelGlyph.NoteSeparation=12,AlphaTab.Rendering.Glyphs.TripletFeelGlyph.BarHeight=2,AlphaTab.Rendering.Glyphs.TripletFeelGlyph.BarSeparation=3}),$Inherit(AlphaTab.Rendering.Glyphs.TripletFeelGlyph,AlphaTab.Rendering.Glyphs.EffectGlyph),AlphaTab.Rendering.Glyphs.TuningGlyph=function(e,t,a,i,n){this._scale=0,this._resources=null,this.Height=0,AlphaTab.Rendering.Glyphs.GlyphGroup.call(this,e,t),this._scale=a,this._resources=i,this.CreateGlyphs(n)},AlphaTab.Rendering.Glyphs.TuningGlyph.prototype={CreateGlyphs:function(e){if(this.AddGlyph(new AlphaTab.Rendering.Glyphs.TextGlyph(0,0,e.Name,this._resources.EffectFont,AlphaTab.Platform.Model.TextAlign.Left)),this.Height+=15*this._scale,!e.IsStandard){for(var t=0|Math.ceil(e.Tunings.length/2),a=0,i=this.Height,n=0,r=e.Tunings.length;n<r;n++){var l="("+(n+1)+") = "+AlphaTab.Model.Tuning.GetTextForTuning(e.Tunings[n],!1);this.AddGlyph(new AlphaTab.Rendering.Glyphs.TextGlyph(a,i,l,this._resources.EffectFont,AlphaTab.Platform.Model.TextAlign.Left)),i+=this.Height,n==t-1&&(i=this.Height,a+=43*this._scale)}this.Height+=t*(15*this._scale)}}},$Inherit(AlphaTab.Rendering.Glyphs.TuningGlyph,AlphaTab.Rendering.Glyphs.GlyphGroup),AlphaTab.Rendering.Glyphs.VibratoGlyph=function(e,t,a){this._scale=0,AlphaTab.Rendering.Glyphs.GroupedEffectGlyph.call(this,AlphaTab.Rendering.BeatXPosition.EndBeat),this._scale=a,this.X=e,this.Y=t},AlphaTab.Rendering.Glyphs.VibratoGlyph.prototype={DoLayout:function(){AlphaTab.Rendering.Glyphs.Glyph.prototype.DoLayout.call(this),this.Height=10*this.get_Scale()*this._scale},PaintGrouped:function(e,t,a,i){for(var n=a-(e+this.X),r=9*this.get_Scale()*this._scale,l=0|Math.max(1,n/r),s=this.Height,o=0,h=0;h<l;h++)i.FillMusicFontSymbol(e+this.X+o,t+this.Y+s,this._scale,AlphaTab.Rendering.Glyphs.MusicFontSymbol.WaveHorizontal),o+=r}},$Inherit(AlphaTab.Rendering.Glyphs.VibratoGlyph,AlphaTab.Rendering.Glyphs.GroupedEffectGlyph),AlphaTab.Rendering.Glyphs.VoiceContainerGlyph=function(e,t,a){this.BeatGlyphs=null,this.Voice=null,this.MinWidth=0,AlphaTab.Rendering.Glyphs.GlyphGroup.call(this,e,t),this.Voice=a,this.BeatGlyphs=[]},AlphaTab.Rendering.Glyphs.VoiceContainerGlyph.prototype={ScaleToWidth:function(e){var t=this.Renderer.LayoutingInfo.SpaceToForce(e);this.ScaleToForce(t)},ScaleToForce:function(e){this.Width=this.Renderer.LayoutingInfo.CalculateVoiceWidth(e);for(var t=this.Renderer.LayoutingInfo.BuildOnTimePositions(e),a=this.BeatGlyphs,i=0,n=a.length;i<n;i++){var r=a[i],l=r.Beat.get_AbsoluteStart();if(r.X=t[l]-r.OnTimeX,i>0){s=r.X-a[i-1].X;a[i-1].ScaleToWidth(s)}if(i==n-1){var s=this.Width-a[a.length-1].X;r.ScaleToWidth(s)}}},RegisterLayoutingInfo:function(e){e.UpdateVoiceSize(this.Width);for(var t=this.BeatGlyphs,a=0,i=t.length,n=t[a];a<i;a++,n=t[a])n.RegisterLayoutingInfo(e)},ApplyLayoutingInfo:function(e){for(var t=this.BeatGlyphs,a=0,i=t.length,n=t[a];a<i;a++,n=t[a])n.ApplyLayoutingInfo(e);this.ScaleToForce(Math.max(this.Renderer.get_Settings().StretchForce,e.MinStretchForce))},AddGlyph:function(e){e.X=0==this.BeatGlyphs.length?0:this.BeatGlyphs[this.BeatGlyphs.length-1].X+this.BeatGlyphs[this.BeatGlyphs.length-1].Width,e.Renderer=this.Renderer,e.DoLayout(),this.BeatGlyphs.push(e),this.Width=e.X+e.Width},DoLayout:function(){this.MinWidth=this.Width},Paint:function(e,t,a){a.set_Color(0==this.Voice.Index?this.Renderer.ScoreRenderer.RenderingResources.MainGlyphColor:this.Renderer.ScoreRenderer.RenderingResources.SecondaryGlyphColor);for(var i=0,n=this.BeatGlyphs.length;i<n;i++)this.BeatGlyphs[i].Paint(e+this.X,t+this.Y,a)}},$StaticConstructor(function(){AlphaTab.Rendering.Glyphs.VoiceContainerGlyph.KeySizeBeat="Beat"}),$Inherit(AlphaTab.Rendering.Glyphs.VoiceContainerGlyph,AlphaTab.Rendering.Glyphs.GlyphGroup),AlphaTab.Rendering.Glyphs.WhammyBarGlyph=function(e,t){this._beat=null,this._parent=null,AlphaTab.Rendering.Glyphs.Glyph.call(this,0,0),this._beat=e,this._parent=t},AlphaTab.Rendering.Glyphs.WhammyBarGlyph.prototype={DoLayout:function(){AlphaTab.Rendering.Glyphs.Glyph.prototype.DoLayout.call(this);var e=0,t=0,a=60*this.get_Scale();if(this._beat.WhammyBarPoints.length>=2)for(var i=a/24,n=0,r=this._beat.WhammyBarPoints.length;n<r;n++){var l=0-i*this._beat.WhammyBarPoints[n].Value;l>t&&(t=l),l<e&&(e=l)}var s=this.Renderer,o=this.Renderer.Bar.Staff.Track,h=e+s.GetTabY(0,-2),p=t-s.GetTabY(o.Tuning.length,-2);h<0&&s.RegisterOverflowTop(Math.abs(h)),p>0&&s.RegisterOverflowBottom(Math.abs(p))},Paint:function(e,t,a){var i=this.Renderer,n=this.Renderer.get_Resources(),r=e+this.X+this._parent.OnNotes.Width/2,l=null==this._beat.NextBeat||this._beat.Voice!=this._beat.NextBeat.Voice?e+this.X+this._parent.Width:e+i.GetBeatX(this._beat.NextBeat,AlphaTab.Rendering.BeatXPosition.PreNotes),s=t,o=60*this.get_Scale(),h=a.get_TextAlign();if(a.set_TextAlign(AlphaTab.Platform.Model.TextAlign.Center),this._beat.WhammyBarPoints.length>=2){var p=(l-r)/60,d=o/24;a.BeginPath();for(var u=0,c=this._beat.WhammyBarPoints.length-1;u<c;u++){var T=this._beat.WhammyBarPoints[u],g=this._beat.WhammyBarPoints[u+1];if(T.Value!=g.Value||u!=this._beat.WhammyBarPoints.length-2){var f=r+p*T.Offset,b=s-d*T.Value,A=r+p*g.Offset,y=s-d*g.Value;if(a.MoveTo(f,b),a.LineTo(A,y),0!=g.Value){var m=g.Value,S="";if(m>=4||m<=-4){var B=m/4|0;S+=B,m-=4*B}if(m>0&&(S+=AlphaTab.Rendering.Glyphs.BendGlyph.GetFractionSign(m)),""!=S){a.set_Font(n.GraceFont);var _=y;y<b?_-=a.get_Font().Size:_+=3*this.get_Scale();var R=A;a.FillText(S,R,_)}}}}a.Stroke()}a.set_TextAlign(h)}},$StaticConstructor(function(){AlphaTab.Rendering.Glyphs.WhammyBarGlyph.WhammyMaxOffset=60}),$Inherit(AlphaTab.Rendering.Glyphs.WhammyBarGlyph,AlphaTab.Rendering.Glyphs.Glyph),AlphaTab.Rendering.RenderFinishedEventArgs=function(){this.Width=0,this.Height=0,this.TotalWidth=0,this.TotalHeight=0,this.FirstMasterBarIndex=0,this.LastMasterBarIndex=0,this.RenderResult=null},AlphaTab.Rendering.Layout=AlphaTab.Rendering.Layout||{},AlphaTab.Rendering.Layout.HeaderFooterElements={None:0,Title:1,SubTitle:2,Artist:4,Album:8,Words:16,Music:32,WordsAndMusic:64,Copyright:128,PageNumber:256,All:511},AlphaTab.Rendering.Layout.HorizontalScreenLayoutPartialInfo=function(){this.Width=0,this.MasterBars=null,this.MasterBars=[]},AlphaTab.Rendering.Layout.ScoreLayout=function(e){this._barRendererLookup=null,this.ScoreInfoGlyphs=null,this.TuningGlyph=null,this.Renderer=null,this.Width=0,this.Height=0,this.Renderer=e,this._barRendererLookup={}},AlphaTab.Rendering.Layout.ScoreLayout.prototype={LayoutAndRender:function(){this.CreateScoreInfoGlyphs(),this.DoLayoutAndRender()},CreateScoreInfoGlyphs:function(){AlphaTab.Util.Logger.Info("ScoreLayout","Creating score info glyphs",null);var e=this.Renderer.Settings.Layout.Get("hideInfo",!1)?AlphaTab.Rendering.Layout.HeaderFooterElements.None:AlphaTab.Rendering.Layout.HeaderFooterElements.All,t=this.Renderer.Score,a=this.Renderer.RenderingResources;if(this.ScoreInfoGlyphs={},null!=t.Title&&0!=t.Title.length&&(e&AlphaTab.Rendering.Layout.HeaderFooterElements.Title)!=AlphaTab.Rendering.Layout.HeaderFooterElements.None&&(this.ScoreInfoGlyphs[AlphaTab.Rendering.Layout.HeaderFooterElements.Title]=new AlphaTab.Rendering.Glyphs.TextGlyph(0,0,t.Title,a.TitleFont,AlphaTab.Platform.Model.TextAlign.Center)),null!=t.SubTitle&&0!=t.SubTitle.length&&(e&AlphaTab.Rendering.Layout.HeaderFooterElements.SubTitle)!=AlphaTab.Rendering.Layout.HeaderFooterElements.None&&(this.ScoreInfoGlyphs[AlphaTab.Rendering.Layout.HeaderFooterElements.SubTitle]=new AlphaTab.Rendering.Glyphs.TextGlyph(0,0,t.SubTitle,a.SubTitleFont,AlphaTab.Platform.Model.TextAlign.Center)),null!=t.Artist&&0!=t.Artist.length&&(e&AlphaTab.Rendering.Layout.HeaderFooterElements.Artist)!=AlphaTab.Rendering.Layout.HeaderFooterElements.None&&(this.ScoreInfoGlyphs[AlphaTab.Rendering.Layout.HeaderFooterElements.Artist]=new AlphaTab.Rendering.Glyphs.TextGlyph(0,0,t.Artist,a.SubTitleFont,AlphaTab.Platform.Model.TextAlign.Center)),null!=t.Album&&0!=t.Album.length&&(e&AlphaTab.Rendering.Layout.HeaderFooterElements.Album)!=AlphaTab.Rendering.Layout.HeaderFooterElements.None&&(this.ScoreInfoGlyphs[AlphaTab.Rendering.Layout.HeaderFooterElements.Album]=new AlphaTab.Rendering.Glyphs.TextGlyph(0,0,t.Album,a.SubTitleFont,AlphaTab.Platform.Model.TextAlign.Center)),null!=t.Music&&0!=t.Music.length&&t.Music==t.Words&&(e&AlphaTab.Rendering.Layout.HeaderFooterElements.WordsAndMusic)!=AlphaTab.Rendering.Layout.HeaderFooterElements.None?this.ScoreInfoGlyphs[AlphaTab.Rendering.Layout.HeaderFooterElements.WordsAndMusic]=new AlphaTab.Rendering.Glyphs.TextGlyph(0,0,"Music and Words by "+t.Words,a.WordsFont,AlphaTab.Platform.Model.TextAlign.Center):(null!=t.Music&&0!=t.Music.length&&(e&AlphaTab.Rendering.Layout.HeaderFooterElements.Music)!=AlphaTab.Rendering.Layout.HeaderFooterElements.None&&(this.ScoreInfoGlyphs[AlphaTab.Rendering.Layout.HeaderFooterElements.Music]=new AlphaTab.Rendering.Glyphs.TextGlyph(0,0,"Music by "+t.Music,a.WordsFont,AlphaTab.Platform.Model.TextAlign.Right)),null!=t.Words&&0!=t.Words.length&&(e&AlphaTab.Rendering.Layout.HeaderFooterElements.Words)!=AlphaTab.Rendering.Layout.HeaderFooterElements.None&&(this.ScoreInfoGlyphs[AlphaTab.Rendering.Layout.HeaderFooterElements.Words]=new AlphaTab.Rendering.Glyphs.TextGlyph(0,0,"Words by "+t.Music,a.WordsFont,AlphaTab.Platform.Model.TextAlign.Left))),1==this.Renderer.Tracks.length&&!this.Renderer.Tracks[0].IsPercussion&&!this.Renderer.Settings.Layout.Get("hideTuning",!1)){var i=AlphaTab.Model.Tuning.FindTuning(this.Renderer.Tracks[0].Tuning);null!=i&&(this.TuningGlyph=new AlphaTab.Rendering.Glyphs.TuningGlyph(0,0,this.get_Scale(),this.Renderer.RenderingResources,i))}},get_Scale:function(){return this.Renderer.Settings.Scale},CreateEmptyStaveGroup:function(){var e=new AlphaTab.Rendering.Staves.StaveGroup;e.Layout=this;for(var t=0;t<this.Renderer.Tracks.length;t++){var a,i=this.Renderer.Tracks[t];a=i.IsPercussion?"score":i.get_IsStringed()?this.Renderer.Settings.Staves.Id:"score";for(var n=AlphaTab.Environment.StaveProfiles.hasOwnProperty(a)?AlphaTab.Environment.StaveProfiles[a]:AlphaTab.Environment.StaveProfiles.default,r=0;r<i.Staves.length;r++)for(var l=0;l<n.length;l++){var s=n[l],o=i.Staves[r];s.CanCreate(i,o)&&e.AddStaff(i,new AlphaTab.Rendering.Staves.Staff(t,o,s))}}return e},RegisterBarRenderer:function(e,t){this._barRendererLookup.hasOwnProperty(e)||(this._barRendererLookup[e]={}),this._barRendererLookup[e][t.Bar.Id]=t},UnregisterBarRenderer:function(e,t){this._barRendererLookup.hasOwnProperty(e)&&delete this._barRendererLookup[e][t.Bar.Id]},GetRendererForBar:function(e,t){var a=t.Id;return this._barRendererLookup.hasOwnProperty(e)&&this._barRendererLookup[e].hasOwnProperty(a)?this._barRendererLookup[e][a]:null},RenderAnnotation:function(){var e=this.Renderer.Canvas,t=this.Renderer.RenderingResources,a=2*t.CopyrightFont.Size;this.Height+=a;var i=this.Width/2;e.BeginRender(this.Width,a),e.set_Color(t.MainGlyphColor),e.set_Font(t.CopyrightFont),e.set_TextAlign(AlphaTab.Platform.Model.TextAlign.Center),e.FillText("Rendered using alphaTab (http://www.alphaTab.net)",i,t.CopyrightFont.Size);var n=e.EndRender();this.Renderer.OnPartialRenderFinished(function(){var e=new AlphaTab.Rendering.RenderFinishedEventArgs;return e.Width=this.Width,e.Height=a,e.RenderResult=n,e.TotalWidth=this.Width,e.TotalHeight=this.Height,e.FirstMasterBarIndex=-1,e.LastMasterBarIndex=-1,e}.call(this))}},AlphaTab.Rendering.Layout.HorizontalScreenLayout=function(e){this._group=null,AlphaTab.Rendering.Layout.ScoreLayout.call(this,e)},AlphaTab.Rendering.Layout.HorizontalScreenLayout.prototype={get_Name:function(){return"HorizontalScreen"},get_SupportsResize:function(){return!1},Resize:function(){},DoLayoutAndRender:function(){var e=this.Renderer.Score,t=this.Renderer.Canvas,a=this.Renderer.Settings.Layout.Get("start",1);a--;var i=a=Math.min(e.MasterBars.length-1,Math.max(0,a)),n=this.Renderer.Settings.Layout.Get("count",e.MasterBars.length);n<0&&(n=e.MasterBars.length),n=a+n-1,n=Math.min(e.MasterBars.length-1,Math.max(0,n)),this._group=this.CreateEmptyStaveGroup(),this._group.IsLast=!0,this._group.X=AlphaTab.Rendering.Layout.HorizontalScreenLayout.PagePadding[0],this._group.Y=AlphaTab.Rendering.Layout.HorizontalScreenLayout.PagePadding[1];for(var r=this.Renderer.Settings.Layout.Get("countPerPartial",10),l=[],s=new AlphaTab.Rendering.Layout.HorizontalScreenLayoutPartialInfo;i<=n;){u=this._group.AddBars(this.Renderer.Tracks,i);if(0==s.MasterBars.length&&u.IsLinkedToPrevious&&l.length>0){var o=l[l.length-1];o.MasterBars.push(e.MasterBars[i]),o.Width+=u.Width}else s.MasterBars.push(e.MasterBars[i]),s.Width+=u.Width,s.MasterBars.length>=r&&(0==l.length&&(s.Width+=this._group.X+this._group.AccoladeSpacing),l.push(s),AlphaTab.Util.Logger.Info(this.get_Name(),"Finished partial from bar "+s.MasterBars[0].Index+" to "+s.MasterBars[s.MasterBars.length-1].Index,null),s=new AlphaTab.Rendering.Layout.HorizontalScreenLayoutPartialInfo);i++}s.MasterBars.length>0&&(0==l.length&&(s.Width+=this._group.X+this._group.AccoladeSpacing),l.push(s),AlphaTab.Util.Logger.Info(this.get_Name(),"Finished partial from bar "+s.MasterBars[0].Index+" to "+s.MasterBars[s.MasterBars.length-1].Index,null)),this._group.FinalizeGroup(),this.Height=this._group.Y+this._group.get_Height()+AlphaTab.Rendering.Layout.HorizontalScreenLayout.PagePadding[3],this.Width=this._group.X+this._group.Width+AlphaTab.Rendering.Layout.HorizontalScreenLayout.PagePadding[2],i=0;for(var h=0;h<l.length;h++){var p=l[h];t.BeginRender(p.Width,this.Height),t.set_Color(this.Renderer.RenderingResources.MainGlyphColor),t.set_TextAlign(AlphaTab.Platform.Model.TextAlign.Left);var d=this._group.GetBarX(p.MasterBars[0].Index)+this._group.AccoladeSpacing;0==h&&(d-=this._group.X+this._group.AccoladeSpacing),AlphaTab.Util.Logger.Info(this.get_Name(),"Rendering partial from bar "+p.MasterBars[0].Index+" to "+p.MasterBars[p.MasterBars.length-1].Index,null),this._group.PaintPartial(-d,this._group.Y,this.Renderer.Canvas,i,p.MasterBars.length);var u=t.EndRender();this.Renderer.OnPartialRenderFinished(function(){var e=new AlphaTab.Rendering.RenderFinishedEventArgs;return e.TotalWidth=this.Width,e.TotalHeight=this.Height,e.Width=p.Width,e.Height=this.Height,e.RenderResult=u,e.FirstMasterBarIndex=p.MasterBars[0].Index,e.LastMasterBarIndex=p.MasterBars[p.MasterBars.length-1].Index,e}.call(this)),i+=p.MasterBars.length}}},$StaticConstructor(function(){AlphaTab.Rendering.Layout.HorizontalScreenLayout.PagePadding=new Float32Array([20,20,20,20]),AlphaTab.Rendering.Layout.HorizontalScreenLayout.GroupSpacing=20}),$Inherit(AlphaTab.Rendering.Layout.HorizontalScreenLayout,AlphaTab.Rendering.Layout.ScoreLayout),AlphaTab.Rendering.Layout.PageViewLayout=function(e){this._groups=null,this._allMasterBarRenderers=null,this._barsFromPreviousGroup=null,AlphaTab.Rendering.Layout.ScoreLayout.call(this,e)},AlphaTab.Rendering.Layout.PageViewLayout.prototype={get_Name:function(){return"PageView"},DoLayoutAndRender:function(){var e=AlphaTab.Rendering.Layout.PageViewLayout.PagePadding[0],t=AlphaTab.Rendering.Layout.PageViewLayout.PagePadding[1];this.Width=this.Renderer.Settings.Width,this._allMasterBarRenderers=[],t=this.LayoutAndRenderScoreInfo(e,t,-1),t=this.LayoutAndRenderScore(e,t),this.Height=t+AlphaTab.Rendering.Layout.PageViewLayout.PagePadding[3]},get_SupportsResize:function(){return!0},Resize:function(){var e=AlphaTab.Rendering.Layout.PageViewLayout.PagePadding[0],t=AlphaTab.Rendering.Layout.PageViewLayout.PagePadding[1];this.Width=this.Renderer.Settings.Width;var a=this.Height;t=this.LayoutAndRenderScoreInfo(e,t,a),t=this.ResizeAndRenderScore(e,t,a),this.Height=t+AlphaTab.Rendering.Layout.PageViewLayout.PagePadding[3]},LayoutAndRenderScoreInfo:function(e,t,a){AlphaTab.Util.Logger.Info(this.get_Name(),"Layouting score info",null);for(var i=this.get_Scale(),n=this.Renderer.RenderingResources,r=[AlphaTab.Rendering.Layout.HeaderFooterElements.Title,AlphaTab.Rendering.Layout.HeaderFooterElements.SubTitle,AlphaTab.Rendering.Layout.HeaderFooterElements.Artist,AlphaTab.Rendering.Layout.HeaderFooterElements.Album,AlphaTab.Rendering.Layout.HeaderFooterElements.WordsAndMusic],l=0;l<r.length;l++)this.ScoreInfoGlyphs.hasOwnProperty(r[l])&&((h=this.ScoreInfoGlyphs[r[l]]).X=this.Width/2,h.Y=t,h.TextAlign=AlphaTab.Platform.Model.TextAlign.Center,t+=h.Font.Size);var s=!1,o=0;if(this.ScoreInfoGlyphs.hasOwnProperty(AlphaTab.Rendering.Layout.HeaderFooterElements.Music)&&((h=this.ScoreInfoGlyphs[AlphaTab.Rendering.Layout.HeaderFooterElements.Music]).X=this.Width-AlphaTab.Rendering.Layout.PageViewLayout.PagePadding[2],h.Y=t,h.TextAlign=AlphaTab.Platform.Model.TextAlign.Right,s=!0,o=h.Font.Size),this.ScoreInfoGlyphs.hasOwnProperty(AlphaTab.Rendering.Layout.HeaderFooterElements.Words)){var h=this.ScoreInfoGlyphs[AlphaTab.Rendering.Layout.HeaderFooterElements.Words];h.X=e,h.Y=t,h.TextAlign=AlphaTab.Platform.Model.TextAlign.Left,s=!0,o=h.Font.Size}s&&(t+=o),null!=this.TuningGlyph&&(t+=20*i,this.TuningGlyph.X=e,this.TuningGlyph.Y=t,t+=this.TuningGlyph.Height),t+=20*i;var p=this.Renderer.Canvas;p.BeginRender(this.Width,t),p.set_Color(n.ScoreInfoColor),p.set_TextAlign(AlphaTab.Platform.Model.TextAlign.Center);for(var d in this.ScoreInfoGlyphs)this.ScoreInfoGlyphs[d].Paint(0,0,p);null!=this.TuningGlyph&&this.TuningGlyph.Paint(0,0,p);var u=p.EndRender();return this.Renderer.OnPartialRenderFinished(function(){var e=new AlphaTab.Rendering.RenderFinishedEventArgs;return e.Width=this.Width,e.Height=t,e.RenderResult=u,e.TotalWidth=this.Width,e.TotalHeight=a<0?t:a,e.FirstMasterBarIndex=-1,e.LastMasterBarIndex=-1,e}.call(this)),t},ResizeAndRenderScore:function(e,t,a){var i=this.Renderer.Canvas;if(-1!=this.Renderer.Settings.Layout.Get("barsPerRow",-1))for(var n=0;n<this._groups.length;n++){var r=this._groups[n];this.FitGroup(r),r.FinalizeGroup(),t+=this.PaintGroup(r,a,i)}else{this._groups=[];var l=0,s=this.get_MaxWidth();for((r=this.CreateEmptyStaveGroup()).Index=this._groups.length,r.X=e,r.Y=t;l<this._allMasterBarRenderers.length;){var o=this._allMasterBarRenderers[l];r.Width+o.Width<=s||0==r.MasterBarsRenderers.length?(r.AddMasterBarRenderers(this.Renderer.Tracks,o),l++):(r.IsFull=!0,r.IsLast=!1,this._groups.push(r),this.FitGroup(r),r.FinalizeGroup(),t+=this.PaintGroup(r,a,i),(r=this.CreateEmptyStaveGroup()).Index=this._groups.length,r.X=e,r.Y=t)}this.FitGroup(r),r.FinalizeGroup(),t+=this.PaintGroup(r,a,i)}return t},LayoutAndRenderScore:function(e,t){var a=this.Renderer.Score,i=this.Renderer.Canvas,n=this.Renderer.Settings.Layout.Get("start",1);n--;var r=n=Math.min(a.MasterBars.length-1,Math.max(0,n)),l=this.Renderer.Settings.Layout.Get("count",a.MasterBars.length);for(l<0&&(l=a.MasterBars.length),l=n+l-1,l=Math.min(a.MasterBars.length-1,Math.max(0,l)),this._groups=[];r<=l;){var s=this.CreateStaveGroup(r,l);this._groups.push(s),s.X=e,s.Y=t,r=s.get_LastBarIndex()+1,this.FitGroup(s),s.FinalizeGroup(),AlphaTab.Util.Logger.Info(this.get_Name(),"Rendering partial from bar "+s.get_FirstBarIndex()+" to "+s.get_LastBarIndex(),null),t+=this.PaintGroup(s,t,i)}return t},PaintGroup:function(e,t,a){var i=e.get_Height()+20*this.get_Scale();a.BeginRender(this.Width,i),this.Renderer.Canvas.set_Color(this.Renderer.RenderingResources.MainGlyphColor),this.Renderer.Canvas.set_TextAlign(AlphaTab.Platform.Model.TextAlign.Left),e.Paint(0,-e.Y,a),t+=i;var n=a.EndRender(),r=new AlphaTab.Rendering.RenderFinishedEventArgs;return r.TotalWidth=this.Width,r.TotalHeight=t,r.Width=this.Width,r.Height=i,r.RenderResult=n,r.FirstMasterBarIndex=e.get_FirstBarIndex(),r.LastMasterBarIndex=e.get_LastBarIndex(),this.Renderer.OnPartialRenderFinished(r),i},FitGroup:function(e){(e.IsFull||e.Width>this.get_MaxWidth())&&e.ScaleToWidth(this.get_MaxWidth()),this.Width=Math.max(this.Width,e.Width)},CreateStaveGroup:function(e,t){var a=this.CreateEmptyStaveGroup();a.Index=this._groups.length;for(var i=this.Renderer.Settings.Layout.Get("barsPerRow",-1),n=this.get_MaxWidth(),r=t+1,l=e;l<r;l++){var s;null!=this._barsFromPreviousGroup&&this._barsFromPreviousGroup.MasterBar.Index==l?s=a.AddMasterBarRenderers(this.Renderer.Tracks,this._barsFromPreviousGroup):(s=a.AddBars(this.Renderer.Tracks,l),this._allMasterBarRenderers.push(s)),this._barsFromPreviousGroup=null;var o=!1;if(-1==i&&a.Width>=n&&0!=a.MasterBarsRenderers.length?o=!0:a.MasterBarsRenderers.length==i+1&&(o=!0),o)return a.RevertLastBar(),a.IsFull=!0,a.IsLast=!1,this._barsFromPreviousGroup=s,a;a.X=0}return a.IsLast=t==a.get_LastBarIndex(),a},get_MaxWidth:function(){return this.Renderer.Settings.Width-AlphaTab.Rendering.Layout.PageViewLayout.PagePadding[0]-AlphaTab.Rendering.Layout.PageViewLayout.PagePadding[2]}},$StaticConstructor(function(){AlphaTab.Rendering.Layout.PageViewLayout.PagePadding=new Float32Array([40,40,40,40]),AlphaTab.Rendering.Layout.PageViewLayout.GroupSpacing=20}),$Inherit(AlphaTab.Rendering.Layout.PageViewLayout,AlphaTab.Rendering.Layout.ScoreLayout),AlphaTab.Rendering.RenderingResources=function(e){this.CopyrightFont=null,this.TitleFont=null,this.SubTitleFont=null,this.WordsFont=null,this.EffectFont=null,this.TablatureFont=null,this.GraceFont=null,this.StaveLineColor=null,this.BarSeperatorColor=null,this.BarNumberFont=null,this.BarNumberColor=null,this.MarkerFont=null,this.TabClefFont=null,this.MainGlyphColor=null,this.SecondaryGlyphColor=null,this.Scale=0,this.ScoreInfoColor=null,this.Init(e)},AlphaTab.Rendering.RenderingResources.prototype={Init:function(e){this.Scale=e;this.EffectFont=new AlphaTab.Platform.Model.Font("Georgia",12*e,AlphaTab.Platform.Model.FontStyle.Italic),this.CopyrightFont=new AlphaTab.Platform.Model.Font("Arial",12*e,AlphaTab.Platform.Model.FontStyle.Bold),this.TitleFont=new AlphaTab.Platform.Model.Font("Georgia",32*e,AlphaTab.Platform.Model.FontStyle.Plain),this.SubTitleFont=new AlphaTab.Platform.Model.Font("Georgia",20*e,AlphaTab.Platform.Model.FontStyle.Plain),this.WordsFont=new AlphaTab.Platform.Model.Font("Georgia",15*e,AlphaTab.Platform.Model.FontStyle.Plain),this.TablatureFont=new AlphaTab.Platform.Model.Font("Arial",13*e,AlphaTab.Platform.Model.FontStyle.Plain),this.GraceFont=new AlphaTab.Platform.Model.Font("Arial",11*e,AlphaTab.Platform.Model.FontStyle.Plain),this.StaveLineColor=new AlphaTab.Platform.Model.Color(0,0,0,255),this.BarSeperatorColor=new AlphaTab.Platform.Model.Color(34,34,17,255),this.BarNumberFont=new AlphaTab.Platform.Model.Font("Arial",11*e,AlphaTab.Platform.Model.FontStyle.Plain),this.BarNumberColor=new AlphaTab.Platform.Model.Color(200,0,0,255),this.MarkerFont=new AlphaTab.Platform.Model.Font("Georgia",14*e,AlphaTab.Platform.Model.FontStyle.Bold),this.TabClefFont=new AlphaTab.Platform.Model.Font("Arial",18*e,AlphaTab.Platform.Model.FontStyle.Bold),this.ScoreInfoColor=new AlphaTab.Platform.Model.Color(0,0,0,255),this.MainGlyphColor=new AlphaTab.Platform.Model.Color(0,0,0,255),this.SecondaryGlyphColor=new AlphaTab.Platform.Model.Color(0,0,0,100)}},AlphaTab.Rendering.ScoreBarRenderer=function(e,t){this._startSpacing=!1,this.AccidentalHelper=null,AlphaTab.Rendering.BarRendererBase.call(this,e,t),this.AccidentalHelper=new AlphaTab.Rendering.Utils.AccidentalHelper},AlphaTab.Rendering.ScoreBarRenderer.prototype={GetBeatDirection:function(e){var t=this.GetOnNotesGlyphForBeat(e);return null!=t?t.NoteHeads.get_Direction():AlphaTab.Rendering.Utils.BeamDirection.Up},GetNoteX:function(e,t){var a=this.GetOnNotesGlyphForBeat(e.Beat);if(null!=a){var i=a.Container.VoiceContainer.X+a.Container.X+a.X;return t&&(i+=a.Width),i}return 0},GetNoteY:function(e){var t=this.GetOnNotesGlyphForBeat(e.Beat);return null!=t?t.NoteHeads.GetNoteY(e):0},get_LineOffset:function(){return 9*this.get_Scale()},UpdateSizes:function(){var e=this.get_Resources(),t=e.TablatureFont.Size/2+.2*e.TablatureFont.Size;this.TopPadding=t,this.BottomPadding=t,this.Height=4*this.get_LineOffset()+this.TopPadding+this.BottomPadding,AlphaTab.Rendering.BarRendererBase.prototype.UpdateSizes.call(this)},DoLayout:function(){AlphaTab.Rendering.BarRendererBase.prototype.DoLayout.call(this);for(var e=this.GetScoreY(0,0),t=this.GetScoreY(8,0),a=0,i=this.Helpers.BeamHelpers.length;a<i;a++)for(var n=this.Helpers.BeamHelpers[a],r=0,l=n.length;r<l;r++){var s=n[r],o=this.GetScoreY(this.GetNoteLine(s.MaxNote),0);s.Direction==AlphaTab.Rendering.Utils.BeamDirection.Up&&(o-=this.GetStemSize(s),o-=s.FingeringCount*this.get_Resources().GraceFont.Size,s.HasTuplet&&(o-=2*this.get_Resources().EffectFont.Size)),s.HasTuplet&&(o-=1.5*this.get_Resources().EffectFont.Size),o<e&&this.RegisterOverflowTop(Math.abs(o));var h=this.GetScoreY(this.GetNoteLine(s.MinNote),0);s.Direction==AlphaTab.Rendering.Utils.BeamDirection.Down&&(h+=this.GetStemSize(s),h+=s.FingeringCount*this.get_Resources().GraceFont.Size),h>t&&this.RegisterOverflowBottom(Math.abs(h)-t)}},Paint:function(e,t,a){AlphaTab.Rendering.BarRendererBase.prototype.Paint.call(this,e,t,a),this.PaintBeams(e,t,a),this.PaintTuplets(e,t,a)},PaintTuplets:function(e,t,a){for(var i=0,n=this.Helpers.TupletHelpers.length;i<n;i++)for(var r=this.Helpers.TupletHelpers[i],l=0,s=r.length;l<s;l++){var o=r[l];this.PaintTupletHelper(e+this.get_BeatGlyphsStart(),t,a,o)}},PaintBeams:function(e,t,a){for(var i=0,n=this.Helpers.BeamHelpers.length;i<n;i++)for(var r=this.Helpers.BeamHelpers[i],l=0,s=r.length;l<s;l++){var o=r[l];this.PaintBeamHelper(e+this.get_BeatGlyphsStart(),t,a,o)}},PaintBeamHelper:function(e,t,a,i){a.set_Color(0==i.Voice.Index?this.get_Resources().MainGlyphColor:this.get_Resources().SecondaryGlyphColor),1==i.Beats.length?this.PaintFooter(e,t,a,i):this.PaintBar(e,t,a,i)},PaintTupletHelper:function(e,t,a,i){var n=this.get_Resources(),r=a.get_TextAlign();if(a.set_TextAlign(AlphaTab.Platform.Model.TextAlign.Center),1!=i.Beats.length&&i.get_IsFull()){var l=i.Beats[0],s=i.Beats[i.Beats.length-1],o=this.Helpers.BeamHelperLookup[i.VoiceIndex][l.Index],h=this.Helpers.BeamHelperLookup[i.VoiceIndex][s.Index];if(null!=o&&null!=h){var p=o.Direction,d=o.GetBeatLineX(l)+this.get_Scale(),u=h.GetBeatLineX(s)+this.get_Scale();a.set_Font(n.EffectFont);var c=i.Tuplet.toString(),T=a.MeasureText(c),g=3*this.get_Scale(),f=(d+u)/2,b=f-T/2-g,A=f+T/2+g,y=this.CalculateBeamYWithDirection(o,d,o.Direction),m=this.CalculateBeamYWithDirection(h,u,o.Direction),S=(m-y)/(u-d),B=y-S*d,_=S*b+B,R=S*f+B,G=S*A+B,M=10*this.get_Scale(),v=5*this.get_Scale();p==AlphaTab.Rendering.Utils.BeamDirection.Down&&(M*=-1,v*=-1),a.BeginPath(),a.MoveTo(e+this.X+d,t+this.Y+y-M|0),a.LineTo(e+this.X+d,t+this.Y+y-M-v|0),a.LineTo(e+this.X+b,t+this.Y+_-M-v|0),a.Stroke(),a.BeginPath(),a.MoveTo(e+this.X+A,t+this.Y+G-M-v|0),a.LineTo(e+this.X+u,t+this.Y+m-M-v|0),a.LineTo(e+this.X+u,t+this.Y+m-M|0),a.Stroke(),a.FillText(c,e+this.X+f,t+this.Y+R-M-v-n.EffectFont.Size)}}else for(var I=0,P=i.Beats.length;I<P;I++){var N=i.Beats[I],C=this.Helpers.BeamHelperLookup[i.VoiceIndex][N.Index];if(null!=C){var p=C.Direction,F=C.GetBeatLineX(N)+this.get_Scale(),w=t+this.Y+this.CalculateBeamY(C,F),M=p==AlphaTab.Rendering.Utils.BeamDirection.Up?1.8*n.EffectFont.Size:-3*this.get_Scale();a.set_Font(n.EffectFont),a.FillText(i.Tuplet.toString(),e+this.X+F,w-M)}}a.set_TextAlign(r)},GetStemSize:function(e){return 1==e.Beats.length?this.GetFooterStemSize(e.ShortestDuration):this.GetBarStemSize(e.ShortestDuration)},GetBarStemSize:function(e){var t;switch(e){case AlphaTab.Model.Duration.QuadrupleWhole:case AlphaTab.Model.Duration.Half:case AlphaTab.Model.Duration.Quarter:case AlphaTab.Model.Duration.Eighth:case AlphaTab.Model.Duration.Sixteenth:t=6;break;case AlphaTab.Model.Duration.ThirtySecond:case AlphaTab.Model.Duration.SixtyFourth:t=7;break;case AlphaTab.Model.Duration.OneHundredTwentyEighth:t=9;break;case AlphaTab.Model.Duration.TwoHundredFiftySixth:t=10;break;default:t=0}return this.GetScoreY(t,0)},GetFooterStemSize:function(e){var t;switch(e){case AlphaTab.Model.Duration.QuadrupleWhole:case AlphaTab.Model.Duration.Half:case AlphaTab.Model.Duration.Quarter:case AlphaTab.Model.Duration.Eighth:case AlphaTab.Model.Duration.Sixteenth:case AlphaTab.Model.Duration.ThirtySecond:case AlphaTab.Model.Duration.SixtyFourth:case AlphaTab.Model.Duration.OneHundredTwentyEighth:case AlphaTab.Model.Duration.TwoHundredFiftySixth:t=6;break;default:t=0}return this.GetScoreY(t,0)},GetYPositionForNote:function(e){return this.GetScoreY(this.GetNoteLine(e),0)},CalculateBeamY:function(e,t){var a=this.GetStemSize(e);return e.CalculateBeamY(a,this.get_Scale(),t,this.get_Scale(),this)},CalculateBeamYWithDirection:function(e,t,a){var i=this.GetStemSize(e);return e.CalculateBeamYWithDirection(i,this.get_Scale(),t,this.get_Scale(),this,a)},PaintBar:function(e,t,a,i){for(var n=0,r=i.Beats.length;n<r;n++){var l=i.Beats[n],s=l.GraceType!=AlphaTab.Model.GraceType.None?.75:1,o=i.GetBeatLineX(l)+this.get_Scale(),h=i.Direction,p=t+this.Y;p+=h==AlphaTab.Rendering.Utils.BeamDirection.Up?this.GetScoreY(this.GetNoteLine(l.get_MinNote()),0):this.GetScoreY(this.GetNoteLine(l.get_MaxNote()),0);var d=t+this.Y;d+=s*this.CalculateBeamY(i,o),a.set_LineWidth(1.5*this.get_Scale()),a.BeginPath(),a.MoveTo(e+this.X+o,p),a.LineTo(e+this.X+o,d),a.Stroke(),a.set_LineWidth(this.get_Scale());var u=d;h==AlphaTab.Rendering.Utils.BeamDirection.Down?u+=2*a.get_Font().Size:0!=n&&(u-=1.5*a.get_Font().Size),this.PaintFingering(a,l,e+this.X+o,h,u);var c=6*this.get_Scale()*s,T=7*this.get_Scale()*s,g=4*this.get_Scale()*s,f=AlphaTab.Model.ModelUtils.GetIndex(l.Duration)-2,b=t+this.Y;h==AlphaTab.Rendering.Utils.BeamDirection.Down&&(T=-T,g=-g);for(var A=0;A<f;A++){var y,m,S,B,_=b+A*T;if(n<i.Beats.length-1){if(AlphaTab.Rendering.Utils.BeamingHelper.IsFullBarJoin(l,i.Beats[n+1],A))y=o,m=i.GetBeatLineX(i.Beats[n+1])+this.get_Scale();else{if(0!=n&&AlphaTab.Rendering.Utils.BeamingHelper.IsFullBarJoin(i.Beats[n-1],l,A))continue;m=(y=o)+c}S=_+this.CalculateBeamY(i,y)*s,B=_+this.CalculateBeamY(i,m)*s,AlphaTab.Rendering.ScoreBarRenderer.PaintSingleBar(a,e+this.X+y,S,e+this.X+m,B,g)}else n>0&&!AlphaTab.Rendering.Utils.BeamingHelper.IsFullBarJoin(l,i.Beats[n-1],A)&&(y=o-c,m=o,S=_+this.CalculateBeamY(i,y)*s,B=_+this.CalculateBeamY(i,m)*s,AlphaTab.Rendering.ScoreBarRenderer.PaintSingleBar(a,e+this.X+y,S,e+this.X+m,B,g))}}},PaintFooter:function(e,t,a,i){var n,r,l=i.Beats[0],s=l.GraceType!=AlphaTab.Model.GraceType.None,o=s?.75:1,h=this.GetFooterStemSize(i.ShortestDuration),p=i.GetBeatLineX(l)+this.get_Scale(),d=i.Direction,u=this.GetScoreY(this.GetNoteLine(l.get_MaxNote()),0),c=this.GetScoreY(this.GetNoteLine(l.get_MinNote()),0);if(d==AlphaTab.Rendering.Utils.BeamDirection.Down?(n=c+=h*o,r=t+this.Y+c):(n=u-=h*o,r=t+this.Y+u),this.PaintFingering(a,l,e+this.X+p,d,r),l.Duration!=AlphaTab.Model.Duration.Whole&&l.Duration!=AlphaTab.Model.Duration.DoubleWhole&&l.Duration!=AlphaTab.Model.Duration.QuadrupleWhole){if(a.set_LineWidth(1.5*this.get_Scale()),a.BeginPath(),a.MoveTo(e+this.X+p,t+this.Y+u),a.LineTo(e+this.X+p,t+this.Y+c),a.Stroke(),a.set_LineWidth(this.get_Scale()),s){var T=15*this.get_Scale(),g=12*this.get_Scale();a.BeginPath(),d==AlphaTab.Rendering.Utils.BeamDirection.Down?(a.MoveTo(e+this.X+p-g/2,t+this.Y+c-T),a.LineTo(e+this.X+p+g/2,t+this.Y+c)):(a.MoveTo(e+this.X+p-g/2,t+this.Y+u+T),a.LineTo(e+this.X+p+g/2,t+this.Y+u)),a.Stroke()}if(l.Duration>AlphaTab.Model.Duration.Quarter){var f=new AlphaTab.Rendering.Glyphs.BeamGlyph(p-this.get_Scale()/2,n,l.Duration,d,s);f.Renderer=this,f.DoLayout(),f.Paint(e+this.X,t+this.Y,a)}}},PaintFingering:function(e,t,a,i,n){i==AlphaTab.Rendering.Utils.BeamDirection.Up?a-=10*this.get_Scale():a+=3*this.get_Scale();var r=t.Notes.slice();r.sort($CreateAnonymousDelegate(this,function(e,t){return e.get_RealValue()-t.get_RealValue()}));for(var l=0;l<r.length;l++){var s=r[l],o=null;s.LeftHandFinger!=AlphaTab.Model.Fingers.Unknown?o=this.FingerToString(t,s.LeftHandFinger,!0):s.RightHandFinger!=AlphaTab.Model.Fingers.Unknown&&(o=this.FingerToString(t,s.RightHandFinger,!1)),null!=o&&(e.FillText(o,a,n),n-=0|e.get_Font().Size)}},FingerToString:function(e,t,a){if(this.get_Settings().ForcePianoFingering||AlphaTab.Audio.GeneralMidi.IsPiano(e.Voice.Bar.Staff.Track.PlaybackInfo.Program))switch(t){case AlphaTab.Model.Fingers.Unknown:case AlphaTab.Model.Fingers.NoOrDead:return null;case AlphaTab.Model.Fingers.Thumb:return"1";case AlphaTab.Model.Fingers.IndexFinger:return"2";case AlphaTab.Model.Fingers.MiddleFinger:return"3";case AlphaTab.Model.Fingers.AnnularFinger:return"4";case AlphaTab.Model.Fingers.LittleFinger:return"5";default:return null}else if(a)switch(t){case AlphaTab.Model.Fingers.Unknown:case AlphaTab.Model.Fingers.NoOrDead:return"0";case AlphaTab.Model.Fingers.Thumb:return"T";case AlphaTab.Model.Fingers.IndexFinger:return"1";case AlphaTab.Model.Fingers.MiddleFinger:return"2";case AlphaTab.Model.Fingers.AnnularFinger:return"3";case AlphaTab.Model.Fingers.LittleFinger:return"4";default:return null}else switch(t){case AlphaTab.Model.Fingers.Unknown:case AlphaTab.Model.Fingers.NoOrDead:return null;case AlphaTab.Model.Fingers.Thumb:return"p";case AlphaTab.Model.Fingers.IndexFinger:return"i";case AlphaTab.Model.Fingers.MiddleFinger:return"m";case AlphaTab.Model.Fingers.AnnularFinger:return"a";case AlphaTab.Model.Fingers.LittleFinger:return"c";default:return null}},CreatePreBeatGlyphs:function(){if(AlphaTab.Rendering.BarRendererBase.prototype.CreatePreBeatGlyphs.call(this),this.Bar.get_MasterBar().IsRepeatStart&&this.AddPreBeatGlyph(new AlphaTab.Rendering.Glyphs.RepeatOpenGlyph(0,0,1.5,3)),this.get_IsFirstOfLine()||this.Bar.Clef!=this.Bar.PreviousBar.Clef||this.Bar.ClefOttavia!=this.Bar.PreviousBar.ClefOttavia){var e=0,t=0;switch(this.Bar.Clef){case AlphaTab.Model.Clef.Neutral:e=6;break;case AlphaTab.Model.Clef.F4:e=4,t=-1;break;case AlphaTab.Model.Clef.C3:e=6;break;case AlphaTab.Model.Clef.C4:e=4;break;case AlphaTab.Model.Clef.G2:e=8}this.CreateStartSpacing(),this.AddPreBeatGlyph(new AlphaTab.Rendering.Glyphs.ClefGlyph(0,this.GetScoreY(e,t),this.Bar.Clef,this.Bar.ClefOttavia))}(0==this.Index&&0!=this.Bar.get_MasterBar().KeySignature||null!=this.Bar.PreviousBar&&this.Bar.get_MasterBar().KeySignature!=this.Bar.PreviousBar.get_MasterBar().KeySignature)&&(this.CreateStartSpacing(),this.CreateKeySignatureGlyphs()),(null==this.Bar.PreviousBar||null!=this.Bar.PreviousBar&&this.Bar.get_MasterBar().TimeSignatureNumerator!=this.Bar.PreviousBar.get_MasterBar().TimeSignatureNumerator||null!=this.Bar.PreviousBar&&this.Bar.get_MasterBar().TimeSignatureDenominator!=this.Bar.PreviousBar.get_MasterBar().TimeSignatureDenominator)&&(this.CreateStartSpacing(),this.CreateTimeSignatureGlyphs()),this.AddPreBeatGlyph(new AlphaTab.Rendering.Glyphs.BarNumberGlyph(0,this.GetScoreY(-.5,0),this.Bar.Index+1)),this.Bar.get_IsEmpty()&&this.AddPreBeatGlyph(new AlphaTab.Rendering.Glyphs.SpacingGlyph(0,0,30*this.get_Scale()))},CreateBeatGlyphs:function(){for(var e=0;e<this.Bar.Voices.length;e++){var t=this.Bar.Voices[e];this.HasVoiceContainer(t)&&this.CreateVoiceGlyphs(t)}},CreatePostBeatGlyphs:function(){AlphaTab.Rendering.BarRendererBase.prototype.CreatePostBeatGlyphs.call(this),this.Bar.get_MasterBar().get_IsRepeatEnd()?(this.AddPostBeatGlyph(new AlphaTab.Rendering.Glyphs.RepeatCloseGlyph(this.X,0)),this.Bar.get_MasterBar().RepeatCount>2&&this.AddPostBeatGlyph(new AlphaTab.Rendering.Glyphs.RepeatCountGlyph(0,this.GetScoreY(-1,-3),this.Bar.get_MasterBar().RepeatCount))):null!=this.Bar.NextBar&&this.Bar.NextBar.get_MasterBar().IsRepeatStart||this.AddPostBeatGlyph(new AlphaTab.Rendering.Glyphs.BarSeperatorGlyph(0,0))},CreateStartSpacing:function(){this._startSpacing||(this.AddPreBeatGlyph(new AlphaTab.Rendering.Glyphs.SpacingGlyph(0,0,2*this.get_Scale())),this._startSpacing=!0)},CreateKeySignatureGlyphs:function(){var e=0,t=this.Bar.get_MasterBar().KeySignature,a=null==this.Bar.PreviousBar?0:this.Bar.PreviousBar.get_MasterBar().KeySignature;switch(this.Bar.Clef){case AlphaTab.Model.Clef.Neutral:e=0;break;case AlphaTab.Model.Clef.G2:e=1;break;case AlphaTab.Model.Clef.F4:e=2;break;case AlphaTab.Model.Clef.C3:e=-1;break;case AlphaTab.Model.Clef.C4:e=1}var i={},n=[];if(AlphaTab.Model.ModelUtils.KeySignatureIsSharp(t))for(s=0;s<Math.abs(t);s++){o=AlphaTab.Rendering.ScoreBarRenderer.SharpKsSteps[s]+e;n.push(new AlphaTab.Rendering.Glyphs.SharpGlyph(0,this.GetScoreY(o,0),!1)),i[o]=!0}else for(s=0;s<Math.abs(t);s++){o=AlphaTab.Rendering.ScoreBarRenderer.FlatKsSteps[s]+e;n.push(new AlphaTab.Rendering.Glyphs.FlatGlyph(0,this.GetScoreY(o,0),!1)),i[o]=!0}for(var r=Math.abs(a),l=AlphaTab.Model.ModelUtils.KeySignatureIsSharp(a)?AlphaTab.Rendering.ScoreBarRenderer.SharpKsSteps:AlphaTab.Rendering.ScoreBarRenderer.FlatKsSteps,s=0;s<r;s++){var o=l[s]+e;i.hasOwnProperty(o)||this.AddPreBeatGlyph(new AlphaTab.Rendering.Glyphs.NaturalizeGlyph(0,this.GetScoreY(l[s]+e,0),!1))}for(var h=0,p=n.length,d=n[h];h<p;h++,d=n[h])this.AddPreBeatGlyph(d)},CreateTimeSignatureGlyphs:function(){this.AddPreBeatGlyph(new AlphaTab.Rendering.Glyphs.SpacingGlyph(0,0,5*this.get_Scale())),this.AddPreBeatGlyph(new AlphaTab.Rendering.Glyphs.ScoreTimeSignatureGlyph(0,this.GetScoreY(2,0),this.Bar.get_MasterBar().TimeSignatureNumerator,this.Bar.get_MasterBar().TimeSignatureDenominator,this.Bar.get_MasterBar().TimeSignatureCommon))},CreateVoiceGlyphs:function(e){for(var t=0,a=e.Beats.length;t<a;t++){var i=e.Beats[t],n=new AlphaTab.Rendering.ScoreBeatContainerGlyph(i,this.GetOrCreateVoiceContainer(e));n.PreNotes=new AlphaTab.Rendering.Glyphs.ScoreBeatPreNotesGlyph,n.OnNotes=new AlphaTab.Rendering.Glyphs.ScoreBeatGlyph,this.AddBeatGlyph(n)}},GetNoteLine:function(e){return this.AccidentalHelper.GetNoteLine(e)},GetScoreY:function(e,t){return this.get_LineOffset()/2*e+t*this.get_Scale()},PaintBackground:function(e,t,a){AlphaTab.Rendering.BarRendererBase.prototype.PaintBackground.call(this,e,t,a);var i=this.get_Resources();a.set_Color(i.StaveLineColor);for(var n=t+this.Y+this.TopPadding,r=this.get_LineOffset(),l=0;l<5;l++)l>0&&(n+=r),a.FillRect(e+this.X,0|n,this.Width,this.get_Scale());a.set_Color(i.MainGlyphColor)}},$StaticConstructor(function(){AlphaTab.Rendering.ScoreBarRenderer.StaffId="score",AlphaTab.Rendering.ScoreBarRenderer.SharpKsSteps=new Int32Array([1,4,0,3,6,2,5]),AlphaTab.Rendering.ScoreBarRenderer.FlatKsSteps=new Int32Array([5,2,6,3,7,4,8]),AlphaTab.Rendering.ScoreBarRenderer.LineSpacing=8}),AlphaTab.Rendering.ScoreBarRenderer.PaintSingleBar=function(e,t,a,i,n,r){e.BeginPath(),e.MoveTo(t,a),e.LineTo(i,n),e.LineTo(i,n+r),e.LineTo(t,a+r),e.ClosePath(),e.Fill()},$Inherit(AlphaTab.Rendering.ScoreBarRenderer,AlphaTab.Rendering.BarRendererBase),AlphaTab.Rendering.ScoreBarRendererFactory=function(){AlphaTab.Rendering.BarRendererFactory.call(this)},AlphaTab.Rendering.ScoreBarRendererFactory.prototype={get_StaffId:function(){return"score"},Create:function(e,t,a){return new AlphaTab.Rendering.ScoreBarRenderer(e,t)}},$Inherit(AlphaTab.Rendering.ScoreBarRendererFactory,AlphaTab.Rendering.BarRendererFactory),AlphaTab.Rendering.ScoreRenderer=function(e){this._currentLayoutMode=null,this._currentRenderEngine=null,this._renderedTracks=null,this.PreRender=null,this.PartialRenderFinished=null,this.RenderFinished=null,this.Error=null,this.PostRenderFinished=null,this.Canvas=null,this.Score=null,this.Tracks=null,this.Layout=null,this.RenderingResources=null,this.Settings=null,this.BoundsLookup=null,this.Settings=e,this.RenderingResources=new AlphaTab.Rendering.RenderingResources(1),this.RecreateCanvas(),this.RecreateLayout()},AlphaTab.Rendering.ScoreRenderer.prototype={Destroy:function(){this.Score=null,this.Canvas=null,this.Layout=null,this.RenderingResources=null,this.Settings=null,this.BoundsLookup=null,this.Tracks=null},RecreateCanvas:function(){return this._currentRenderEngine!=this.Settings.Engine&&(null!=this.Settings.Engine&&AlphaTab.Environment.RenderEngines.hasOwnProperty(this.Settings.Engine)?this.Canvas=AlphaTab.Environment.RenderEngines[this.Settings.Engine]():this.Canvas=AlphaTab.Environment.RenderEngines.default(),this._currentRenderEngine=this.Settings.Engine,!0)},RecreateLayout:function(){return this._currentLayoutMode!=this.Settings.Layout.Mode&&(null!=this.Settings.Layout&&AlphaTab.Environment.LayoutEngines.hasOwnProperty(this.Settings.Layout.Mode)?this.Layout=AlphaTab.Environment.LayoutEngines[this.Settings.Layout.Mode](this):this.Layout=AlphaTab.Environment.LayoutEngines.default(this),this._currentLayoutMode=this.Settings.Layout.Mode,!0)},Render:function(e,t){try{this.Score=e;for(var a=[],i=0,n=t.length,r=t[i];i<n;i++,r=t[i])r>=0&&r<e.Tracks.length&&a.push(e.Tracks[r]);0==a.length&&e.Tracks.length>0&&a.push(e.Tracks[0]),this.Tracks=a.slice(0),this.Invalidate()}catch(e){this.OnError("render",e)}},RenderTracks:function(e){0==e.length?this.Score=null:this.Score=e[0].Score,this.Tracks=e,this.Invalidate()},UpdateSettings:function(e){this.Settings=e},Invalidate:function(){if(0!=this.Settings.Width){if(this.BoundsLookup=new AlphaTab.Rendering.Utils.BoundsLookup,0!=this.Tracks.length){this.RecreateCanvas(),this.RenderingResources.Scale!=this.Settings.Scale&&(this.RenderingResources.Init(this.Settings.Scale),this.Canvas.set_LineWidth(this.Settings.Scale)),this.Canvas.set_Resources(this.RenderingResources),AlphaTab.Util.Logger.Info("Rendering","Rendering "+this.Tracks.length+" tracks",null);for(var e=0;e<this.Tracks.length;e++){var t=this.Tracks[e];AlphaTab.Util.Logger.Info("Rendering","Track "+e+": "+t.Name,null)}this.OnPreRender(),this.RecreateLayout(),this.LayoutAndRender(),this._renderedTracks=this.Tracks,AlphaTab.Util.Logger.Info("Rendering","Rendering finished",null)}}else AlphaTab.Util.Logger.Warning("Rendering","AlphaTab skipped rendering because of width=0 (element invisible)",null)},Resize:function(e){this.RecreateLayout()||this.RecreateCanvas()||this._renderedTracks!=this.Tracks||null==this.Tracks?(AlphaTab.Util.Logger.Info("Rendering","Starting full rerendering due to layout or canvas change",null),this.Invalidate()):this.Layout.get_SupportsResize()?(AlphaTab.Util.Logger.Info("Rendering","Starting optimized rerendering for resize",null),this.BoundsLookup=new AlphaTab.Rendering.Utils.BoundsLookup,this.OnPreRender(),this.Settings.Width=e,this.Layout.Resize(),this.Layout.RenderAnnotation(),this.OnRenderFinished(),this.OnPostRender()):AlphaTab.Util.Logger.Warning("Rendering","Current layout does not support dynamic resizing, nothing was done",null),AlphaTab.Util.Logger.Info("Rendering","Resize finished",null)},LayoutAndRender:function(){AlphaTab.Util.Logger.Info("Rendering","Rendering at scale "+this.Settings.Scale+" with layout "+this.Layout.get_Name(),null),this.Layout.LayoutAndRender(),this.Layout.RenderAnnotation(),this.OnRenderFinished(),this.OnPostRender()},add_PreRender:function(e){this.PreRender=$CombineDelegates(this.PreRender,e)},remove_PreRender:function(e){this.PreRender=$RemoveDelegate(this.PreRender,e)},OnPreRender:function(){var e=this.Canvas.OnPreRender(),t=this.PreRender,a=new AlphaTab.Rendering.RenderFinishedEventArgs;a.TotalWidth=0,a.TotalHeight=0,a.Width=0,a.Height=0,a.RenderResult=e,null!=t&&t(a)},add_PartialRenderFinished:function(e){this.PartialRenderFinished=$CombineDelegates(this.PartialRenderFinished,e)},remove_PartialRenderFinished:function(e){this.PartialRenderFinished=$RemoveDelegate(this.PartialRenderFinished,e)},OnPartialRenderFinished:function(e){var t=this.PartialRenderFinished;null!=t&&t(e)},add_RenderFinished:function(e){this.RenderFinished=$CombineDelegates(this.RenderFinished,e)},remove_RenderFinished:function(e){this.RenderFinished=$RemoveDelegate(this.RenderFinished,e)},OnRenderFinished:function(){var e=this.Canvas.OnRenderFinished(),t=this.RenderFinished;null!=t&&t(function(){var t=new AlphaTab.Rendering.RenderFinishedEventArgs;return t.RenderResult=e,t.TotalHeight=this.Layout.Height,t.TotalWidth=this.Layout.Width,t}.call(this))},add_Error:function(e){this.Error=$CombineDelegates(this.Error,e)},remove_Error:function(e){this.Error=$RemoveDelegate(this.Error,e)},OnError:function(e,t){var a=this.Error;null!=a&&a(e,t)},add_PostRenderFinished:function(e){this.PostRenderFinished=$CombineDelegates(this.PostRenderFinished,e)},remove_PostRenderFinished:function(e){this.PostRenderFinished=$RemoveDelegate(this.PostRenderFinished,e)},OnPostRender:function(){var e=this.PostRenderFinished;null!=e&&e()}},AlphaTab.Rendering.Staves=AlphaTab.Rendering.Staves||{},AlphaTab.Rendering.Staves.BarLayoutingInfo=function(){this._timeSortedSprings=null,this._xMin=0,this._onTimePositionsForce=0,this._onTimePositions=null,this.Version=0,this.PreBeatSizes=null,this.OnBeatSizes=null,this.PreBeatSize=0,this.PostBeatSize=0,this.VoiceSize=0,this.MinStretchForce=0,this.TotalSpringConstant=0,this.Springs=null,this.SmallestDuration=0,this.PreBeatSizes={},this.OnBeatSizes={},this.VoiceSize=0,this.Springs={},this.Version=0},AlphaTab.Rendering.Staves.BarLayoutingInfo.prototype={UpdateVoiceSize:function(e){e>this.VoiceSize&&(this.VoiceSize=e,this.Version++)},SetPreBeatSize:function(e,t){(!this.PreBeatSizes.hasOwnProperty(e.Index)||this.PreBeatSizes[e.Index]<t)&&(this.PreBeatSizes[e.Index]=t,this.Version++)},GetPreBeatSize:function(e){return this.PreBeatSizes.hasOwnProperty(e.Index)?this.PreBeatSizes[e.Index]:0},SetOnBeatSize:function(e,t){(!this.OnBeatSizes.hasOwnProperty(e.Index)||this.OnBeatSizes[e.Index]<t)&&(this.OnBeatSizes[e.Index]=t,this.Version++)},GetOnBeatSize:function(e){return this.OnBeatSizes.hasOwnProperty(e.Index)?this.OnBeatSizes[e.Index]:0},UpdateMinStretchForce:function(e){this.MinStretchForce<e&&(this.MinStretchForce=e,this.Version++)},AddSpring:function(e,t,a,i){this.Version++;var n;return this.Springs.hasOwnProperty(e)?((n=this.Springs[e]).SpringWidth<a&&(n.SpringWidth=a),n.PreSpringWidth<i&&(n.PreSpringWidth=i),t<n.SmallestDuration&&(n.SmallestDuration=t),t>n.LongestDuration&&(n.LongestDuration=t)):((n=new AlphaTab.Rendering.Staves.Spring).TimePosition=e,n.SmallestDuration=t,n.LongestDuration=t,n.SpringWidth=a,n.PreSpringWidth=i,this.Springs[e]=n),t<this.SmallestDuration&&(this.SmallestDuration=t),n},AddBeatSpring:function(e,t,a){return this.AddSpring(e.get_AbsoluteStart(),e.CalculateDuration(),t,a)},Finish:function(){this.CalculateSpringConstants(),this.Version++},CalculateSpringConstants:function(){var e=this._timeSortedSprings=[];this._xMin=0;var t=this.Springs;for(var a in t){var i=t[a];e.push(i),i.SpringWidth<this._xMin&&(this._xMin=i.SpringWidth)}e.sort($CreateAnonymousDelegate(this,function(e,t){return e.TimePosition<t.TimePosition?-1:e.TimePosition>t.TimePosition?1:0}));for(var n=0,r=0;r<e.length;r++){var l,s=e[r];l=r==e.length-1?s.LongestDuration:e[r+1].TimePosition-s.TimePosition,s.SpringConstant=this.CalculateSpringConstant(s,l),n+=1/s.SpringConstant}this.TotalSpringConstant=1/n;for(r=0;r<e.length;r++){var o=e[r].SpringWidth*e[r].SpringConstant;this.UpdateMinStretchForce(o)}},CalculateSpringConstant:function(e,t){var a=e.SmallestDuration;return 0==e.SmallestDuration&&(a=t),a/t*1/(10*(1+.6*Math.log2(t/30)))},SpaceToForce:function(e){return e*this.TotalSpringConstant},CalculateVoiceWidth:function(e){return this.CalculateWidth(e,this.TotalSpringConstant)},CalculateWidth:function(e,t){return e/t},BuildOnTimePositions:function(e){if(Math.abs(this._onTimePositionsForce-e)<1e-5&&null!=this._onTimePositions)return this._onTimePositions;this._onTimePositionsForce=e;var t=this._onTimePositions={},a=this._timeSortedSprings;if(0==a.length)return t;for(var i=a[0].PreSpringWidth,n=0;n<a.length;n++)t[a[n].TimePosition]=i,i+=this.CalculateWidth(e,a[n].SpringConstant);return t}},$StaticConstructor(function(){AlphaTab.Rendering.Staves.BarLayoutingInfo.MinDuration=30,AlphaTab.Rendering.Staves.BarLayoutingInfo.MinDurationWidth=10}),AlphaTab.Rendering.Staves.Spring=function(){this.TimePosition=0,this.LongestDuration=0,this.SmallestDuration=0,this.Force=0,this.SpringConstant=0,this.SpringWidth=0,this.PreSpringWidth=0},AlphaTab.Rendering.Staves.MasterBarsRenderers=function(){this.Width=0,this.IsLinkedToPrevious=!1,this.MasterBar=null,this.Renderers=null,this.LayoutingInfo=null,this.Renderers=[]},AlphaTab.Rendering.Staves.Staff=function(e,t,a){this._factory=null,this.StaveTrackGroup=null,this.StaveGroup=null,this.BarRenderers=null,this.X=0,this.Y=0,this.Height=0,this.Index=0,this.StaffIndex=0,this.TrackIndex=0,this.ModelStaff=null,this.StaveTop=0,this.TopSpacing=0,this.BottomSpacing=0,this.StaveBottom=0,this.IsFirstInAccolade=!1,this.IsLastInAccolade=!1,this.BarRenderers=[],this.TrackIndex=e,this.ModelStaff=t,this._factory=a,this.TopSpacing=15,this.BottomSpacing=5,this.StaveTop=0,this.StaveBottom=0},AlphaTab.Rendering.Staves.Staff.prototype={get_StaveId:function(){return this._factory.get_StaffId()},get_IsInAccolade:function(){return this._factory.IsInAccolade},RegisterStaffTop:function(e){this.StaveTop=e},RegisterStaffBottom:function(e){this.StaveBottom=e},AddBarRenderer:function(e){e.Staff=this,e.Index=this.BarRenderers.length,e.ReLayout(),this.BarRenderers.push(e),this.StaveGroup.Layout.RegisterBarRenderer(this.get_StaveId(),e)},AddBar:function(e,t){var a;(a=null==e?new AlphaTab.Rendering.BarRendererBase(this.StaveGroup.Layout.Renderer,e):this._factory.Create(this.StaveGroup.Layout.Renderer,e,this.StaveGroup.Layout.Renderer.Settings.Staves)).Staff=this,a.Index=this.BarRenderers.length,a.LayoutingInfo=t,a.DoLayout(),a.RegisterLayoutingInfo(),this.BarRenderers.push(a),null!=e&&this.StaveGroup.Layout.RegisterBarRenderer(this.get_StaveId(),a)},RevertLastBar:function(){var e=this.BarRenderers[this.BarRenderers.length-1];this.BarRenderers.splice(this.BarRenderers.length-1,1),this.StaveGroup.Layout.UnregisterBarRenderer(this.get_StaveId(),e)},ScaleToWidth:function(e){for(var t=(e-this.StaveGroup.Width)/this.BarRenderers.length,a=0,i=this.BarRenderers.length;a<i;a++)this.BarRenderers[a].ScaleToWidth(this.BarRenderers[a].Width+t)},get_TopOverflow:function(){for(var e=0,t=0,a=this.BarRenderers.length;t<a;t++){var i=this.BarRenderers[t];i.TopOverflow>e&&(e=i.TopOverflow)}return e},get_BottomOverflow:function(){for(var e=0,t=0,a=this.BarRenderers.length;t<a;t++){var i=this.BarRenderers[t];i.BottomOverflow>e&&(e=i.BottomOverflow)}return e},FinalizeStave:function(){var e=0;this.Height=0;for(var t=this.get_TopOverflow(),a=this.get_BottomOverflow(),i=0;i<this.BarRenderers.length;i++)this.BarRenderers[i].X=e,this.BarRenderers[i].Y=this.TopSpacing+t,this.Height=Math.max(this.Height,this.BarRenderers[i].Height),this.BarRenderers[i].FinalizeRenderer(),e+=this.BarRenderers[i].Width;this.Height>0&&(this.Height+=this.TopSpacing+t+a+this.BottomSpacing)},Paint:function(e,t,a,i,n){if(0!=this.Height&&0!=n)for(var r=i,l=Math.min(i+n,this.BarRenderers.length);r<l;r++)this.BarRenderers[r].Paint(e+this.X,t+this.Y,a)}},AlphaTab.Rendering.Staves.StaveTrackGroup=function(e,t){this.Track=null,this.StaveGroup=null,this.Staves=null,this.FirstStaffInAccolade=null,this.LastStaffInAccolade=null,this.StaveGroup=e,this.Track=t,this.Staves=[]},AlphaTab.Rendering.Staves.StaveGroup=function(){this._allStaves=null,this._firstStaffInAccolade=null,this._lastStaffInAccolade=null,this._accoladeSpacingCalculated=!1,this.X=0,this.Y=0,this.Index=0,this.AccoladeSpacing=0,this.IsFull=!1,this.Width=0,this.IsLast=!1,this.MasterBarsRenderers=null,this.Staves=null,this.Layout=null,this.MasterBarsRenderers=[],this.Staves=[],this._allStaves=[],this.Width=0,this.Index=0,this._accoladeSpacingCalculated=!1,this.AccoladeSpacing=0},AlphaTab.Rendering.Staves.StaveGroup.prototype={get_FirstBarIndex:function(){return this.MasterBarsRenderers[0].MasterBar.Index},get_LastBarIndex:function(){return this.MasterBarsRenderers[this.MasterBarsRenderers.length-1].MasterBar.Index},AddMasterBarRenderers:function(e,t){if(0==e.length)return null;this.MasterBarsRenderers.push(t),this.CalculateAccoladeSpacing(e),t.LayoutingInfo.PreBeatSize=0;for(var a=0,i=0,n=this.Staves.length;i<n;i++)for(var r=this.Staves[i],l=0,s=r.Staves.length;l<s;l++){var o=r.Staves[l],h=t.Renderers[a++];o.AddBarRenderer(h)}return this.UpdateWidth(),t},AddBars:function(e,t){if(0==e.length)return null;var a=new AlphaTab.Rendering.Staves.MasterBarsRenderers;a.LayoutingInfo=new AlphaTab.Rendering.Staves.BarLayoutingInfo,a.MasterBar=e[0].Score.MasterBars[t],this.MasterBarsRenderers.push(a),this.CalculateAccoladeSpacing(e);for(var i=a.LayoutingInfo,n=0,r=this.Staves,l=r.length,s=r[n];n<l;n++,s=r[n])for(var o=0,h=s.Staves,p=h.length,d=h[o];o<p;o++,d=h[o]){d.AddBar(s.Track.Staves[d.ModelStaff.Index].Bars[t],i);var u=d.BarRenderers[d.BarRenderers.length-1];a.Renderers.push(u),u.IsLinkedToPrevious&&(a.IsLinkedToPrevious=!0)}return i.Finish(),a.Width=this.UpdateWidth(),a},RevertLastBar:function(){if(this.MasterBarsRenderers.length>1){this.MasterBarsRenderers.splice(this.MasterBarsRenderers.length-1,1);for(var e=0,t=0,a=this._allStaves.length;t<a;t++){var i=this._allStaves[t];e=Math.max(e,i.BarRenderers[i.BarRenderers.length-1].Width),i.RevertLastBar()}this.Width-=e}},UpdateWidth:function(){for(var e=0,t=0,a=this._allStaves.length;t<a;t++){var i=this._allStaves[t];i.BarRenderers[i.BarRenderers.length-1].ApplyLayoutingInfo(),i.BarRenderers[i.BarRenderers.length-1].Width>e&&(e=i.BarRenderers[i.BarRenderers.length-1].Width)}return this.Width+=e,e},CalculateAccoladeSpacing:function(e){if(!this._accoladeSpacingCalculated&&0==this.Index)if(this._accoladeSpacingCalculated=!0,this.Layout.Renderer.Settings.Layout.Get("hideTrackNames",!1))this.AccoladeSpacing=0;else{var t=this.Layout.Renderer.Canvas,a=this.Layout.Renderer.RenderingResources.EffectFont;t.set_Font(a);for(var i=0;i<e.length;i++)this.AccoladeSpacing=Math.max(this.AccoladeSpacing,t.MeasureText(e[i].ShortName));this.AccoladeSpacing+=20,this.Width+=this.AccoladeSpacing}},GetStaveTrackGroup:function(e){for(var t=0,a=this.Staves.length;t<a;t++){var i=this.Staves[t];if(i.Track==e)return i}return null},AddStaff:function(e,t){var a=this.GetStaveTrackGroup(e);null==a&&(a=new AlphaTab.Rendering.Staves.StaveTrackGroup(this,e),this.Staves.push(a)),t.StaveTrackGroup=a,t.StaveGroup=this,t.Index=this._allStaves.length,this._allStaves.push(t),a.Staves.push(t),t.get_IsInAccolade()&&(null==this._firstStaffInAccolade&&(this._firstStaffInAccolade=t,t.IsFirstInAccolade=!0),null==a.FirstStaffInAccolade&&(a.FirstStaffInAccolade=t),null==this._lastStaffInAccolade&&(this._lastStaffInAccolade=t,t.IsLastInAccolade=!0),null!=this._lastStaffInAccolade&&(this._lastStaffInAccolade.IsLastInAccolade=!1),this._lastStaffInAccolade=t,this._lastStaffInAccolade.IsLastInAccolade=!0,a.LastStaffInAccolade=t)},get_Height:function(){return this._allStaves[this._allStaves.length-1].Y+this._allStaves[this._allStaves.length-1].Height},ScaleToWidth:function(e){for(var t=0,a=this._allStaves.length;t<a;t++)this._allStaves[t].ScaleToWidth(e);this.Width=e},Paint:function(e,t,a){this.PaintPartial(e+this.X,t+this.Y,a,0,this.MasterBarsRenderers.length)},PaintPartial:function(e,t,a,i,n){this.BuildBoundingsLookup(e,t);for(var r=0,l=this._allStaves.length;r<l;r++)this._allStaves[r].Paint(e,t,a,i,n);var s=this.Layout.Renderer.RenderingResources;if(this.Staves.length>0&&0==i){if(null!=this._firstStaffInAccolade&&null!=this._lastStaffInAccolade){var o=t+this._firstStaffInAccolade.Y+this._firstStaffInAccolade.StaveTop+this._firstStaffInAccolade.TopSpacing+this._firstStaffInAccolade.get_TopOverflow(),h=t+this._lastStaffInAccolade.Y+this._lastStaffInAccolade.TopSpacing+this._lastStaffInAccolade.get_TopOverflow()+this._lastStaffInAccolade.StaveBottom,p=e+this._firstStaffInAccolade.X;a.set_Color(s.BarSeperatorColor),a.BeginPath(),a.MoveTo(p,o),a.LineTo(p,h),a.Stroke()}a.set_Font(s.EffectFont);for(var r=0,l=this.Staves.length;r<l;r++){var d=this.Staves[r];if(null!=d.FirstStaffInAccolade&&null!=d.LastStaffInAccolade){var o=t+d.FirstStaffInAccolade.Y+d.FirstStaffInAccolade.StaveTop+d.FirstStaffInAccolade.TopSpacing+d.FirstStaffInAccolade.get_TopOverflow(),h=t+d.LastStaffInAccolade.Y+d.LastStaffInAccolade.TopSpacing+d.LastStaffInAccolade.get_TopOverflow()+d.LastStaffInAccolade.StaveBottom,p=e+d.FirstStaffInAccolade.X,u=3*this.Layout.Renderer.Settings.Scale,c=u,T=o-4*u,g=h+4*u;0!=this.Index||this.Layout.Renderer.Settings.Layout.Get("hideTrackNames",!1)||a.FillText(d.Track.ShortName,e+10*this.Layout.get_Scale(),o),a.FillRect(p-c-u,T,u,g-T);var f=p-c-u,b=p+2*u;a.BeginPath(),a.MoveTo(f,T),a.BezierCurveTo(f,T,f,T,b,T-u),a.BezierCurveTo(p,T+u,f,T+u,f,T+u),a.ClosePath(),a.Fill(),a.BeginPath(),a.MoveTo(f,g),a.BezierCurveTo(f,g,p,g,b,g+u),a.BezierCurveTo(p,g-u,f,g-u,f,g-u),a.ClosePath(),a.Fill()}}}},FinalizeGroup:function(){for(var e=0,t=0,a=this._allStaves,i=a.length,n=a[t];t<i;t++,n=a[t])n.X=this.AccoladeSpacing,n.Y=e,n.FinalizeStave(),e+=n.Height},BuildBoundingsLookup:function(e,t){if(!this.Layout.Renderer.BoundsLookup.IsFinished&&null!=this._firstStaffInAccolade&&null!=this._lastStaffInAccolade){var a=t+this.Y+this._firstStaffInAccolade.Y,i=t+this.Y+this._lastStaffInAccolade.Y+this._lastStaffInAccolade.Height,n=t+this.Y+this._allStaves[0].Y,r=i-a,l=t+this.Y+this._allStaves[this._allStaves.length-1].Y+this._allStaves[this._allStaves.length-1].Height-n,s=this.X+this._firstStaffInAccolade.X,o=new AlphaTab.Rendering.Utils.StaveGroupBounds;o.VisualBounds={X:e,Y:t+this.Y,W:this.Width,H:this.get_Height()},o.RealBounds={X:e,Y:t+this.Y,W:this.Width,H:this.get_Height()},this.Layout.Renderer.BoundsLookup.AddStaveGroup(o);for(var h=[],p=0;p<this.Staves.length;p++)for(var d=0,u=this.Staves[p].FirstStaffInAccolade.BarRenderers.length;d<u;d++){var c=this.Staves[p].FirstStaffInAccolade.BarRenderers[d];if(0==p){var T=new AlphaTab.Rendering.Utils.MasterBarBounds;T.IsFirstOfLine=c.get_IsFirstOfLine(),T.RealBounds={X:s+c.X,Y:n,W:c.Width,H:l},T.VisualBounds={X:s+c.X,Y:a,W:c.Width,H:r},this.Layout.Renderer.BoundsLookup.AddMasterBar(T),h.push(T)}c.BuildBoundingsLookup(h[d],s,t+this.Y+this._firstStaffInAccolade.Y)}}},GetBarX:function(e){if(null==this._firstStaffInAccolade||0==this.Layout.Renderer.Tracks.length)return 0;var t=this.Layout.Renderer.Tracks[0].Staves[0].Bars[e];return this.Layout.GetRendererForBar(this._firstStaffInAccolade.get_StaveId(),t).X}},$StaticConstructor(function(){AlphaTab.Rendering.Staves.StaveGroup.AccoladeLabelSpacing=10}),AlphaTab.Rendering.TabBarRenderer=function(e,t){this._startSpacing=!1,this.ShowTimeSignature=!1,this.ShowRests=!1,this.ShowTiedNotes=!1,this.RenderRhythm=!1,this.RhythmHeight=0,this.RhythmBeams=!1,AlphaTab.Rendering.BarRendererBase.call(this,e,t),this.RhythmHeight=15*e.Layout.get_Scale(),this.RhythmBeams=!0},AlphaTab.Rendering.TabBarRenderer.prototype={get_LineOffset:function(){return 11*this.get_Scale()},GetNoteX:function(e,t){var a=this.GetOnNotesGlyphForBeat(e.Beat);return null!=a?a.Container.X+a.Container.VoiceContainer.X+a.X+a.NoteNumbers.GetNoteX(e,t):0},GetNoteY:function(e){var t=this.GetOnNotesGlyphForBeat(e.Beat);return null!=t?t.NoteNumbers.GetNoteY(e):0},UpdateSizes:function(){var e=this.get_Resources(),t=e.TablatureFont.Size/2+.2*e.TablatureFont.Size;this.TopPadding=t,this.BottomPadding=t,this.Height=this.get_LineOffset()*(this.Bar.Staff.Track.Tuning.length-1)+2*t,this.RenderRhythm&&(this.Height+=this.RhythmHeight,this.BottomPadding+=this.RhythmHeight),AlphaTab.Rendering.BarRendererBase.prototype.UpdateSizes.call(this)},CreatePreBeatGlyphs:function(){if(AlphaTab.Rendering.BarRendererBase.prototype.CreatePreBeatGlyphs.call(this),this.Bar.get_MasterBar().IsRepeatStart&&this.AddPreBeatGlyph(new AlphaTab.Rendering.Glyphs.RepeatOpenGlyph(0,0,1.5,3)),this.get_IsFirstOfLine()){var e=(this.Bar.Staff.Track.Tuning.length+1)/2;this.AddPreBeatGlyph(new AlphaTab.Rendering.Glyphs.TabClefGlyph(5*this.get_Scale(),this.GetTabY(e,0)))}this.ShowTimeSignature&&(null==this.Bar.PreviousBar||null!=this.Bar.PreviousBar&&this.Bar.get_MasterBar().TimeSignatureNumerator!=this.Bar.PreviousBar.get_MasterBar().TimeSignatureNumerator||null!=this.Bar.PreviousBar&&this.Bar.get_MasterBar().TimeSignatureDenominator!=this.Bar.PreviousBar.get_MasterBar().TimeSignatureDenominator)&&(this.CreateStartSpacing(),this.CreateTimeSignatureGlyphs()),this.AddPreBeatGlyph(new AlphaTab.Rendering.Glyphs.BarNumberGlyph(0,this.GetTabY(-.5,0),this.Bar.Index+1)),this.Bar.get_IsEmpty()&&this.AddPreBeatGlyph(new AlphaTab.Rendering.Glyphs.SpacingGlyph(0,0,30*this.get_Scale()))},CreateStartSpacing:function(){this._startSpacing||(this.AddPreBeatGlyph(new AlphaTab.Rendering.Glyphs.SpacingGlyph(0,0,2*this.get_Scale())),this._startSpacing=!0)},CreateTimeSignatureGlyphs:function(){this.AddPreBeatGlyph(new AlphaTab.Rendering.Glyphs.SpacingGlyph(0,0,5*this.get_Scale())),this.AddPreBeatGlyph(new AlphaTab.Rendering.Glyphs.TabTimeSignatureGlyph(0,this.GetTabY(0,0),this.Bar.get_MasterBar().TimeSignatureNumerator,this.Bar.get_MasterBar().TimeSignatureDenominator,this.Bar.get_MasterBar().TimeSignatureCommon))},CreateBeatGlyphs:function(){for(var e=0;e<this.Bar.Voices.length;e++){var t=this.Bar.Voices[e];this.HasVoiceContainer(t)&&this.CreateVoiceGlyphs(this.Bar.Voices[e])}},CreateVoiceGlyphs:function(e){for(var t=0,a=e.Beats.length;t<a;t++){var i=e.Beats[t],n=new AlphaTab.Rendering.Glyphs.TabBeatContainerGlyph(i,this.GetOrCreateVoiceContainer(e));n.PreNotes=new AlphaTab.Rendering.Glyphs.TabBeatPreNotesGlyph,n.OnNotes=new AlphaTab.Rendering.Glyphs.TabBeatGlyph,this.AddBeatGlyph(n)}},CreatePostBeatGlyphs:function(){AlphaTab.Rendering.BarRendererBase.prototype.CreatePostBeatGlyphs.call(this),this.Bar.get_MasterBar().get_IsRepeatEnd()?(this.AddPostBeatGlyph(new AlphaTab.Rendering.Glyphs.RepeatCloseGlyph(this.X,0)),this.Bar.get_MasterBar().RepeatCount>2&&this.AddPostBeatGlyph(new AlphaTab.Rendering.Glyphs.RepeatCountGlyph(0,this.GetTabY(-.5,-3),this.Bar.get_MasterBar().RepeatCount))):null!=this.Bar.NextBar&&this.Bar.NextBar.get_MasterBar().IsRepeatStart||this.AddPostBeatGlyph(new AlphaTab.Rendering.Glyphs.BarSeperatorGlyph(0,0))},GetTabY:function(e,t){return this.get_LineOffset()*e+t*this.get_Scale()},PaintBackground:function(e,t,a){AlphaTab.Rendering.BarRendererBase.prototype.PaintBackground.call(this,e,t,a);var i=this.get_Resources();a.set_Color(i.StaveLineColor);for(var n=t+this.Y+this.TopPadding,r=this.get_Scale(),l=[],s=0,o=this.Bar.Staff.Track.Tuning.length;s<o;s++)l.push([]);for(var h=0,p=this.Bar.Voices,d=p.length,u=p[h];h<d;h++,u=p[h])if(this.HasVoiceContainer(u))for(var c=this.GetOrCreateVoiceContainer(u),T=0,g=c.BeatGlyphs,f=g.length,b=g[T];T<f;T++,b=g[T]){var A=b.OnNotes,y=A.NoteNumbers;if(null!=y)for(var m in y.NotesPerString)y.NotesPerString[m].IsEmpty||l[this.Bar.Staff.Track.Tuning.length-m].push(new Float32Array([c.X+b.X+A.X+y.X,y.Width+r]))}for(var S=0,B=l.length,_=l[S];S<B;S++,_=l[S])_.sort($CreateAnonymousDelegate(this,function(e,t){return e[0]>t[0]?1:e[0]<t[0]?-1:0}));for(var R=this.get_LineOffset(),s=0,o=this.Bar.Staff.Track.Tuning.length;s<o;s++){s>0&&(n+=R);for(var G=0,M=0,v=l[s],I=v.length,_=v[M];M<I;M++,_=v[M])a.FillRect(e+this.X+G,0|n,_[0]-G,this.get_Scale()),G=_[0]+_[1];a.FillRect(e+this.X+G,0|n,this.Width-G,this.get_Scale())}a.set_Color(i.MainGlyphColor)},Paint:function(e,t,a){AlphaTab.Rendering.BarRendererBase.prototype.Paint.call(this,e,t,a),this.RenderRhythm&&this.PaintBeams(e,t,a)},PaintBeams:function(e,t,a){for(var i=0,n=this.Helpers.BeamHelpers.length;i<n;i++)for(var r=this.Helpers.BeamHelpers[i],l=0,s=r.length;l<s;l++){var o=r[l];this.PaintBeamHelper(e+this.get_BeatGlyphsStart(),t,a,o)}},PaintBeamHelper:function(e,t,a,i){a.set_Color(0==i.Voice.Index?this.get_Resources().MainGlyphColor:this.get_Resources().SecondaryGlyphColor),1!=i.Beats.length&&this.RhythmBeams?this.PaintBar(e,t,a,i):this.PaintFooter(e,t,a,i)},PaintBar:function(e,t,a,i){for(var n=0,r=i.Beats.length;n<r;n++){var l=i.Beats[n];if(i.HasBeatLineX(l)){var s=i.GetBeatLineX(l),o=t+this.Y,h=t+this.Y+this.Height,p=this.GetOnNotesGlyphForBeat(l);null==p.NoteNumbers?o+=this.Height-this.RhythmHeight:o+=p.NoteNumbers.GetNoteY(p.NoteNumbers.MinStringNote)+this.get_LineOffset()/2,i.Direction==AlphaTab.Rendering.Utils.BeamDirection.Up?s-=p.Width/2:s+=p.Width/2,a.BeginPath(),a.MoveTo(e+this.X+s,o),a.LineTo(e+this.X+s,h),a.Stroke();var d=6*this.get_Scale(),u=6*this.get_Scale(),c=3*this.get_Scale(),T=AlphaTab.Model.ModelUtils.GetIndex(l.Duration)-2,g=t+this.Y;u=-u,g+=this.Height;for(var f=0;f<T;f++){var b,A,y,m,S=g+f*u;if(1==i.Beats.length)b=s,A=s+d,y=S,m=S,AlphaTab.Rendering.TabBarRenderer.PaintSingleBar(a,e+this.X+b,y,e+this.X+A,m,c);else if(n<i.Beats.length-1){if(AlphaTab.Rendering.Utils.BeamingHelper.IsFullBarJoin(l,i.Beats[n+1],f)){b=s,A=i.GetBeatLineX(i.Beats[n+1])+this.get_Scale();var B=this.GetOnNotesGlyphForBeat(i.Beats[n+1]);i.Direction==AlphaTab.Rendering.Utils.BeamDirection.Up?A-=B.Width/2:A+=B.Width/2}else{if(0!=n&&AlphaTab.Rendering.Utils.BeamingHelper.IsFullBarJoin(i.Beats[n-1],l,f))continue;A=(b=s)+d}y=S,m=S,AlphaTab.Rendering.TabBarRenderer.PaintSingleBar(a,e+this.X+b,y,e+this.X+A,m,c)}else n>0&&!AlphaTab.Rendering.Utils.BeamingHelper.IsFullBarJoin(l,i.Beats[n-1],f)&&(b=s-d,A=s,y=S,m=S,AlphaTab.Rendering.TabBarRenderer.PaintSingleBar(a,e+this.X+b,y,e+this.X+A,m,c))}}}},PaintFooter:function(e,t,a,i){for(var n=0,r=i.Beats,l=r.length,s=r[n];n<l;n++,s=r[n]){if(s.Duration==AlphaTab.Model.Duration.Whole||s.Duration==AlphaTab.Model.Duration.DoubleWhole||s.Duration==AlphaTab.Model.Duration.QuadrupleWhole)return;var o=i.GetBeatLineX(s),h=t+this.Y,p=t+this.Y+this.Height,d=this.GetOnNotesGlyphForBeat(s);if(null==d.NoteNumbers?h+=this.Height-this.RhythmHeight:h+=d.NoteNumbers.GetNoteY(d.NoteNumbers.MinStringNote)+this.get_LineOffset()/2,i.Direction==AlphaTab.Rendering.Utils.BeamDirection.Up?o-=d.Width/2:o+=d.Width/2,a.BeginPath(),a.MoveTo(e+this.X+o,h),a.LineTo(e+this.X+o,p),a.Stroke(),s.Duration>AlphaTab.Model.Duration.Quarter){var u=new AlphaTab.Rendering.Glyphs.BeamGlyph(0,0,s.Duration,AlphaTab.Rendering.Utils.BeamDirection.Down,!1);u.Renderer=this,u.DoLayout(),u.Paint(e+this.X+o,p,a)}}}},$StaticConstructor(function(){AlphaTab.Rendering.TabBarRenderer.StaffId="tab",AlphaTab.Rendering.TabBarRenderer.LineSpacing=10}),AlphaTab.Rendering.TabBarRenderer.PaintSingleBar=function(e,t,a,i,n,r){e.BeginPath(),e.MoveTo(t,a),e.LineTo(i,n),e.LineTo(i,n-r),e.LineTo(t,a-r),e.ClosePath(),e.Fill()},$Inherit(AlphaTab.Rendering.TabBarRenderer,AlphaTab.Rendering.BarRendererBase),AlphaTab.Rendering.TabBarRendererFactory=function(e,t,a){this._showTimeSignature=!1,this._showRests=!1,this._showTiedNotes=!1,AlphaTab.Rendering.BarRendererFactory.call(this),this._showTimeSignature=e,this._showRests=t,this._showTiedNotes=a,this.HideOnPercussionTrack=!0},AlphaTab.Rendering.TabBarRendererFactory.prototype={get_StaffId:function(){return"tab"},CanCreate:function(e,t){return e.Tuning.length>0&&AlphaTab.Rendering.BarRendererFactory.prototype.CanCreate.call(this,e,t)},Create:function(e,t,a){var i=new AlphaTab.Rendering.TabBarRenderer(e,t);return i.ShowRests=this._showRests,i.ShowTimeSignature=this._showTimeSignature,i.ShowTiedNotes=this._showTiedNotes,i.RenderRhythm=a.Get("rhythm",i.RenderRhythm),i.RhythmHeight=a.Get("rhythmHeight",i.RhythmHeight),i.RhythmBeams=a.Get("rhythmBeams",i.RhythmBeams),i}},$Inherit(AlphaTab.Rendering.TabBarRendererFactory,AlphaTab.Rendering.BarRendererFactory),AlphaTab.Rendering.Utils.AccidentalHelper=function(){this._registeredAccidentals=null,this._appliedScoreLines=null,this._registeredAccidentals={},this._appliedScoreLines={}},AlphaTab.Rendering.Utils.AccidentalHelper.prototype={ApplyAccidental:function(e){var t=e.get_RealValue(),a=e.Beat.Voice.Bar.get_MasterBar().KeySignature+7,i=t%12,n=AlphaTab.Model.AccidentalType.None,r=this.RegisterNoteLine(e);if(!e.Beat.Voice.Bar.Staff.Track.IsPercussion){var l=a<7?AlphaTab.Model.AccidentalType.Flat:AlphaTab.Model.AccidentalType.Sharp,s=AlphaTab.Rendering.Utils.AccidentalHelper.KeySignatureLookup[a][i],o=AlphaTab.Rendering.Utils.AccidentalHelper.AccidentalNotes[i],h=this._registeredAccidentals.hasOwnProperty(r);s==o||h?s==o&&h&&(delete this._registeredAccidentals[r],n=o?l:AlphaTab.Model.AccidentalType.Natural):(this._registeredAccidentals[r]=!0,n=o?l:AlphaTab.Model.AccidentalType.Natural)}return n},RegisterNoteLine:function(e){var t=e.Beat.Voice.Bar.Staff.Track,a=t.IsPercussion?AlphaTab.Rendering.Utils.PercussionMapper.MapNoteForDisplay(e):e.get_RealValue()-t.DisplayTranspositionPitch,i=e.Beat.Voice.Bar.get_MasterBar().KeySignature,n=e.Beat.Voice.Bar.Clef,r=a%12,l=(a/12|0)-1,s=AlphaTab.Rendering.Utils.AccidentalHelper.OctaveSteps[n];s-=7*l;var o=AlphaTab.Model.ModelUtils.KeySignatureIsSharp(i)||AlphaTab.Model.ModelUtils.KeySignatureIsNatural(i)?AlphaTab.Rendering.Utils.AccidentalHelper.SharpNoteSteps:AlphaTab.Rendering.Utils.AccidentalHelper.FlatNoteSteps;switch(e.AccidentalMode){case AlphaTab.Model.NoteAccidentalMode.Default:case AlphaTab.Model.NoteAccidentalMode.SwapAccidentals:case AlphaTab.Model.NoteAccidentalMode.ForceNatural:case AlphaTab.Model.NoteAccidentalMode.ForceFlat:case AlphaTab.Model.NoteAccidentalMode.ForceSharp:default:o[r]}return s-=o[r],this._appliedScoreLines[e.Id]=s,s},GetNoteLine:function(e){return this._appliedScoreLines[e.Id]}},$StaticConstructor(function(){AlphaTab.Rendering.Utils.AccidentalHelper.KeySignatureLookup=[[!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0],[!0,!0,!0,!0,!0,!1,!0,!0,!0,!0,!0,!0],[!1,!0,!0,!0,!0,!1,!0,!0,!0,!0,!0,!0],[!1,!0,!0,!0,!0,!1,!1,!1,!0,!0,!0,!0],[!1,!1,!1,!0,!0,!1,!1,!1,!0,!0,!0,!0],[!1,!1,!1,!0,!0,!1,!1,!1,!1,!1,!0,!0],[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!0,!0],[!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1,!1],[!1,!1,!1,!1,!1,!0,!0,!1,!1,!1,!1,!1],[!0,!0,!1,!1,!1,!0,!0,!1,!1,!1,!1,!1],[!0,!0,!1,!1,!1,!0,!0,!0,!0,!1,!1,!1],[!0,!0,!0,!0,!1,!0,!0,!0,!0,!1,!1,!1],[!0,!0,!0,!0,!1,!0,!0,!0,!0,!0,!0,!1],[!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!1],[!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0,!0]],AlphaTab.Rendering.Utils.AccidentalHelper.AccidentalNotes=[!1,!0,!1,!0,!1,!1,!0,!1,!0,!1,!0,!1],AlphaTab.Rendering.Utils.AccidentalHelper.StepsPerOctave=7,AlphaTab.Rendering.Utils.AccidentalHelper.OctaveSteps=new Int32Array([40,34,32,28,40]),AlphaTab.Rendering.Utils.AccidentalHelper.SharpNoteSteps=new Int32Array([0,0,1,1,2,3,3,4,4,5,5,6]),AlphaTab.Rendering.Utils.AccidentalHelper.FlatNoteSteps=new Int32Array([0,1,1,2,2,3,4,4,5,5,6,6])}),AlphaTab.Rendering.Utils.BarHelpers=function(e){this.BeamHelpers=null,this.BeamHelperLookup=null,this.TupletHelpers=null,this.BeamHelpers=[],this.BeamHelperLookup=[],this.TupletHelpers=[];var t=null,a=null;if(null!=e)for(var i=0,n=e.Voices.length;i<n;i++){var r=e.Voices[i];this.BeamHelpers.push([]),this.BeamHelperLookup.push({}),this.TupletHelpers.push([]);for(var l=0,s=r.Beats.length;l<s;l++){var o=r.Beats[l],h=!1;if(o.get_IsRest()||null!=t&&t.CheckBeat(o)||(null!=t?(t.Finish(),h=t.Beats.length>1):h=!0,(t=new AlphaTab.Rendering.Utils.BeamingHelper(e.Staff.Track)).CheckBeat(o),this.BeamHelpers[r.Index].push(t)),o.get_HasTuplet()){var p=o.PreviousBeat;null!=p&&p.Voice!=o.Voice&&(p=null),h&&null!=a&&a.Finish(),null!=p&&null!=a&&a.Check(o)||((a=new AlphaTab.Rendering.Utils.TupletHelper(r.Index)).Check(o),this.TupletHelpers[r.Index].push(a))}this.BeamHelperLookup[r.Index][o.Index]=t}null!=t&&t.Finish(),null!=a&&a.Finish(),t=null,a=null}},AlphaTab.Rendering.Utils.BeamDirection={Up:0,Down:1},AlphaTab.Rendering.Utils.BeamBarType={Full:0,PartLeft:1,PartRight:2},AlphaTab.Rendering.Utils.BeatLinePositions=function(e,t,a){this.StaffId=null,this.Up=0,this.Down=0,this.StaffId=e,this.Up=t,this.Down=a},AlphaTab.Rendering.Utils.BeamingHelper=function(e){this._lastBeat=null,this._track=null,this._beatLineXPositions=null,this.Voice=null,this.Beats=null,this.ShortestDuration=AlphaTab.Model.Duration.QuadrupleWhole,this.FingeringCount=0,this.HasTuplet=!1,this.FirstMinNote=null,this.FirstMaxNote=null,this.LastMinNote=null,this.LastMaxNote=null,this.MinNote=null,this.MaxNote=null,this.InvertBeamDirection=!1,this.Direction=AlphaTab.Rendering.Utils.BeamDirection.Up,this._track=e,this.Beats=[],this._beatLineXPositions={},this.ShortestDuration=AlphaTab.Model.Duration.QuadrupleWhole},AlphaTab.Rendering.Utils.BeamingHelper.prototype={GetValue:function(e){return this._track.IsPercussion?AlphaTab.Rendering.Utils.PercussionMapper.MapNoteForDisplay(e):e.get_RealValue()-this._track.DisplayTranspositionPitch},GetBeatLineX:function(e){return this.HasBeatLineX(e)?this.Direction==AlphaTab.Rendering.Utils.BeamDirection.Up?this._beatLineXPositions[e.Index].Up:this._beatLineXPositions[e.Index].Down:0},HasBeatLineX:function(e){return this._beatLineXPositions.hasOwnProperty(e.Index)},RegisterBeatLineX:function(e,t,a,i){this._beatLineXPositions[t.Index]=new AlphaTab.Rendering.Utils.BeatLinePositions(e,a,i)},Finish:function(){this.Direction=this.CalculateDirection()},CalculateDirection:function(){if(this.Voice.Index>0)return this.Invert(AlphaTab.Rendering.Utils.BeamDirection.Down);if(this.Voice.Bar.Voices.length>1)for(var e=1;e<this.Voice.Bar.Voices.length;e++)if(!this.Voice.Bar.Voices[e].IsEmpty)return this.Invert(AlphaTab.Rendering.Utils.BeamDirection.Up);if(1==this.Beats.length&&(this.Beats[0].Duration==AlphaTab.Model.Duration.Whole||this.Beats[0].Duration==AlphaTab.Model.Duration.DoubleWhole))return this.Invert(AlphaTab.Rendering.Utils.BeamDirection.Up);if(this.Beats[0].GraceType!=AlphaTab.Model.GraceType.None)return this.Invert(AlphaTab.Rendering.Utils.BeamDirection.Up);var t=(this.GetValue(this.MaxNote)+this.GetValue(this.MinNote))/2|0;return this.Invert(t<AlphaTab.Rendering.Utils.BeamingHelper.ScoreMiddleKeys[this._lastBeat.Voice.Bar.Clef]?AlphaTab.Rendering.Utils.BeamDirection.Up:AlphaTab.Rendering.Utils.BeamDirection.Down)},Invert:function(e){if(!this.InvertBeamDirection)return e;switch(e){case AlphaTab.Rendering.Utils.BeamDirection.Down:return AlphaTab.Rendering.Utils.BeamDirection.Up;case AlphaTab.Rendering.Utils.BeamDirection.Up:return AlphaTab.Rendering.Utils.BeamDirection.Down}return AlphaTab.Rendering.Utils.BeamDirection.Up},CheckBeat:function(e){e.InvertBeamDirection&&(this.InvertBeamDirection=!0),null==this.Voice&&(this.Voice=e.Voice);var t=!1;if(0==this.Beats.length?t=!0:AlphaTab.Rendering.Utils.BeamingHelper.CanJoin(this._lastBeat,e)&&(t=!0),t){this._lastBeat=e,this.Beats.push(e),e.get_HasTuplet()&&(this.HasTuplet=!0);for(var a=0,i=0;i<e.Notes.length;i++){var n=e.Notes[i];n.LeftHandFinger==AlphaTab.Model.Fingers.Unknown&&n.RightHandFinger==AlphaTab.Model.Fingers.Unknown||a++}a>this.FingeringCount&&(this.FingeringCount=a),this.CheckNote(e.get_MinNote()),this.CheckNote(e.get_MaxNote()),this.ShortestDuration<e.Duration&&(this.ShortestDuration=e.Duration),e.get_HasTuplet()&&(this.HasTuplet=!0)}return t},CheckNote:function(e){var t=this.GetValue(e);null==this.FirstMinNote||e.Beat.Start<this.FirstMinNote.Beat.Start?this.FirstMinNote=e:e.Beat.Start==this.FirstMinNote.Beat.Start&&t<this.GetValue(this.FirstMinNote)&&(this.FirstMinNote=e),null==this.FirstMaxNote||e.Beat.Start<this.FirstMaxNote.Beat.Start?this.FirstMaxNote=e:e.Beat.Start==this.FirstMaxNote.Beat.Start&&t>this.GetValue(this.FirstMaxNote)&&(this.FirstMaxNote=e),null==this.LastMinNote||e.Beat.Start>this.LastMinNote.Beat.Start?this.LastMinNote=e:e.Beat.Start==this.LastMinNote.Beat.Start&&t<this.GetValue(this.LastMinNote)&&(this.LastMinNote=e),null==this.LastMaxNote||e.Beat.Start>this.LastMaxNote.Beat.Start?this.LastMaxNote=e:e.Beat.Start==this.LastMaxNote.Beat.Start&&t>this.GetValue(this.LastMaxNote)&&(this.LastMaxNote=e),(null==this.MaxNote||t>this.GetValue(this.MaxNote))&&(this.MaxNote=e),(null==this.MinNote||t<this.GetValue(this.MinNote))&&(this.MinNote=e)},CalculateBeamY:function(e,t,a,i,n){return this.CalculateBeamYWithDirection(e,t,a,i,n,this.Direction)},CalculateBeamYWithDirection:function(e,t,a,i,n,r){if(1==this.Beats.length)return r==AlphaTab.Rendering.Utils.BeamDirection.Up?n.GetYPositionForNote(this.MaxNote)-e:n.GetYPositionForNote(this.MinNote)+e;var l=10*i;if(r==AlphaTab.Rendering.Utils.BeamDirection.Down&&this.MinNote!=this.FirstMinNote&&this.MinNote!=this.LastMinNote)return n.GetYPositionForNote(this.MinNote)+e;if(r==AlphaTab.Rendering.Utils.BeamDirection.Up&&this.MaxNote!=this.FirstMaxNote&&this.MaxNote!=this.LastMaxNote)return n.GetYPositionForNote(this.MaxNote)-e;var s=this.GetBeatLineX(this.FirstMinNote.Beat)+t,o=r==AlphaTab.Rendering.Utils.BeamDirection.Up?n.GetYPositionForNote(this.FirstMaxNote)-e:n.GetYPositionForNote(this.FirstMinNote)+e,h=this.GetBeatLineX(this.LastMaxNote.Beat)+t,p=r==AlphaTab.Rendering.Utils.BeamDirection.Up?n.GetYPositionForNote(this.LastMaxNote)-e:n.GetYPositionForNote(this.LastMinNote)+e;return r==AlphaTab.Rendering.Utils.BeamDirection.Down&&o>p&&o-p>l&&(p=o-l),r==AlphaTab.Rendering.Utils.BeamDirection.Down&&p>o&&p-o>l&&(o=p-l),r==AlphaTab.Rendering.Utils.BeamDirection.Up&&o<p&&p-o>l&&(p=o+l),r==AlphaTab.Rendering.Utils.BeamDirection.Up&&p<o&&o-p>l&&(o=p+l),s==h?o:(p-o)/(h-s)*(a-s)+o},IsPositionFrom:function(e,t){return!this._beatLineXPositions.hasOwnProperty(t.Index)||this._beatLineXPositions[t.Index].StaffId==e}},$StaticConstructor(function(){AlphaTab.Rendering.Utils.BeamingHelper.ScoreMiddleKeys=new Int32Array([60,60,57,50,71])}),AlphaTab.Rendering.Utils.BeamingHelper.CanJoin=function(e,t){if(null==e||null==t||e.get_IsRest()||t.get_IsRest()||e.GraceType!=t.GraceType)return!1;var a=e.Voice.Bar;if(a!=e.Voice.Bar)return!1;var i=e.Start,n=t.Start;if(!AlphaTab.Rendering.Utils.BeamingHelper.CanJoinDuration(e.Duration)||!AlphaTab.Rendering.Utils.BeamingHelper.CanJoinDuration(t.Duration))return i==n;var r=960;switch(a.get_MasterBar().TimeSignatureDenominator){case 8:a.get_MasterBar().TimeSignatureNumerator%3==0&&(r+=480)}return(0|(r+i)/r)==(0|(r+n)/r)},AlphaTab.Rendering.Utils.BeamingHelper.CanJoinDuration=function(e){switch(e){case AlphaTab.Model.Duration.Whole:case AlphaTab.Model.Duration.Half:case AlphaTab.Model.Duration.Quarter:return!1;default:return!0}},AlphaTab.Rendering.Utils.BeamingHelper.IsFullBarJoin=function(e,t,a){return AlphaTab.Model.ModelUtils.GetIndex(e.Duration)-2-a>0&&AlphaTab.Model.ModelUtils.GetIndex(t.Duration)-2-a>0},AlphaTab.Rendering.Utils.StaveGroupBounds=function(){this.Index=0,this.VisualBounds=null,this.RealBounds=null,this.Bars=null,this.BoundsLookup=null,this.Bars=[],this.Index=0},AlphaTab.Rendering.Utils.StaveGroupBounds.prototype={Finish:function(){for(var e=0;e<this.Bars.length;e++)this.Bars[e].Finish()},AddBar:function(e){e.StaveGroupBounds=this,this.Bars.push(e)},FindBarAtPos:function(e){for(var t=null,a=0;a<this.Bars.length;a++)if(null==t||this.Bars[a].RealBounds.X<e)t=this.Bars[a];else if(e>this.Bars[a].RealBounds.X+this.Bars[a].RealBounds.W)break;return t}},AlphaTab.Rendering.Utils.MasterBarBounds=function(){this.IsFirstOfLine=!1,this.VisualBounds=null,this.RealBounds=null,this.Bars=null,this.StaveGroupBounds=null,this.Bars=[]},AlphaTab.Rendering.Utils.MasterBarBounds.prototype={AddBar:function(e){e.MasterBarBounds=this,this.Bars.push(e)},FindBeatAtPos:function(e,t){for(var a=null,i=0;i<this.Bars.length;i++){var n=this.Bars[i].FindBeatAtPos(e);null!=n&&(null==a||a.RealBounds.X<n.RealBounds.X)&&(a=n)}return null==a?null:a.Beat},Finish:function(){this.Bars.sort($CreateAnonymousDelegate(this,function(e,t){return e.RealBounds.Y<t.RealBounds.Y?-1:e.RealBounds.Y>t.RealBounds.Y?1:e.RealBounds.X<t.RealBounds.X?-1:e.RealBounds.X>t.RealBounds.X?1:0}))},AddBeat:function(e){this.StaveGroupBounds.BoundsLookup.AddBeat(e)}},AlphaTab.Rendering.Utils.BarBounds=function(){this.MasterBarBounds=null,this.VisualBounds=null,this.RealBounds=null,this.Bar=null,this.Beats=null,this.Beats=[]},AlphaTab.Rendering.Utils.BarBounds.prototype={AddBeat:function(e){e.BarBounds=this,this.Beats.push(e),this.MasterBarBounds.AddBeat(e)},FindBeatAtPos:function(e){for(var t=null,a=0;a<this.Beats.length;a++)if(null==t||this.Beats[a].RealBounds.X<e)t=this.Beats[a];else if(this.Beats[a].RealBounds.X>e)break;return t}},AlphaTab.Rendering.Utils.BeatBounds=function(){this.BarBounds=null,this.VisualBounds=null,this.RealBounds=null,this.Beat=null},AlphaTab.Rendering.Utils.PercussionMapper=function(){},$StaticConstructor(function(){AlphaTab.Rendering.Utils.PercussionMapper.ElementVariationToMidi=[new Int32Array([35,35,35]),new Int32Array([38,38,37]),new Int32Array([56,56,56]),new Int32Array([56,56,56]),new Int32Array([56,56,56]),new Int32Array([41,41,41]),new Int32Array([43,43,43]),new Int32Array([45,45,45]),new Int32Array([47,47,47]),new Int32Array([48,48,48]),new Int32Array([42,46,46]),new Int32Array([44,44,44]),new Int32Array([49,49,49]),new Int32Array([57,57,57]),new Int32Array([55,55,55]),new Int32Array([51,59,53]),new Int32Array([52,52,52])]}),AlphaTab.Rendering.Utils.PercussionMapper.MidiFromElementVariation=function(e){return AlphaTab.Rendering.Utils.PercussionMapper.ElementVariationToMidi[e.Element][e.Variation]},AlphaTab.Rendering.Utils.PercussionMapper.MapNoteForDisplay=function(e){var t=e.get_RealValue();return 61==t||66==t?50:60==t||65==t?52:t>=35&&t<=36||44==t?53:41==t||64==t?55:43==t||62==t?57:45==t||63==t?59:47==t||54==t?62:48==t||56==t?64:50==t?65:42==t||46==t||t>=49&&t<=53||57==t||59==t?67:60},AlphaTab.Rendering.Utils.TupletHelper=function(e){this._isFinished=!1,this.Beats=null,this.VoiceIndex=0,this.Tuplet=0,this.VoiceIndex=e,this.Beats=[]},AlphaTab.Rendering.Utils.TupletHelper.prototype={get_IsFull:function(){return this.Beats.length==this.Tuplet},Finish:function(){this._isFinished=!0},Check:function(e){if(0==this.Beats.length)this.Tuplet=e.TupletNumerator;else if(e.Voice.Index!=this.VoiceIndex||e.TupletNumerator!=this.Tuplet||this.get_IsFull()||this._isFinished)return!1;return this.Beats.push(e),!0}},AlphaTab.LayoutSettings=function(){this.Mode=null,this.AdditionalSettings=null,this.AdditionalSettings={}},AlphaTab.LayoutSettings.prototype={Get:function(e,t){return this.AdditionalSettings.hasOwnProperty(e.toLowerCase())?this.AdditionalSettings[e.toLowerCase()]:t}},AlphaTab.LayoutSettings.get_Defaults=function(){var e=new AlphaTab.LayoutSettings;return e.Mode="page",e},AlphaTab.StaveSettings=function(e){this.Id=null,this.AdditionalSettings=null,this.Id=e,this.AdditionalSettings={}},AlphaTab.StaveSettings.prototype={Get:function(e,t){return this.AdditionalSettings.hasOwnProperty(e.toLowerCase())?this.AdditionalSettings[e.toLowerCase()]:t}},AlphaTab.Util=AlphaTab.Util||{},AlphaTab.Util.Lazy=function(e){this._factory=null,this._created=!1,this._value=null,this._factory=e},AlphaTab.Util.Lazy.prototype={get_Value:function(){return this._created||(this._value=this._factory(),this._created=!0),this._value}},AlphaTab.Util.Logger=function(){},$StaticConstructor(function(){AlphaTab.Util.Logger.LogLevel=AlphaTab.Util.LogLevel.None,AlphaTab.Util.Logger.LogLevel=AlphaTab.Util.LogLevel.Info}),AlphaTab.Util.Logger.Debug=function(e,t,a){AlphaTab.Util.Logger.Log(AlphaTab.Util.LogLevel.Debug,e,t,a)},AlphaTab.Util.Logger.Warning=function(e,t,a){AlphaTab.Util.Logger.Log(AlphaTab.Util.LogLevel.Warning,e,t,a)},AlphaTab.Util.Logger.Info=function(e,t,a){AlphaTab.Util.Logger.Log(AlphaTab.Util.LogLevel.Info,e,t,a)},AlphaTab.Util.Logger.Error=function(e,t,a){AlphaTab.Util.Logger.Log(AlphaTab.Util.LogLevel.Error,e,t,a)},AlphaTab.Util.Logger.Log=function(e,t,a,i){e<AlphaTab.Util.Logger.LogLevel||AlphaTab.Platform.Std.Log(e,t,a,i)},AlphaTab.Util.LogLevel={None:0,Debug:1,Info:2,Warning:3,Error:4},AlphaTab.Xml=AlphaTab.Xml||{},AlphaTab.Xml.XmlNode=function(){this.NodeType=AlphaTab.Xml.XmlNodeType.None,this.LocalName=null,this.Value=null,this.ChildNodes=null,this.Attributes=null,this.FirstChild=null,this.FirstElement=null,this.Attributes={},this.ChildNodes=[]},AlphaTab.Xml.XmlNode.prototype={AddChild:function(e){this.ChildNodes.push(e),this.FirstChild=e,e.NodeType==AlphaTab.Xml.XmlNodeType.Element&&(this.FirstElement=e)},GetAttribute:function(e){return this.Attributes.hasOwnProperty(e)?this.Attributes[e]:""},GetElementsByTagName:function(e){for(var t=[],a=0,i=this.ChildNodes,n=i.length,r=i[a];a<n;a++,r=i[a])null!=r&&r.NodeType==AlphaTab.Xml.XmlNodeType.Element&&r.LocalName==e&&t.push(r);return t.slice(0)},FindChildElement:function(e){for(var t=0,a=this.ChildNodes,i=a.length,n=a[t];t<i;t++,n=a[t])if(null!=n&&n.NodeType==AlphaTab.Xml.XmlNodeType.Element&&n.LocalName==e)return n;return null},get_InnerText:function(){if(this.NodeType==AlphaTab.Xml.XmlNodeType.Element||this.NodeType==AlphaTab.Xml.XmlNodeType.Document){for(var e=new String,t=0,a=this.ChildNodes,i=a.length,n=a[t];t<i;t++,n=a[t])e+=n.get_InnerText();return e.trim()}return this.Value}},AlphaTab.Xml.XmlDocument=function(e){this.DocumentElement=null,AlphaTab.Xml.XmlNode.call(this),this.NodeType=AlphaTab.Xml.XmlNodeType.Document,AlphaTab.Xml.XmlParser.Parse(e,0,this);for(var t=0,a=this.ChildNodes,i=a.length,n=a[t];t<i;t++,n=a[t])if(n.NodeType==AlphaTab.Xml.XmlNodeType.Element){this.DocumentElement=n;break}},$Inherit(AlphaTab.Xml.XmlDocument,AlphaTab.Xml.XmlNode),AlphaTab.Xml.XmlException=function(e,t,a){this.Xml=null,this.Pos=0,AlphaTab.AlphaTabException.call(this,e),this.Xml=t,this.Pos=a},$Inherit(AlphaTab.Xml.XmlException,AlphaTab.AlphaTabException),AlphaTab.Xml.XmlNodeType={None:0,Element:1,Attribute:2,Text:3,CDATA:4,EntityReference:5,Entity:6,ProcessingInstruction:7,Comment:8,Document:9,DocumentType:10,DocumentFragment:11,Notation:12,Whitespace:13,SignificantWhitespace:14,EndElement:15,EndEntity:16,XmlDeclaration:17},AlphaTab.Xml.XmlParser=function(){},$StaticConstructor(function(){AlphaTab.Xml.XmlParser.CharCodeLF="\n",AlphaTab.Xml.XmlParser.CharCodeTab="\t",AlphaTab.Xml.XmlParser.CharCodeCR="\r",AlphaTab.Xml.XmlParser.CharCodeSpace=" ",AlphaTab.Xml.XmlParser.CharCodeLowerThan="<",AlphaTab.Xml.XmlParser.CharCodeAmp="&",AlphaTab.Xml.XmlParser.CharCodeBrackedClose="]",AlphaTab.Xml.XmlParser.CharCodeBrackedOpen="[",AlphaTab.Xml.XmlParser.CharCodeGreaterThan=">",AlphaTab.Xml.XmlParser.CharCodeExclamation="!",AlphaTab.Xml.XmlParser.CharCodeUpperD="D",AlphaTab.Xml.XmlParser.CharCodeLowerD="d",AlphaTab.Xml.XmlParser.CharCodeMinus="-",AlphaTab.Xml.XmlParser.CharCodeQuestion="?",AlphaTab.Xml.XmlParser.CharCodeSlash="/",AlphaTab.Xml.XmlParser.CharCodeEquals="=",AlphaTab.Xml.XmlParser.CharCodeDoubleQuote='"',AlphaTab.Xml.XmlParser.CharCodeSingleQuote="'",AlphaTab.Xml.XmlParser.CharCodeSharp="#",AlphaTab.Xml.XmlParser.CharCodeLowerX="x",AlphaTab.Xml.XmlParser.CharCodeLowerA="a",AlphaTab.Xml.XmlParser.CharCodeLowerZ="z",AlphaTab.Xml.XmlParser.CharCodeUpperA="A",AlphaTab.Xml.XmlParser.CharCodeUpperZ="Z",AlphaTab.Xml.XmlParser.CharCode0="0",AlphaTab.Xml.XmlParser.CharCode9="0",AlphaTab.Xml.XmlParser.CharCodeColon=":",AlphaTab.Xml.XmlParser.CharCodeDot=".",AlphaTab.Xml.XmlParser.CharCodeUnderscore="_",AlphaTab.Xml.XmlParser.Escapes=null,AlphaTab.Xml.XmlParser.Escapes={},AlphaTab.Xml.XmlParser.Escapes.lt="<",AlphaTab.Xml.XmlParser.Escapes.gt=">",AlphaTab.Xml.XmlParser.Escapes.amp="&",AlphaTab.Xml.XmlParser.Escapes.quot='"',AlphaTab.Xml.XmlParser.Escapes.apos="'"}),AlphaTab.Xml.XmlParser.Parse=function(e,t,a){for(var i=e.charCodeAt(t),n=1,r=1,l=0,s=new String,o=1,h=null,p=null,d=0,u=0;t<e.length;){switch(i=e.charCodeAt(t),n){case 0:switch(i){case 10:case 13:case 9:case 32:break;default:n=r;continue}break;case 1:switch(i){case 60:n=0,r=2;break;default:l=t,n=13;continue}break;case 13:60==i?(s+=e.substr(l,t-l),(c=new AlphaTab.Xml.XmlNode).NodeType=AlphaTab.Xml.XmlNodeType.Text,c.Value=s,s=new String,a.AddChild(c),n=0,r=2):38==i&&(s+=e.substr(l,t-l),n=18,o=13,l=t+1);break;case 17:if(93==i&&93==e.charCodeAt(t+1)&&62==e.charCodeAt(t+2)){var c=new AlphaTab.Xml.XmlNode;c.NodeType=AlphaTab.Xml.XmlNodeType.CDATA,c.Value=e.substr(l,t-l),a.AddChild(c),t+=2,n=1}break;case 2:switch(i){case 33:if(91==e.charCodeAt(t+1)){if(t+=2,"CDATA["!=e.substr(t,6).toUpperCase())throw $CreateException(new AlphaTab.Xml.XmlException("Expected <![CDATA[",e,t),new Error);n=17,l=(t+=5)+1}else if(68==e.charCodeAt(t+1)||100==e.charCodeAt(t+1)){if("OCTYPE"!=e.substr(t+2,6).toUpperCase())throw $CreateException(new AlphaTab.Xml.XmlException("Expected <!DOCTYPE",e,t),new Error);n=16,l=(t+=8)+1}else{if(45!=e.charCodeAt(t+1)||45!=e.charCodeAt(t+2))throw $CreateException(new AlphaTab.Xml.XmlException("Expected \x3c!--",e,t),new Error);n=15,l=(t+=2)+1}break;case 63:n=14,l=t;break;case 47:if(null==a)throw $CreateException(new AlphaTab.Xml.XmlException("Expected node name",e,t),new Error);l=t+1,n=0,r=10;break;default:n=3,l=t;continue}break;case 3:if(!AlphaTab.Xml.XmlParser.IsValidChar(i)){if(t==l)throw $CreateException(new AlphaTab.Xml.XmlException("Expected node name",e,t),new Error);(h=new AlphaTab.Xml.XmlNode).NodeType=AlphaTab.Xml.XmlNodeType.Element,h.LocalName=e.substr(l,t-l),a.AddChild(h),n=0,r=4;continue}break;case 4:switch(i){case 47:n=11;break;case 62:n=9;break;default:n=5,l=t;continue}break;case 5:if(!AlphaTab.Xml.XmlParser.IsValidChar(i)){if(l==t)throw $CreateException(new AlphaTab.Xml.XmlException("Expected attribute name",e,t),new Error);if(p=e.substr(l,t-l),h.Attributes.hasOwnProperty(p))throw $CreateException(new AlphaTab.Xml.XmlException("Duplicate attribute ["+p+"]",e,t),new Error);n=0,r=6;continue}break;case 6:switch(i){case 61:n=0,r=7;break;default:throw $CreateException(new AlphaTab.Xml.XmlException("Expected =",e,t),new Error)}break;case 7:switch(i){case 34:case 39:s=new String,n=8,l=t+1,u=i}break;case 8:switch(i){case 38:s+=e.substr(l,t-l),n=18,o=8,l=t+1;break;default:if(i==u){var T=s+=e.substr(l,t-l);s=new String,h.Attributes[p]=T,n=0,r=4}}break;case 9:l=t=AlphaTab.Xml.XmlParser.Parse(e,t,h),n=1;break;case 11:switch(i){case 62:n=1;break;default:throw $CreateException(new AlphaTab.Xml.XmlException("Expected >",e,t),new Error)}break;case 12:switch(i){case 62:return t;default:throw $CreateException(new AlphaTab.Xml.XmlException("Expected >",e,t),new Error)}break;case 10:if(!AlphaTab.Xml.XmlParser.IsValidChar(i)){if(l==t)throw $CreateException(new AlphaTab.Xml.XmlException("Expected node name",e,t),new Error);if(e.substr(l,t-l)!=a.LocalName)throw $CreateException(new AlphaTab.Xml.XmlException("Expected </"+a.LocalName+">",e,t),new Error);n=0,r=12;continue}break;case 15:45==i&&45==e.charCodeAt(t+1)&&62==e.charCodeAt(t+2)&&(t+=2,n=1);break;case 16:91==i?d++:93==i?d--:62==i&&0==d&&((b=new AlphaTab.Xml.XmlNode).NodeType=AlphaTab.Xml.XmlNodeType.DocumentType,b.Value=e.substr(l,t-l),a.AddChild(b),n=1);break;case 14:63==i&&62==e.charCodeAt(t+1)&&(t++,n=1);break;case 18:if(59==i){var g=e.substr(l,t-l);if(35==g.charCodeAt(0)){var f=120==g.charCodeAt(1)?AlphaTab.Platform.Std.ParseInt("0"+g.substr(1,g.length-1)):AlphaTab.Platform.Std.ParseInt(g.substr(1,g.length-1));s+=String.fromCharCode(f)}else AlphaTab.Xml.XmlParser.Escapes.hasOwnProperty(g)?s+=AlphaTab.Xml.XmlParser.Escapes[g]:s+="&"+g+";";l=t+1,n=o}else AlphaTab.Xml.XmlParser.IsValidChar(i)||35==i||(s+="&",s+=e.substr(l,t-l),l=--t+1,n=o)}t++}if(1==n&&(l=t,n=13),13==n)return t!=l&&(s+=e.substr(l,t-l),(b=new AlphaTab.Xml.XmlNode).NodeType=AlphaTab.Xml.XmlNodeType.Text,b.Value=s,a.AddChild(b)),t;if(18==n&&13==o){s+="&",s+=e.substr(l,t-l);var b=new AlphaTab.Xml.XmlNode;return b.NodeType=AlphaTab.Xml.XmlNodeType.Text,b.Value=s,a.AddChild(b),t}throw $CreateException(new AlphaTab.Xml.XmlException("Unexpected end",e,t),new Error)},AlphaTab.Xml.XmlParser.IsValidChar=function(e){return e>=97&&e<=122||e>=65&&e<=90||e>=48&&e<=48||58==e||46==e||95==e||45==e},AlphaTab.Model.Lyrics=AlphaTab.Model.Lyrics||{},AlphaTab.Model.Lyrics.LyricsState=function(){},$StaticConstructor(function(){AlphaTab.Model.Lyrics.LyricsState.IGNORE_SPACES=0,AlphaTab.Model.Lyrics.LyricsState.BEGIN=1,AlphaTab.Model.Lyrics.LyricsState.TEXT=2,AlphaTab.Model.Lyrics.LyricsState.COMMENT=3,AlphaTab.Model.Lyrics.LyricsState.DASH=4}),AlphaTab.Rendering.Glyphs.TripletFeelGlyph=AlphaTab.Rendering.Glyphs.TripletFeelGlyph||{},AlphaTab.Rendering.Glyphs.TripletFeelGlyph.BarType={Full:0,PartialLeft:1,PartialRight:2},AlphaTab.Xml.XmlParser=AlphaTab.Xml.XmlParser||{},AlphaTab.Xml.XmlParser.XmlState=function(){},$StaticConstructor(function(){AlphaTab.Xml.XmlParser.XmlState.IGNORE_SPACES=0,AlphaTab.Xml.XmlParser.XmlState.BEGIN=1,AlphaTab.Xml.XmlParser.XmlState.BEGIN_NODE=2,AlphaTab.Xml.XmlParser.XmlState.TAG_NAME=3,AlphaTab.Xml.XmlParser.XmlState.BODY=4,AlphaTab.Xml.XmlParser.XmlState.ATTRIB_NAME=5,AlphaTab.Xml.XmlParser.XmlState.EQUALS=6,AlphaTab.Xml.XmlParser.XmlState.ATTVAL_BEGIN=7,AlphaTab.Xml.XmlParser.XmlState.ATTRIB_VAL=8,AlphaTab.Xml.XmlParser.XmlState.CHILDS=9,AlphaTab.Xml.XmlParser.XmlState.CLOSE=10,AlphaTab.Xml.XmlParser.XmlState.WAIT_END=11,AlphaTab.Xml.XmlParser.XmlState.WAIT_END_RET=12,AlphaTab.Xml.XmlParser.XmlState.PCDATA=13,AlphaTab.Xml.XmlParser.XmlState.HEADER=14,AlphaTab.Xml.XmlParser.XmlState.COMMENT=15,AlphaTab.Xml.XmlParser.XmlState.DOCTYPE=16,AlphaTab.Xml.XmlParser.XmlState.CDATA=17,AlphaTab.Xml.XmlParser.XmlState.ESCAPE=18});for(var i=0;i<$StaticConstructors.length;i++)$StaticConstructors[i]();